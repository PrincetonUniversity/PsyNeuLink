

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>UserDefinedFunction &mdash; PsyNeuLink 0.6.0.2+2.g2c91e6a documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'./',
              VERSION:'0.6.0.2+2.g2c91e6a',
              LANGUAGE:'None',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="TransferFunctions" href="TransferFunctions.html" />
    <link rel="prev" title="Functions" href="Functions.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> PsyNeuLink
          

          
          </a>

          
            
            
              <div class="version">
                0.6.0.2+2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="index.html">Welcome to PsyNeuLink </a></li>
<li class="toctree-l1"><a class="reference internal" href="BasicsAndSampler.html">Basics and Sampler</a></li>
<li class="toctree-l1"><a class="reference internal" href="QuickReference.html">Quick Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="Core.html">Core</a></li>
<li class="toctree-l1"><a class="reference internal" href="Library.html">Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="ContributorsGuide.html">Contributors Guide</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">PsyNeuLink</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="Core.html">Core</a> &raquo;</li>
        
          <li><a href="Component.html">Component</a> &raquo;</li>
        
          <li><a href="Functions.html">Functions</a> &raquo;</li>
        
      <li>UserDefinedFunction</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/UserDefinedFunction.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="userdefinedfunction">
<h1>UserDefinedFunction<a class="headerlink" href="#userdefinedfunction" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
</div>
<span class="target" id="module-psyneulink.core.components.functions.userdefinedfunction"></span><dl class="class">
<dt id="psyneulink.core.components.functions.userdefinedfunction.UserDefinedFunction">
<em class="property">class </em><code class="descclassname">psyneulink.core.components.functions.userdefinedfunction.</code><code class="descname">UserDefinedFunction</code><span class="sig-paren">(</span><em>custom_function=None</em>, <em>default_variable=None</em>, <em>params=None</em>, <em>owner=None</em>, <em>name=None</em>, <em>prefs=None</em><span class="sig-paren">)</span><a class="headerlink" href="#psyneulink.core.components.functions.userdefinedfunction.UserDefinedFunction" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p id="udf-description">A UserDefinedFunction (UDF) is used to “wrap” a Python function or method, including a lamdba function,
as a PsyNeuLink <a class="reference internal" href="Function.html"><span class="doc">Function</span></a>, so that it can be used as the <a class="reference internal" href="Component.html#psyneulink.core.components.component.Component.function" title="psyneulink.core.components.component.Component.function"><code class="xref any py py-attr docutils literal"><span class="pre">function</span></code></a> of a <a class="reference internal" href="Component.html"><span class="doc">Component</span></a>.  This is done automatically if a Python function or method is assigned as the <a class="reference internal" href="Component.html#psyneulink.core.components.component.Component.function" title="psyneulink.core.components.component.Component.function"><code class="xref any py py-attr docutils literal"><span class="pre">function</span></code></a> attribute of a Component.  A Python function or method can also be wrapped explicitly,
using the UserDefinedFunction constructor, and assigning the Python function or method to its <strong>custom_function</strong>
argument.  A Python function or method wrapped as a UDF must obey the following conventions to be treated
correctly:</p>
<ul class="simple" id="udf-variable">
<li>It must have <strong>at least one argument</strong> (that can be a positional or a keyword argument);  this will be treated
as the <code class="xref any docutils literal"><span class="pre">variable</span></code> attribute of the UDF’s <code class="xref any docutils literal"><span class="pre">function</span></code>.
When the UDF calls the function or method that it wraps, an initial attempt is made to do so with <strong>variable</strong>
as the name of the first argument; if that fails, it is called positionally.  The argument is always passed as a
2d np.array, that may contain one or more items (elements in axis 0), depending upon the Component to which the
UDF is assigned.  It is the user’s responsibility to insure that the number of items expected in the first
argument of the function or method is compatible with the circumstances in which it will be called.</li>
</ul>
<ul class="simple" id="udf-additional-arguments">
<li>It may have have <strong>any number of additional arguments</strong> (positional and/or keyword);  these are treated as
parameters of the UDF, and can be modulated by <a class="reference internal" href="ModulatorySignal.html"><span class="doc">ModulatorySignals</span></a> like the parameters of
ordinary PsyNeuLink <a class="reference internal" href="Function.html"><span class="doc">Functions</span></a>.  If the UDF is assigned to (or automatically created for) a
<a class="reference internal" href="Mechanism.html"><span class="doc">Mechanisms</span></a> or <a class="reference internal" href="Projection.html"><span class="doc">Projection</span></a>, these parameters are each automatically assigned a <a class="reference internal" href="ParameterState.html"><span class="doc">ParameterState</span></a>
so that they can be modulated by <a class="reference internal" href="ControlSignal.html"><span class="doc">ControlSignals</span></a> or <a class="reference internal" href="LearningSignal.html"><span class="doc">LearningSignals</span></a>,
respectively.  If the UDF is assigned to (or automatically created for) an <a class="reference internal" href="InputState.html"><span class="doc">InputState</span></a> or <a class="reference internal" href="OutputState.html"><span class="doc">OutputState</span></a>,
and any of the parameters are specified as <a class="reference internal" href="Functions.html#function-modulatory-params"><span class="std std-ref">Modulatory Parameters</span></a> (see <a class="reference internal" href="#udf-modulatory-params"><span class="std std-ref">below</span></a>),
then they can be modulated by <a class="reference internal" href="GatingSignal.html"><span class="doc">GatingSignals</span></a>. The function or method wrapped by the UDF is called
with these parameters by their name and with their current values (i.e., as determined by any
<a class="reference internal" href="ModulatorySignal.html"><span class="doc">ModulatorySignals</span></a> assigned to them).</li>
</ul>
<ul class="simple" id="udf-params-context">
<li>It may include <strong>self</strong>, <strong>owner</strong>, <strong>context</strong>, and/or <strong>params</strong> arguments;  none of these are
required, but can be included to gain access to the standard <a class="reference internal" href="Function.html"><span class="doc">Function</span></a> parameters (such as the history of its
parameter values), those of the <a class="reference internal" href="Component.html"><span class="doc">Component</span></a> to which it has been assigned (i.e., its <code class="xref any docutils literal"><span class="pre">owner</span></code>,
and/or receive information about the current conditions of execution.   When the function or method is called,
an initial attempt is made to pass these arguments; if that fails, it is called again without them.</li>
</ul>
<ul id="udf-modulatory-params">
<li><p class="first">The parameters of a UDF can be specified as <a class="reference internal" href="Functions.html#function-modulatory-params"><span class="std std-ref">Modulatory Parameters</span></a> in a <a class="reference internal" href="ParameterState.html#parameterstate-specification"><span class="std std-ref">parameter specification dictionary</span></a> assigned to the <strong>params</strong> argument of the constructor for either the Python
function or method, or of an explicitly defined UDF (see <a class="reference internal" href="#udf-modulatory-params-examples"><span class="std std-ref">examples below</span></a>).
It can include either or both of the following two entries:</p>
<blockquote>
<div><p><em>MULTIPLICATIVE_PARAM</em>: &lt;parameter name&gt;</p>
<p><em>ADDITIVE_PARAM</em>: &lt;parameter name&gt;</p>
</div></blockquote>
<p>These are used only when the UDF is assigned as the <a class="reference internal" href="State.html#psyneulink.core.components.states.state.State_Base.function" title="psyneulink.core.components.states.state.State_Base.function"><code class="xref any py py-attr docutils literal"><span class="pre">function</span></code></a> of an InputState or
OutputState that receives one more more <a class="reference internal" href="GatingProjection.html"><span class="doc">GatingProjections</span></a>.</p>
</li>
</ul>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">The format of the <code class="xref any docutils literal"><span class="pre">variable</span></code> passed to the <code class="xref any docutils literal"><span class="pre">custom_function</span></code> function can be verified by adding a <code class="docutils literal"><span class="pre">print(variable)</span></code> or
<code class="docutils literal"><span class="pre">print(type(variable))</span></code> statement to the function.</p>
</div>
<p><strong>Assigning a custom function to a Mechanism</strong></p>
<p id="udf-lambda-function-examples">The following example assigns a simple lambda function that returns the sum of the elements of a 1d array) to a
<a class="reference internal" href="TransferMechanism.html"><span class="doc">TransferMechanism</span></a>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">psyneulink</span> <span class="k">as</span> <span class="nn">pnl</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_mech</span> <span class="o">=</span> <span class="n">pnl</span><span class="o">.</span><span class="n">ProcessingMechanism</span><span class="p">(</span><span class="n">default_variable</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]],</span>
<span class="gp">... </span>                                  <span class="n">function</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_mech</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="nb">input</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="go">array([[6]])</span>
</pre></div>
</div>
<p>Note that the function treats its argument, x, as a 2d array, and accesses its first item for the calculation.
This is because  the <a class="reference internal" href="Mechanism.html#psyneulink.core.components.mechanisms.mechanism.Mechanism_Base.variable" title="psyneulink.core.components.mechanisms.mechanism.Mechanism_Base.variable"><code class="xref any py py-attr docutils literal"><span class="pre">variable</span></code></a> of <code class="docutils literal"><span class="pre">my_mech</span></code> is defined in the <strong>size</strong> argument of
its constructor as having a single item (a 1d array of length 3;  (see <a class="reference internal" href="Component.html#psyneulink.core.components.component.Component.size" title="psyneulink.core.components.component.Component.size"><code class="xref any py py-attr docutils literal"><span class="pre">size</span></code></a>).  In the
following example, a function is defined for a Mechanism in which the variable has two items, that are summed by
the function:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">my_mech</span> <span class="o">=</span> <span class="n">pnl</span><span class="o">.</span><span class="n">ProcessingMechanism</span><span class="p">(</span><span class="n">default_variable</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">]],</span>
<span class="gp">... </span>                                  <span class="n">function</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_mech</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="nb">input</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">]])</span>
<span class="go">array([[3]])</span>
</pre></div>
</div>
<p id="udf-defined-function-examples">The <strong>function</strong> argument can also be assigned a function defined in Python:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">my_fct</span><span class="p">(</span><span class="n">variable</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">variable</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">variable</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_mech</span> <span class="o">=</span> <span class="n">pnl</span><span class="o">.</span><span class="n">ProcessingMechanism</span><span class="p">(</span><span class="n">default_variable</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">]],</span>
<span class="gp">... </span>                                  <span class="n">function</span><span class="o">=</span><span class="n">my_fct</span><span class="p">)</span>
</pre></div>
</div>
<p>This will produce the same result as the last example.  This can be useful for assigning the function to more than
one Component.</p>
<p>More complicated functions, including ones with more than one parameter can also be used;  for example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">my_sinusoidal_fct</span><span class="p">(</span><span class="nb">input</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">]],</span>
<span class="gp">... </span>                      <span class="n">phase</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">amplitude</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="gp">... </span>   <span class="n">frequency</span> <span class="o">=</span> <span class="nb">input</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">... </span>   <span class="n">t</span> <span class="o">=</span> <span class="nb">input</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">... </span>   <span class="k">return</span> <span class="n">amplitude</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">frequency</span> <span class="o">*</span> <span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_wave_mech</span> <span class="o">=</span> <span class="n">pnl</span><span class="o">.</span><span class="n">ProcessingMechanism</span><span class="p">(</span><span class="n">default_variable</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">]],</span>
<span class="gp">... </span>                                       <span class="n">function</span><span class="o">=</span><span class="n">my_sinusoidal_fct</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that in this example, <code class="docutils literal"><span class="pre">input</span></code> is used as the name of the first argument, instead of <code class="docutils literal"><span class="pre">variable</span></code>
as in the examples above. The name of the first argument of a function to be “wrapped” as a UDF does not matter;
in general it is good practice to use <code class="docutils literal"><span class="pre">variable</span></code>, as the <a class="reference internal" href="Component.html#psyneulink.core.components.component.Component.variable" title="psyneulink.core.components.component.Component.variable"><code class="xref any py py-attr docutils literal"><span class="pre">variable</span></code></a> of the Component
to which the UDF is assigned is what is passed to the function as its first argument.  However, if it is helpful to
name it something else, that is fine.</p>
<p>Notice also that <code class="docutils literal"><span class="pre">my_sinusoidal_fct</span></code> takes two values in its <code class="docutils literal"><span class="pre">input</span></code> argument, that it assigns to the
<code class="docutils literal"><span class="pre">frequency</span></code> and <code class="docutils literal"><span class="pre">t</span></code> variables of the function.  While  it could have been specified more compactly as a 1d array
with two elements (i.e. [0,0]), it is specified in the example as a 2d array with two items to make it clear that
it matches the format of the <strong>default_variable</strong> for the ProcessingMechanism to which it will be assigned,
which requires it be formatted this way (since the <a class="reference internal" href="Component.html#psyneulink.core.components.component.Component.variable" title="psyneulink.core.components.component.Component.variable"><code class="xref any py py-attr docutils literal"><span class="pre">variable</span></code></a> of all Components are converted
to a 2d array).</p>
<p><code class="docutils literal"><span class="pre">my_sinusoidal_fct</span></code> also has two other arguments, <code class="docutils literal"><span class="pre">phase</span></code> and <code class="docutils literal"><span class="pre">amplitude</span></code>.   When it is assigned to
<code class="docutils literal"><span class="pre">my_wave_mech</span></code>, those parameters are assigned to <a class="reference internal" href="ParameterState.html"><span class="doc">ParameterStates</span></a> of <code class="docutils literal"><span class="pre">my_wave_mech</span></code>, which
that be used to modify their values by <a class="reference internal" href="ControlSignal.html"><span class="doc">ControlSignals</span></a> (see <code class="xref any docutils literal"><span class="pre">example</span> <span class="pre">below</span></code>).</p>
<p id="udf-explicit-creation-examples">In all of the examples above, a UDF was automatically created for the functions assigned to the Mechanism.  A UDF
can also be created explicitly, as follows:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">my_sinusoidal_UDF</span> <span class="o">=</span> <span class="n">pnl</span><span class="o">.</span><span class="n">UserDefinedFunction</span><span class="p">(</span><span class="n">custom_function</span><span class="o">=</span><span class="n">my_sinusoidal_fct</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_wave_mech</span> <span class="o">=</span> <span class="n">pnl</span><span class="o">.</span><span class="n">ProcessingMechanism</span><span class="p">(</span><span class="n">default_variable</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">]],</span>
<span class="gp">... </span>                                       <span class="n">function</span><span class="o">=</span><span class="n">my_sinusoidal_UDF</span><span class="p">)</span>
</pre></div>
</div>
<p>When the UDF is created explicitly, parameters of the function can be included as arguments to its constructor,
to assign them default values that differ from the those in the definition of the function, or for parameters
that don’t define default values.  For example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">my_sinusoidal_UDF</span> <span class="o">=</span> <span class="n">pnl</span><span class="o">.</span><span class="n">UserDefinedFunction</span><span class="p">(</span><span class="n">custom_function</span><span class="o">=</span><span class="n">my_sinusoidal_fct</span><span class="p">,</span>
<span class="gp">... </span>                                 <span class="n">phase</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<span class="gp">... </span>                                 <span class="n">amplitude</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_wave_mech</span> <span class="o">=</span> <span class="n">pnl</span><span class="o">.</span><span class="n">ProcessingMechanism</span><span class="p">(</span><span class="n">default_variable</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">]],</span>
<span class="gp">... </span>                                       <span class="n">function</span><span class="o">=</span><span class="n">my_sinusoidal_UDF</span><span class="p">)</span>
</pre></div>
</div>
<p>assigns <code class="docutils literal"><span class="pre">my_sinusoidal_fct</span></code> as the <a class="reference internal" href="Mechanism.html#psyneulink.core.components.mechanisms.mechanism.Mechanism_Base.function" title="psyneulink.core.components.mechanisms.mechanism.Mechanism_Base.function"><code class="xref any py py-attr docutils literal"><span class="pre">function</span></code></a> for <code class="docutils literal"><span class="pre">my_mech</span></code>, but with the default
values of its <code class="docutils literal"><span class="pre">phase</span></code> and <code class="docutils literal"><span class="pre">amplitude</span></code> parameters assigned new values.  This can be useful for assigning the
same function to different Mechanisms with different default values.</p>
<p id="udf-control-signal-example">Explicitly defining the UDF can also be used to <a class="reference internal" href="ControlSignal.html#controlsignal-specification"><span class="std std-ref">specify control</span></a> for parameters of
the function, as in the following example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">my_mech</span> <span class="o">=</span> <span class="n">pnl</span><span class="o">.</span><span class="n">ProcessingMechanism</span><span class="p">(</span><span class="n">default_variable</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">]],</span>
<span class="gp">... </span>                                  <span class="n">function</span><span class="o">=</span><span class="n">UserDefinedFunction</span><span class="p">(</span><span class="n">custom_function</span><span class="o">=</span><span class="n">my_sinusoidal_fct</span><span class="p">,</span>
<span class="gp">... </span>                                                               <span class="n">amplitude</span><span class="o">=</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">pnl</span><span class="o">.</span><span class="n">CONTROL</span><span class="p">)))</span>
</pre></div>
</div>
<p>This specifies that the default value of the <code class="docutils literal"><span class="pre">amplitude</span></code> parameter of <code class="docutils literal"><span class="pre">my_sinusoidal_fct</span></code> be <code class="docutils literal"><span class="pre">1.0</span></code>, but
its value should be modulated by a <a class="reference internal" href="ControlSignal.html"><span class="doc">ControlSignal</span></a>.</p>
<p>Custom functions can be as elaborate as desired, and can even include other PsyNeuLink <a class="reference internal" href="Function.html"><span class="doc">Functions</span></a>
indirectly, such as:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">psyneulink</span> <span class="k">as</span> <span class="nn">pnl</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">L</span> <span class="o">=</span> <span class="n">pnl</span><span class="o">.</span><span class="n">Logistic</span><span class="p">(</span><span class="n">gain</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">my_fct</span><span class="p">(</span><span class="n">variable</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">L</span><span class="p">(</span><span class="n">variable</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_mech</span> <span class="o">=</span> <span class="n">pnl</span><span class="o">.</span><span class="n">ProcessingMechanism</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">function</span> <span class="o">=</span> <span class="n">my_fct</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_mech</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="nb">input</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>  
<span class="go">array([[2.88079708, 2.98201379, 2.99752738]])</span>
</pre></div>
</div>
<p id="udf-assign-to-state-examples"><strong>Assigning of a custom function to a State</strong></p>
<p>A custom function can also be assigned as the <a class="reference internal" href="State.html#psyneulink.core.components.states.state.State_Base.function" title="psyneulink.core.components.states.state.State_Base.function"><code class="xref any py py-attr docutils literal"><span class="pre">function</span></code></a> of an <a class="reference internal" href="InputState.html"><span class="doc">InputState</span></a> or <a class="reference internal" href="OutputState.html"><span class="doc">OutputState</span></a>.
For example, the following assigns <code class="docutils literal"><span class="pre">my_sinusoidal_fct</span></code> to the <a class="reference internal" href="OutputState.html#psyneulink.core.components.states.outputstate.OutputState.function" title="psyneulink.core.components.states.outputstate.OutputState.function"><code class="xref any py py-attr docutils literal"><span class="pre">function</span></code></a> of an OutputState
of <code class="docutils literal"><span class="pre">my_mech</span></code>, rather the Mechanism’s <a class="reference internal" href="Mechanism.html#psyneulink.core.components.mechanisms.mechanism.Mechanism_Base.function" title="psyneulink.core.components.mechanisms.mechanism.Mechanism_Base.function"><code class="xref any py py-attr docutils literal"><span class="pre">function</span></code></a>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">my_wave_mech</span> <span class="o">=</span> <span class="n">pnl</span><span class="o">.</span><span class="n">ProcessingMechanism</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="gp">... </span>                                       <span class="n">function</span><span class="o">=</span><span class="n">pnl</span><span class="o">.</span><span class="n">Linear</span><span class="p">,</span>
<span class="gp">... </span>                                       <span class="n">output_states</span><span class="o">=</span><span class="p">[{</span><span class="n">pnl</span><span class="o">.</span><span class="n">NAME</span><span class="p">:</span> <span class="s1">&#39;SINUSOIDAL OUTPUT&#39;</span><span class="p">,</span>
<span class="gp">... </span>                                                      <span class="n">pnl</span><span class="o">.</span><span class="n">VARIABLE</span><span class="p">:</span> <span class="p">[(</span><span class="n">pnl</span><span class="o">.</span><span class="n">OWNER_VALUE</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span><span class="n">pnl</span><span class="o">.</span><span class="n">EXECUTION_COUNT</span><span class="p">],</span>
<span class="gp">... </span>                                                      <span class="n">pnl</span><span class="o">.</span><span class="n">FUNCTION</span><span class="p">:</span> <span class="n">my_sinusoidal_fct</span><span class="p">}])</span>
</pre></div>
</div>
<p>For details on how to specify a function of an OutputState, see <a class="reference internal" href="OutputState.html#outputstate-customization"><span class="std std-ref">OutputState Customization</span></a>.
Below is an example plot of the output of the ‘SINUSOIDAL OUTPUT’ <a class="reference internal" href="OutputState.html"><span class="doc">OutputState</span></a> from my_wave_mech above, as the
execution count increments, when the input to the mechanism is 0.005 for 1000 runs:</p>
</div></blockquote>
<div class="figure">
<a class="reference internal image-reference" href="_images/sinusoid_005.png"><img alt="Sinusoid function" src="_images/sinusoid_005.png" style="width: 640.0px; height: 480.0px;" /></a>
</div>
<blockquote id="udf-modulatory-params-examples">
<div><p>The parameters of a custom function assigned to an InputState or OutputState can also be used for <code class="xref any docutils literal"><span class="pre">gating</span></code>.  However, this requires that its <a class="reference internal" href="Functions.html#function-modulatory-params"><span class="std std-ref">Modulatory Parameters</span></a> be specified
(see <a class="reference internal" href="#udf-modulatory-params"><span class="std std-ref">above</span></a>). This can be done by including a <strong>params</strong> argument in the definition of
the function itself:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">my_sinusoidal_fct</span><span class="p">(</span><span class="nb">input</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">]],</span>
<span class="gp">... </span>                     <span class="n">phase</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="gp">... </span>                     <span class="n">amplitude</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="gp">... </span>                     <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="n">pnl</span><span class="o">.</span><span class="n">ADDITIVE_PARAM</span><span class="p">:</span><span class="s1">&#39;phase&#39;</span><span class="p">,</span>
<span class="gp">... </span>                             <span class="n">pnl</span><span class="o">.</span><span class="n">MULTIPLICATIVE_PARAM</span><span class="p">:</span><span class="s1">&#39;amplitude&#39;</span><span class="p">}):</span>
<span class="gp">... </span>   <span class="n">frequency</span> <span class="o">=</span> <span class="nb">input</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">... </span>   <span class="n">t</span> <span class="o">=</span> <span class="nb">input</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">... </span>   <span class="k">return</span> <span class="n">amplitude</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">frequency</span> <span class="o">*</span> <span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span>
</pre></div>
</div>
<p>or in the explicit creation of a UDF:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">my_sinusoidal_UDF</span> <span class="o">=</span> <span class="n">pnl</span><span class="o">.</span><span class="n">UserDefinedFunction</span><span class="p">(</span><span class="n">custom_function</span><span class="o">=</span><span class="n">my_sinusoidal_fct</span><span class="p">,</span>
<span class="gp">... </span>                                            <span class="n">phase</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="gp">... </span>                                            <span class="n">amplitude</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="gp">... </span>                                            <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="n">pnl</span><span class="o">.</span><span class="n">ADDITIVE_PARAM</span><span class="p">:</span><span class="s1">&#39;phase&#39;</span><span class="p">,</span>
<span class="gp">... </span>                                                    <span class="n">pnl</span><span class="o">.</span><span class="n">MULTIPLICATIVE_PARAM</span><span class="p">:</span><span class="s1">&#39;amplitude&#39;</span><span class="p">})</span>
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">phase</span></code> and <code class="docutils literal"><span class="pre">amplitude</span></code> parameters of <code class="docutils literal"><span class="pre">my_sinusoidal_fct</span></code> can now be used as the
<a class="reference internal" href="Functions.html#function-modulatory-params"><span class="std std-ref">Modulatory Parameters</span></a> for gating any InputState or OutputState to which the function is assigned (see
<code class="xref any docutils literal"><span class="pre">GatingMechanism_Specifying_Gating</span></code> and <a class="reference internal" href="GatingSignal.html#gatingsignal-examples"><span class="std std-ref">Examples</span></a>).</p>
<p><strong>Class Definition:</strong></p>
<dl class="docutils">
<dt>custom_function <span class="classifier-delimiter">:</span> <span class="classifier">function</span></dt>
<dd>specifies the function to “wrap.” It can be any function or method, including a lambda function;
see <a class="reference internal" href="#udf-description"><span class="std std-ref">above</span></a> for additional details.</dd>
<dt>params <span class="classifier-delimiter">:</span> <span class="classifier">Dict[param keyword: param value]</span> <span class="classifier-delimiter">:</span> <span class="classifier">default None</span></dt>
<dd><p class="first">a <a class="reference internal" href="ParameterState.html#parameterstate-specification"><span class="std std-ref">parameter dictionary</span></a> that specifies the parameters for the function.
This can be used to define an <code class="xref any docutils literal"><span class="pre">additive_param</span></code> and/or
<code class="xref any docutils literal"><span class="pre">multiplicative_param</span></code> for the UDF, by including one or both
of the following entries:</p>
<blockquote>
<div><p><em>ADDITIVE_PARAM</em>: &lt;param_name&gt;</p>
<p><em>MULTIPLICATIVE_PARAM</em>: &lt;param_name&gt;</p>
</div></blockquote>
<p class="last">Values specified for parameters in the dictionary override any assigned to those parameters in arguments of
the constructor.</p>
</dd>
<dt>owner <span class="classifier-delimiter">:</span> <span class="classifier">Component</span></dt>
<dd><a class="reference internal" href="Component.html"><span class="doc">component</span></a> to which to assign the Function.</dd>
<dt>name <span class="classifier-delimiter">:</span> <span class="classifier">str</span> <span class="classifier-delimiter">:</span> <span class="classifier">default see <code class="xref any docutils literal"><span class="pre">name</span></code></span></dt>
<dd>specifies the name of the Function.</dd>
<dt>prefs <span class="classifier-delimiter">:</span> <span class="classifier">PreferenceSet or specification dict</span> <span class="classifier-delimiter">:</span> <span class="classifier">default Function.classPreferences</span></dt>
<dd>specifies the <a class="reference internal" href="Preferences.html#psyneulink.core.globals.preferences.PreferenceSet" title="psyneulink.core.globals.preferences.PreferenceSet"><code class="xref any py py-class docutils literal"><span class="pre">PreferenceSet</span></code></a> for the Function (see <a class="reference internal" href="Functions.html#psyneulink.core.components.functions.function.Function_Base.prefs" title="psyneulink.core.components.functions.function.Function_Base.prefs"><code class="xref any py py-attr docutils literal"><span class="pre">prefs</span></code></a> for details).</dd>
</dl>
<dl class="docutils">
<dt>variable: value</dt>
<dd>format and default value of the function “wrapped” by the UDF.</dd>
<dt>custom_function <span class="classifier-delimiter">:</span> <span class="classifier">function</span></dt>
<dd>the user-specified function: called by the Function’s <a class="reference internal" href="Functions.html#psyneulink.core.components.functions.function.Function_Base.owner" title="psyneulink.core.components.functions.function.Function_Base.owner"><code class="xref any py py-attr docutils literal"><span class="pre">owner</span></code></a> when it is executed.</dd>
<dt>additive_param <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd>this contains the name of the additive_param, if one has been specified for the UDF
(see <a class="reference internal" href="#udf-modulatory-params"><span class="std std-ref">above</span></a> for details).</dd>
<dt>multiplicative_param <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd>this contains the name of the multiplicative_param, if one has been specified for the UDF
(see <a class="reference internal" href="#udf-modulatory-params"><span class="std std-ref">above</span></a> for details).</dd>
<dt>owner <span class="classifier-delimiter">:</span> <span class="classifier">Component</span></dt>
<dd><a class="reference internal" href="Component.html"><span class="doc">component</span></a> to which the Function has been assigned.</dd>
<dt>name <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd>the name of the Function; if it is not specified in the <strong>name</strong> argument of the constructor, a
default is assigned by FunctionRegistry (see <a class="reference internal" href="Naming.html"><span class="doc">Naming</span></a> for conventions used for default and duplicate names).</dd>
<dt>prefs <span class="classifier-delimiter">:</span> <span class="classifier">PreferenceSet or specification dict</span></dt>
<dd>the <a class="reference internal" href="Preferences.html#psyneulink.core.globals.preferences.PreferenceSet" title="psyneulink.core.globals.preferences.PreferenceSet"><code class="xref any py py-class docutils literal"><span class="pre">PreferenceSet</span></code></a> for the Function; if it is not specified in the <strong>prefs</strong> argument of the
constructor, a default is assigned using <code class="xref any docutils literal"><span class="pre">classPreferences</span></code> defined in __init__.py (see <span class="xref std std-doc">PreferenceSet</span> for details).</dd>
</dl>
</div></blockquote>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="TransferFunctions.html" class="btn btn-neutral float-right" title="TransferFunctions" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Functions.html" class="btn btn-neutral float-left" title="Functions" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Jonathan D. Cohen

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>