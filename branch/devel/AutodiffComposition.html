


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>AutodiffComposition &mdash; PsyNeuLink 0.17.0.0+4.ge755c96a3 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!-- <link rel="stylesheet" href="_static/pygments.css" type="text/css" /> -->
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/custom.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="CompositionFunctionApproximator" href="CompositionFunctionApproximator.html" />
    <link rel="prev" title="Compositions" href="Compositions.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

  <!-- Preload the theme fonts -->

<link rel="preload" href="_static/fonts/FreightSans/freight-sans-book.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/FreightSans/freight-sans-medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/IBMPlexMono/IBMPlexMono-Medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/FreightSans/freight-sans-bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/FreightSans/freight-sans-medium-italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/IBMPlexMono/IBMPlexMono-SemiBold.woff2" as="font" type="font/woff2" crossorigin="anonymous">

<!-- Preload the katex fonts -->

<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Math-Italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size1-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size4-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size2-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size3-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Caligraphic-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
</head>

<div class="container-fluid header-holder tutorials-header" id="header-holder">
  <div class="container">
    <div class="header-container">
      <a class="header-logo" href="https://princetonuniversity.github.io/PsyNeuLink/"></a>
<!--      <a class="header-logo"></a>-->
      <div class="main-menu">
        <ul>
          <li>
            <a href="https://github.com/PrincetonUniversity/PsyNeuLink">Github</a>
          </li>
        </ul>
      </div>

      <a class="main-menu-open-button" href="#" data-behavior="open-mobile-menu"></a>
    </div>

  </div>
</div>


<body class="psyneulink-body">

   

    

    <div class="table-of-contents-link-wrapper">
      <span>Table of Contents</span>
      <a href="#" class="toggle-table-of-contents" data-behavior="toggle-table-of-contents"></a>
    </div>

    <nav data-toggle="wy-nav-shift" class="psyneulink-left-menu" id="psyneulink-left-menu">
      <div class="psyneulink-side-scroll">
        <div class="psyneulink-menu psyneulink-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          <div class="psyneulink-left-menu-search">
            

            
              
              
                <div class="version">
                  0.17.0.0+4
                </div>
              
            

            


  


<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search Docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

            
          </div>
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">Welcome to PsyNeuLink </a></li>
<li class="toctree-l1"><a class="reference internal" href="BasicsAndPrimer.html">Basics and Primer</a></li>
<li class="toctree-l1"><a class="reference internal" href="QuickReference.html">Quick Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="Core.html">Core</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="Library.html">Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="ContributorsGuide.html">Contributors Guide</a></li>
</ul>

            
          
          <div class="psyneulink-dev-mode-toggle">
          </div>
        </div>
      </div>
    </nav>
    <div class="psyneulink-container">
      <div class="psyneulink-page-level-bar" id="psyneulink-page-level-bar">
        <div class="psyneulink-breadcrumbs-wrapper">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="psyneulink-breadcrumbs">
    
      <li>
        <a href="index.html">
          
            Docs
          
        </a> &gt;
      </li>

        
          <li><a href="Library.html">Library</a> &gt;</li>
        
          <li><a href="Compositions.html">Compositions</a> &gt;</li>
        
      <li>AutodiffComposition</li>
    
  </ul>

  
</div>
        </div>

        <div class="psyneulink-shortcuts-wrapper" id="psyneulink-shortcuts-wrapper">
          Shortcuts
        </div>
      </div>

      <section data-toggle="wy-nav-shift" id="psyneulink-content-wrap" class="psyneulink-content-wrap">
        <div class="psyneulink-content-left">

        
          
          <div class="rst-content">
          
            <div role="main" class="main-content" itemscope="itemscope" itemtype="http://schema.org/Article">
             <article itemprop="articleBody" id="psyneulink-article" class="psyneulink-article">
              
  <section id="autodiffcomposition">
<h1>AutodiffComposition<a class="headerlink" href="#autodiffcomposition" title="Link to this heading">¶</a></h1>
<div class="related docutils container">
<p><em>Related</em></p>
<ul class="simple">
<li><p><a class="reference internal" href="Composition.html#composition-learning"><span class="std std-ref">Learning in a Composition</span></a></p></li>
<li><p><a class="reference internal" href="Composition.html#composition-bias-nodes"><span class="std std-ref">BIAS Nodes</span></a></p></li>
</ul>
</div>
<section id="contents">
<span id="module-psyneulink.library.compositions.autodiffcomposition"></span><h2>Contents<a class="headerlink" href="#contents" title="Link to this heading">¶</a></h2>
<blockquote>
<div><ul>
<li><p><a class="reference internal" href="#autodiffcomposition-overview"><span class="std std-ref">Overview</span></a></p></li>
<li><dl>
<dt><a class="reference internal" href="#autodiffcomposition-creation"><span class="std std-ref">Creating an AutodiffComposition</span></a></dt><dd><ul class="simple">
<li><dl class="simple">
<dt><a class="reference internal" href="#"><span class="doc">AutodiffComposition</span></a></dt><dd><ul>
<li><p><a class="reference internal" href="#autodiffcomposition-modulatory-mechanisms"><span class="std std-ref">No Modulatory Components</span></a></p></li>
<li><p><a class="reference internal" href="#autodiffcomposition-bias-parameters"><span class="std std-ref">No Bias Parameters</span></a></p></li>
<li><p><a class="reference internal" href="#autodiffcomposition-nesting"><span class="std std-ref">Nesting</span></a></p></li>
<li><p><a class="reference internal" href="#autodiffcomposition-learning-rates"><span class="std std-ref">Learning Rates and Optimizer Params</span></a></p></li>
<li><p><a class="reference internal" href="#autodiffcomposition-exchange-with-torch-parameters"><span class="std std-ref">Exchanging Parameters with Pytorch Modules</span></a></p></li>
<li><p><a class="reference internal" href="#autodiffcomposition-post-construction-modification"><span class="std std-ref">No Post-construction Modification</span></a></p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<ul class="simple">
<li><dl class="simple">
<dt><a class="reference internal" href="#autodiffcomposition-execution"><span class="std std-ref">Execution</span></a></dt><dd><ul>
<li><p><a class="reference internal" href="#autodiffcomposition-pytorch"><span class="std std-ref">PyTorch mode</span></a></p></li>
<li><p><a class="reference internal" href="#autodiffcomposition-llvm"><span class="std std-ref">LLVM mode</span></a></p></li>
<li><p><a class="reference internal" href="#autodiffcomposition-python"><span class="std std-ref">Python mode</span></a></p></li>
<li><p><a class="reference internal" href="#autodiffcomposition-nested-modulation"><span class="std std-ref">Nested Execution and Modulation</span></a></p></li>
<li><p><a class="reference internal" href="#autodiffcomposition-logging"><span class="std std-ref">Logging</span></a></p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
<li><p><a class="reference internal" href="#autodiffcomposition-examples"><span class="std std-ref">Examples</span></a></p></li>
<li><p><a class="reference internal" href="#autodiffcomposition-class-reference"><span class="std std-ref">Class Reference</span></a></p></li>
</ul>
</div></blockquote>
</section>
<section id="overview">
<span id="autodiffcomposition-overview"></span><h2>Overview<a class="headerlink" href="#overview" title="Link to this heading">¶</a></h2>
<p>AutodiffComposition is a subclass of <a class="reference internal" href="Composition.html"><span class="doc">Composition</span></a> for constructing and training feedforward neural network
either, using either direct compilation (to LLVM) or automatic conversion to <a class="reference external" href="https://pytorch.org/">PyTorch</a>,
both of which considerably accelerate training (by as much as three orders of magnitude) compared to the
<a class="reference internal" href="Composition.html#composition-learning-standard"><span class="std std-ref">standard implementation of learning</span></a> in a Composition.  Although an
AutodiffComposition is constructed and executed in much the same way as a standard Composition, it largely restricted
to feedforward neural networks using <a class="reference internal" href="Composition.html#composition-learning-supervised"><span class="std std-ref">supervised learning</span></a>, and in particular the
the <a class="reference external" href="https://en.wikipedia.org/wiki/Backpropagation">backpropagation learning algorithm</a>. although it can be used for
some forms of <a class="reference internal" href="Composition.html#composition-learning-unsupervised"><span class="std std-ref">unsupervised learning</span></a> that are supported in PyTorch (e.g.,
<a class="reference external" href="https://github.com/giannisnik/som">self-organized maps</a>).</p>
</section>
<section id="creating-an-autodiffcomposition">
<span id="autodiffcomposition-creation"></span><h2>Creating an AutodiffComposition<a class="headerlink" href="#creating-an-autodiffcomposition" title="Link to this heading">¶</a></h2>
<p>An AutodiffComposition can be created by calling its constructor, and then adding <a class="reference internal" href="Component.html"><span class="doc">Components</span></a> using
the standard <a class="reference internal" href="Composition.html#composition-creation"><span class="std std-ref">Composition methods</span></a> for doing so (e.g., <a class="reference internal" href="Composition.html#psyneulink.core.compositions.composition.Composition.add_node" title="psyneulink.core.compositions.composition.Composition.add_node"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">add_node</span></code></a>,
<a class="reference internal" href="Composition.html#psyneulink.core.compositions.composition.Composition.add_projections" title="psyneulink.core.compositions.composition.Composition.add_projections"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">add_projection</span></code></a>,  <a class="reference internal" href="Composition.html#psyneulink.core.compositions.composition.Composition.add_linear_processing_pathway" title="psyneulink.core.compositions.composition.Composition.add_linear_processing_pathway"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">add_linear_processing_pathway</span></code></a>, etc.). The constructor also includes a number of parameters that are
specific to the AutodiffComposition (see <a class="reference internal" href="#autodiffcomposition-class-reference"><span class="std std-ref">Class Reference</span></a> for a list of these parameters,
and <a class="reference internal" href="#autodiffcomposition-examples"><span class="std std-ref">examples</span></a> below). While an AutodiffComposition can generally be created using the
same methods as a standard Composition, there are a few restrictions that apply to its construction, summarized below.</p>
<section id="only-one-outputport-per-node">
<span id="autodiffcomposition-restrictions"></span><h3><em>Only one OutputPort per Node</em><a class="headerlink" href="#only-one-outputport-per-node" title="Link to this heading">¶</a></h3>
<p>The <a class="reference internal" href="Composition.html#composition-nodes"><span class="std std-ref">Nodes</span></a> of an AutodiffComposition currently can have only <em>one</em> <a class="reference internal" href="OutputPort.html"><span class="doc">OutputPort</span></a>, though that
can have more than one <a class="reference internal" href="Port.html#psyneulink.core.components.ports.port.Port_Base.efferents" title="psyneulink.core.components.ports.port.Port_Base.efferents"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">efferent</span></code></a> <a class="reference internal" href="MappingProjection.html"><span class="doc">MappingProjection</span></a>.  Nodes can also have more than one
<a class="reference internal" href="InputPort.html"><span class="doc">InputPort</span></a>, that can receive more than one <a class="reference internal" href="Port.html#psyneulink.core.components.ports.port.Port_Base.path_afferents" title="psyneulink.core.components.ports.port.Port_Base.path_afferents"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">afferent</span> <span class="pre">`path_afferent</span></code></a> Projections.</p>
</section>
<section id="no-modulatory-components">
<span id="autodiffcomposition-modulatory-mechanisms"></span><h3><em>No Modulatory Components</em><a class="headerlink" href="#no-modulatory-components" title="Link to this heading">¶</a></h3>
<p>All of the Components in an AutodiffComposition must be able to be subjected to <a class="reference internal" href="Composition.html#composition-learning"><span class="std std-ref">learning</span></a>,
which means that no <a class="reference internal" href="ModulatoryMechanism.html"><span class="doc">ModulatoryMechanisms</span></a> can be included in an AutodiffComposition.
Specifically, this precludes any <a class="reference internal" href="Composition.html#composition-learning-components"><span class="std std-ref">learning components</span></a>, <a class="reference internal" href="ControlMechanism.html"><span class="doc">ControlMechanisms</span></a>, or a <a class="reference internal" href="Composition.html#composition-controller"><span class="std std-ref">controller</span></a>.</p>
<p id="autodiff-learning-components-warning"><em>Learning Components</em>.  An AutodiffComposition <strong>cannot include any</strong> <a class="reference internal" href="Composition.html#composition-learning-components"><span class="std std-ref">learning components</span></a> themselves (i.e., <a class="reference internal" href="LearningMechanism.html"><span class="doc">LearningMechanisms</span></a>, <a class="reference internal" href="LearningSignal.html"><span class="doc">LearningSignals</span></a>, or <a class="reference internal" href="LearningProjection.html"><span class="doc">LearningProjections</span></a>, nor the <a class="reference internal" href="ComparatorMechanism.html"><span class="doc">ComparatorMechanism</span></a>
or <a class="reference internal" href="ObjectiveMechanism.html"><span class="doc">ObjectiveMechanism</span></a> used to compute the loss for learning). These are constructed
automatically when learning is executed in <a class="reference internal" href="#autodiffcomposition-python"><span class="std std-ref">Python mode</span></a> or <a class="reference internal" href="#autodiffcomposition-llvm"><span class="std std-ref">LLVM mode</span></a>, and PyTorch-compatible Components are constructed when it is executed in
<a class="reference internal" href="#autodiffcomposition-pytorch"><span class="std std-ref">PyTorch mode</span></a>.</p>
<p><em>Control Components</em>. An AutodiffComposition also cannot include any <a class="reference internal" href="ControlMechanism.html"><span class="doc">ControlMechanisms</span></a> or a
<a class="reference internal" href="Composition.html#composition-controller"><span class="std std-ref">controller</span></a>.  However, it <em>can</em> include Mechanisms that are subject to modulatory control
(see <a class="reference internal" href="ModulatorySignal.html#modulatorysignal-anatomy-figure"><span class="std std-ref">Figure</span></a>, and <a class="reference internal" href="ModulatorySignal.html#modulatorysignal-modulation"><span class="std std-ref">modulation</span></a>) by ControlMechanisms
<em>outside</em> the Composition, including the controller of a Composition within which the AutodiffComposition is nested.
That is, an AutodiffComposition can be <a class="reference internal" href="Composition.html#composition-nested"><span class="std std-ref">nested in a Composition</span></a> that has other such Components
(see <a class="reference internal" href="#autodiffcomposition-nested-modulation"><span class="std std-ref">Nested Execution and Modulation</span></a> below).</p>
</section>
<section id="no-bias-parameters">
<span id="autodiffcomposition-bias-parameters"></span><h3><em>No Bias Parameters</em><a class="headerlink" href="#no-bias-parameters" title="Link to this heading">¶</a></h3>
<p>AutodiffComposition does not (currently) support the <em>automatic</em> construction of separate bias parameters.
Thus, when constructing the PyTorch version of an AutodiffComposition, the <a class="reference external" href="https://www.pytorch.org/docs/stable/nn.html#torch.nn.Module">bias</a> parameter of any PyTorch modules are set to False.
However, biases can be implemented using <a class="reference internal" href="Composition.html#composition-bias-nodes"><span class="std std-ref">BIAS Nodes</span></a>.</p>
</section>
<section id="nesting">
<span id="autodiffcomposition-nesting"></span><h3><em>Nesting</em><a class="headerlink" href="#nesting" title="Link to this heading">¶</a></h3>
<p>An AutodiffComposition can be <a class="reference internal" href="Composition.html#composition-nested"><span class="std std-ref">nested</span></a> inside another Composition for learning, and there can
be any level of such nestings.  However, all of the nested Compositions must be AutodiffCompositions. Furthermore, all
nested Compositions use the <a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.learning_rate" title="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.learning_rate"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">learning_rate</span></code></a> specified for the outermost Composition,
whether this is specified in the call to its <a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.learn" title="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.learn"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">learn</span></code></a> method, its constructor, or its
default value is being used (see <a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.learning_rate" title="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.learning_rate"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">learning_rate</span></code></a> below for additional details).</p>
<div class="technical-note docutils container">
<p>Projections from <a class="reference internal" href="Composition.html#composition-nodes"><span class="std std-ref">Nodes</span></a> in an immediately enclosing outer Composition to the <a class="reference internal" href="Composition.html#psyneulink.core.compositions.composition.Composition.input_CIM" title="psyneulink.core.compositions.composition.Composition.input_CIM"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">input_CIM</span></code></a> of a nested Composition, and from its <a class="reference internal" href="Composition.html#psyneulink.core.compositions.composition.Composition.output_CIM" title="psyneulink.core.compositions.composition.Composition.output_CIM"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">output_CIM</span></code></a> to Nodes
in the outer Composition are subject to learning;  however those within the nested Composition itself (i.e.,
from its input_CIM to its INPUT Nodes and from its OUTPUT Nodes to its output_CIM) are <em>not</em> subject to learning,
as they serve simply as conduits of information between the outer Composition and the nested one.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Nested Compositions are supported for learning only in <a class="reference internal" href="#autodiffcomposition-pytorch"><span class="std std-ref">PyTorch mode</span></a>, and will
cause an error if the <a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.learn" title="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.learn"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">learn</span></code></a> method of an AutodiffComposition is executed in
<a class="reference internal" href="#autodiffcomposition-python"><span class="std std-ref">Python mode</span></a> or <a class="reference internal" href="#autodiffcomposition-llvm"><span class="std std-ref">LLVM mode</span></a>.</p>
</div>
</section>
<section id="learning-rates-and-optimizer-params">
<span id="autodiffcomposition-learning-rates"></span><h3><em>Learning Rates and Optimizer Params</em><a class="headerlink" href="#learning-rates-and-optimizer-params" title="Link to this heading">¶</a></h3>
<p>The <strong>optimizer_params</strong> argument of the constructor can be used to specify parameters for the optimizer used for
learning by the AutodiffComposition. At present, this is restricted to overriding the <a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.learning_rate" title="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.learning_rate"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">learning_rate</span></code></a> Parameter of the Composition (used as the default by the <a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.optimizer" title="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.optimizer"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">optimizer</span></code></a>) to assign individual learning rates to specific Projections. This is done by
specifying <strong>optimizer_params</strong> as a dict, in which each key is a reference to a learnable <a class="reference internal" href="MappingProjection.html"><span class="doc">MappingProjection</span></a>
in the AutodiffComposition, and the value of which specifies its learning_rate. Sublcasses of AutodiffComposition may
involve different forms of specification and/or support other parameters for the optimizer. Projections that are not
sepcified in <strong>optimizer_params</strong> use, in order of precedence: the <a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.learning_rate" title="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.learning_rate"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">learning_rate</span></code></a>
specified in the call to the AutodiffComposition’s <a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.learn" title="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.learn"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">learn</span></code></a> method, the <strong>learning_rate</strong>
argument of its constructor, or the default value for the AutodiffComposition.</p>
</section>
<section id="exchanging-parameters-with-pytorch-modules">
<span id="autodiffcomposition-exchange-with-torch-parameters"></span><h3><em>Exchanging Parameters with Pytorch Modules</em><a class="headerlink" href="#exchanging-parameters-with-pytorch-modules" title="Link to this heading">¶</a></h3>
<p>The AutodiffComposition’s <a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.copy_torch_param_to_projection_matrix" title="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.copy_torch_param_to_projection_matrix"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">copy_torch_param_to_projection_matrix</span></code></a> and <a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.copy_projection_matrix_to_torch_param" title="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.copy_projection_matrix_to_torch_param"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">copy_projection_matrix_to_torch_param</span></code></a> methods
can be used to exchange weight matrices between the parameters of a PyTorch module and the <a class="reference internal" href="MappingProjection.html#psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection.matrix" title="psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection.matrix"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">matrix</span></code></a> Parameter of a <a class="reference internal" href="MappingProjection.html"><span class="doc">MappingProjection</span></a> in the AutodiffComposition. Pytorch Parameters can
be referenced flexibly, either by the Parameter object itself, or by the module and either the name or index of the
Parameter in the module’s state_dict or parameter list, respectively. Slices of PyTorch Parameters can also be used,
for cases in which the matrix of a Project corresponds to only a subpart of the PyTorch Parameter (e.g., for
<a class="reference internal" href="GRUComposition.html"><span class="doc">GRUComposition</span></a>). Both methods return the item assigned.</p>
</section>
<section id="no-post-construction-modification">
<span id="autodiffcomposition-post-construction-modification"></span><h3><em>No Post-construction Modification</em><a class="headerlink" href="#no-post-construction-modification" title="Link to this heading">¶</a></h3>
<p>Mechanisms or Projections should not be added to or deleted from an AutodiffComposition after it has
been executed. Unlike an ordinary Composition, AutodiffComposition does not support this functionality.</p>
</section>
</section>
<section id="execution">
<span id="autodiffcomposition-execution"></span><h2>Execution<a class="headerlink" href="#execution" title="Link to this heading">¶</a></h2>
<p>An AutodiffComposition’s <a class="reference internal" href="Composition.html#psyneulink.core.compositions.composition.Composition.run" title="psyneulink.core.compositions.composition.Composition.run"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">run</span></code></a>, <a class="reference internal" href="Composition.html#psyneulink.core.compositions.composition.Composition.execute" title="psyneulink.core.compositions.composition.Composition.execute"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">execute</span></code></a>, and <a class="reference internal" href="Composition.html#psyneulink.core.compositions.composition.Composition.learn" title="psyneulink.core.compositions.composition.Composition.learn"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">learn</span></code></a>
methods are the same as for a <a class="reference internal" href="Composition.html"><span class="doc">Composition</span></a>.  However, the <strong>execution_mode</strong> in the <a class="reference internal" href="Composition.html#psyneulink.core.compositions.composition.Composition.learn" title="psyneulink.core.compositions.composition.Composition.learn"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">learn</span></code></a>
method has different effects than for a standard Composition, that determine whether it uses <a class="reference internal" href="#autodiffcomposition-llvm"><span class="std std-ref">LLVM compilation</span></a> or <a class="reference internal" href="#autodiffcomposition-pytorch"><span class="std std-ref">translation to PyTorch</span></a> to execute learning.
These are each described in greater detail below, and summarized in this <a class="reference internal" href="Composition.html#composition-compilation-table"><span class="std std-ref">table</span></a>
which provides a comparison of the different modes of execution for an AutodiffComposition and standard <a class="reference internal" href="Composition.html"><span class="doc">Composition</span></a>.</p>
<section id="pytorch-mode">
<span id="autodiffcomposition-pytorch"></span><h3><em>PyTorch mode</em><a class="headerlink" href="#pytorch-mode" title="Link to this heading">¶</a></h3>
<p>This is the default for an AutodiffComposition, but, can be specified explicitly by setting <strong>execution_mode</strong> =
<a class="reference internal" href="LLVM.html#psyneulink.core.llvm.__init__.ExecutionMode.PyTorch" title="psyneulink.core.llvm.__init__.ExecutionMode.PyTorch"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">ExecutionMode.PyTorch</span></code></a> in the <a class="reference internal" href="Composition.html#psyneulink.core.compositions.composition.Composition.learn" title="psyneulink.core.compositions.composition.Composition.learn"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">learn</span></code></a> method (see <a class="reference internal" href="BasicsAndPrimer.html#basicsandprimer-rumelhart-model"><span class="std std-ref">example</span></a>
in <a class="reference internal" href="BasicsAndPrimer.html"><span class="doc">Basics and Primer</span></a>).  In this mode, the AutodiffComposition is automatically translated to a <a class="reference external" href="https://pytorch.org">PyTorch</a> model for learning.  This is comparable in speed to <code class="xref any docutils literal notranslate"><span class="pre">LLVM</span> <span class="pre">compilation</span></code>, but provides greater flexiblity, including the ability to include nested
AutoDiffCompositions in learning. Although it is best suited for use with <a class="reference internal" href="Composition.html#composition-learning-supervised"><span class="std std-ref">supervised learning</span></a>, it can also be used for some forms of <a class="reference internal" href="Composition.html#composition-learning-unsupervised"><span class="std std-ref">unsupervised learning</span></a> that are supported in PyTorch (e.g., <a class="reference external" href="https://github.com/giannisnik/som">self-organized maps</a>).</p>
<blockquote>
<div><div class="admonition note" id="autodiffcomposition-pytorch-note">
<p class="admonition-title">Note</p>
<p>While specifying <a class="reference internal" href="LLVM.html#psyneulink.core.llvm.__init__.ExecutionMode.PyTorch" title="psyneulink.core.llvm.__init__.ExecutionMode.PyTorch"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">ExecutionMode.PyTorch</span></code></a> in the <a class="reference internal" href="Composition.html#psyneulink.core.compositions.composition.Composition.learn" title="psyneulink.core.compositions.composition.Composition.learn"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">learn</span></code></a>  method of an AutodiffComposition
causes it to use PyTorch for training, specifying this in the <code class="xref any docutils literal notranslate"><span class="pre">run</span></code> method causes it to be
executed using the <em>Python</em> interpreter (and not PyTorch);  this is so that any modulation can take effect
during execution (see <a class="reference internal" href="#autodiffcomposition-nested-modulation"><span class="std std-ref">Nested Execution and Modulation</span></a> below), which is not supported by PyTorch.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<ul class="simple">
<li><p>Specifying <a class="reference internal" href="LLVM.html#psyneulink.core.llvm.__init__.ExecutionMode.LLVMRun" title="psyneulink.core.llvm.__init__.ExecutionMode.LLVMRun"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">ExecutionMode.LLVMRun</span></code></a> or <a class="reference internal" href="LLVM.html#psyneulink.core.llvm.__init__.ExecutionMode.PyTorch" title="psyneulink.core.llvm.__init__.ExecutionMode.PyTorch"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">ExecutionMode.PyTorch</span></code></a> in the learn() method of a standard
<a class="reference internal" href="Composition.html"><span class="doc">Composition</span></a> causes an error.</p></li>
</ul>
</div>
</div></blockquote>
</section>
<section id="llvm-mode">
<span id="autodiffcomposition-llvm"></span><h3><em>LLVM mode</em><a class="headerlink" href="#llvm-mode" title="Link to this heading">¶</a></h3>
<p>This is specified by setting <strong>execution_mode</strong> = <a class="reference internal" href="LLVM.html#psyneulink.core.llvm.__init__.ExecutionMode.LLVMRun" title="psyneulink.core.llvm.__init__.ExecutionMode.LLVMRun"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">ExecutionMode.LLVMRun</span></code></a> in the <a class="reference internal" href="Composition.html#psyneulink.core.compositions.composition.Composition.learn" title="psyneulink.core.compositions.composition.Composition.learn"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">learn</span></code></a> method
of an AutodiffCompositon.  This provides the fastest performance, but is limited to <a class="reference internal" href="Composition.html#composition-learning-supervised"><span class="std std-ref">supervised learning</span></a> using the <a class="reference internal" href="LearningFunctions.html#psyneulink.core.components.functions.learningfunctions.BackPropagation" title="psyneulink.core.components.functions.learningfunctions.BackPropagation"><code class="xref any py py-class docutils literal notranslate"><span class="pre">BackPropagation</span></code></a> algorithm. This can be run using standard forms of
loss, including mean squared error (MSE) and cross entropy, by specifying this in the <strong>loss_spec</strong> argument of
the constructor (see <a class="reference internal" href="#autodiffcomposition-class-reference"><span class="std std-ref">AutodiffComposition</span></a> for additional details, and
<a class="reference internal" href="Composition.html#composition-compiled-modes"><span class="std std-ref">Compilation Modes</span></a> for more information about executing a Composition in compiled mode.</p>
<blockquote>
<div><div class="admonition note">
<p class="admonition-title">Note</p>
<p>Specifying <a class="reference internal" href="LLVM.html#psyneulink.core.llvm.__init__.ExecutionMode.LLVMRun" title="psyneulink.core.llvm.__init__.ExecutionMode.LLVMRun"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">ExecutionMode.LLVMRun</span></code></a> in either the <a class="reference internal" href="Composition.html#psyneulink.core.compositions.composition.Composition.learn" title="psyneulink.core.compositions.composition.Composition.learn"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">learn</span></code></a> and <a class="reference internal" href="Composition.html#psyneulink.core.compositions.composition.Composition.run" title="psyneulink.core.compositions.composition.Composition.run"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">run</span></code></a>
methods of an AutodiffComposition causes it to (attempt to) use compiled execution in both cases; this is
because LLVM compilation supports the use of modulation in PsyNeuLink models (as compared to <a class="reference internal" href="#autodiffcomposition-pytorch"><span class="std std-ref">PyTorch mode</span></a>; see <a class="reference internal" href="#autodiffcomposition-pytorch-note"><span class="std std-ref">note</span></a> below).</p>
</div>
</div></blockquote>
</section>
<section id="python-mode">
<span id="autodiffcomposition-python"></span><h3><em>Python mode</em><a class="headerlink" href="#python-mode" title="Link to this heading">¶</a></h3>
<p>An AutodiffComposition can also be run using the standard PsyNeuLink learning components.  However, this cannot
be used if the AutodiffComposition has any nested Compositions, irrespective of whether they are ordinary
Compositions or AutodiffCompositions.</p>
</section>
<section id="nested-execution-and-modulation">
<span id="autodiffcomposition-nested-modulation"></span><h3><em>Nested Execution and Modulation</em><a class="headerlink" href="#nested-execution-and-modulation" title="Link to this heading">¶</a></h3>
<p># FIX:
Like any other <a class="reference internal" href="Composition.html"><span class="doc">Composition</span></a>, an AutodiffComposition may be <a class="reference internal" href="Composition.html#composition-nested"><span class="std std-ref">nested</span></a> inside another
(see <a class="reference internal" href="#autodiffcomposition-nested-example"><span class="std std-ref">example</span></a> below).  However, during learning, none of the internal
Components of the AutodiffComposition (e.g., intermediate layers of a neural network model) are accessible to the
other Components of the outer Composition, (e.g., as sources of information, or for <a class="reference internal" href="ModulatorySignal.html#modulatorysignal-modulation"><span class="std std-ref">modulation</span></a>).  However, when
it is executed using its <a class="reference internal" href="Composition.html#psyneulink.core.compositions.composition.Composition.run" title="psyneulink.core.compositions.composition.Composition.run"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">run</span></code></a> method, then the  AutodiffComposition functions like any other,
and all of its internal Components are accessible to other Components of the outer Composition. Thus, as long as access
to its internal Components is not needed during learning, an <a class="reference internal" href="#"><span class="doc">AutodiffComposition</span></a> can be trained, and then used to
execute the trained Composition like any other.</p>
</section>
<section id="logging">
<span id="autodiffcomposition-logging"></span><h3><em>Logging</em><a class="headerlink" href="#logging" title="Link to this heading">¶</a></h3>
<p>Logging in AutodiffCompositions follows the same procedure as <a class="reference internal" href="Log.html"><span class="doc">logging in a Composition</span></a>.
However, since an AutodiffComposition internally converts all of its Mechanisms either to LLVM
or to an equivalent PyTorch model, then its inner components are not actually executed. This means that there is
limited support for logging parameters of components inside an AutodiffComposition; Currently, the only supported
parameters are:</p>
<ol class="arabic simple">
<li><p>the <a class="reference internal" href="AutoAssociativeProjection.html#psyneulink.library.components.projections.pathway.autoassociativeprojection.AutoAssociativeProjection.matrix" title="psyneulink.library.components.projections.pathway.autoassociativeprojection.AutoAssociativeProjection.matrix"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">matrix</span></code></a> parameter of Projections</p></li>
<li><p>the <a class="reference internal" href="Component.html#psyneulink.core.components.component.Component.value" title="psyneulink.core.components.component.Component.value"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">value</span></code></a> parameter of its inner components</p></li>
</ol>
<p class="rubric" id="autodiffcomposition-examples">Examples</p>
<p id="autodiffcomposition-creation-example">The following is an example showing how to create a simple AutodiffComposition, specify its inputs and targets,
and run it with learning enabled and disabled:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">psyneulink</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pnl</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Set up PsyNeuLink Components</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_mech_1</span> <span class="o">=</span> <span class="n">pnl</span><span class="o">.</span><span class="n">TransferMechanism</span><span class="p">(</span><span class="n">function</span><span class="o">=</span><span class="n">pnl</span><span class="o">.</span><span class="n">Linear</span><span class="p">,</span> <span class="n">input_shapes</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_mech_2</span> <span class="o">=</span> <span class="n">pnl</span><span class="o">.</span><span class="n">TransferMechanism</span><span class="p">(</span><span class="n">function</span><span class="o">=</span><span class="n">pnl</span><span class="o">.</span><span class="n">Linear</span><span class="p">,</span> <span class="n">input_shapes</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_projection</span> <span class="o">=</span> <span class="n">pnl</span><span class="o">.</span><span class="n">MappingProjection</span><span class="p">(</span><span class="n">matrix</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>
<span class="gp">... </span>                    <span class="n">sender</span><span class="o">=</span><span class="n">my_mech_1</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">receiver</span><span class="o">=</span><span class="n">my_mech_2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create AutodiffComposition</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_autodiff</span> <span class="o">=</span> <span class="n">pnl</span><span class="o">.</span><span class="n">AutodiffComposition</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_autodiff</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">my_mech_1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_autodiff</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">my_mech_2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_autodiff</span><span class="o">.</span><span class="n">add_projection</span><span class="p">(</span><span class="n">sender</span><span class="o">=</span><span class="n">my_mech_1</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">my_projection</span><span class="p">,</span> <span class="n">receiver</span><span class="o">=</span><span class="n">my_mech_2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Specify inputs and targets</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_inputs</span> <span class="o">=</span> <span class="p">{</span><span class="n">my_mech_1</span><span class="p">:</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_targets</span> <span class="o">=</span> <span class="p">{</span><span class="n">my_mech_2</span><span class="p">:</span> <span class="p">[[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]]}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="n">my_inputs</span><span class="p">,</span> <span class="s2">&quot;targets&quot;</span><span class="p">:</span> <span class="n">my_targets</span><span class="p">,</span> <span class="s2">&quot;epochs&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Run Composition in learnng mode</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_autodiff</span><span class="o">.</span><span class="n">learn</span><span class="p">(</span><span class="n">inputs</span> <span class="o">=</span> <span class="n">input_dict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Run Composition in test mode</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_autodiff</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">inputs</span> <span class="o">=</span> <span class="n">input_dict</span><span class="p">[</span><span class="s1">&#39;inputs&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p id="autodiffcomposition-nested-example">The following shows how the AutodiffComposition created in the previous example can be nested and run inside another
Composition:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create outer composition</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_outer_composition</span> <span class="o">=</span> <span class="n">pnl</span><span class="o">.</span><span class="n">Composition</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_outer_composition</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">my_autodiff</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Specify dict containing inputs and targets for nested Composition</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">training_input</span> <span class="o">=</span> <span class="p">{</span><span class="n">my_autodiff</span><span class="p">:</span> <span class="n">input_dict</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Run in learning mode</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result1</span> <span class="o">=</span> <span class="n">my_outer_composition</span><span class="o">.</span><span class="n">learn</span><span class="p">(</span><span class="n">inputs</span><span class="o">=</span><span class="n">training_input</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="class-reference">
<span id="autodiffcomposition-class-reference"></span><h2>Class Reference<a class="headerlink" href="#class-reference" title="Link to this heading">¶</a></h2>
</section>
<dl class="py class">
<dt class="sig sig-object py" id="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">psyneulink.library.compositions.autodiffcomposition.</span></span><span class="sig-name descname"><span class="pre">AutodiffComposition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pathways</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sgd'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_spec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Loss.MSE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disable_learning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_no_retain_graph</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refresh_losses</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">synch_projection_matrices_with_torch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'run'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">synch_node_variables_with_torch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">synch_node_values_with_torch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'run'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">synch_results_with_torch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'run'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">retain_torch_trained_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'minibatch'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">retain_torch_targets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'minibatch'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">retain_torch_losses</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'minibatch'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disable_cuda</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cuda_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'autodiff_composition'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>AutodiffComposition(                                optimizer_type=’sgd’,</dt><dd><p>loss_spec=Loss.MSE,
weight_decay=0,
learning_rate=0.001,
optimizer_params=None,
disable_learning=False,
synch_projection_matrices_with_torch=RUN,
synch_node_variables_with_torch=None,
synch_node_values_with_torch=RUN,
synch_results_with_torch=RUN,
retain_torch_trained_outputs=MINIBATCH,
retain_torch_targets=MINIBATCH,
retain_torch_losses=MINIBATCH,
device=CPU
)</p>
</dd>
</dl>
<p>Subclass of <a class="reference internal" href="Composition.html"><span class="doc">Composition</span></a> that trains models using either LLVM compilation or <a class="reference external" href="https://pytorch.org">PyTorch</a>;
see and <a class="reference internal" href="Composition.html#composition-class-reference"><span class="std std-ref">Composition</span></a> for additional arguments and attributes.  See <a class="reference internal" href="Composition.html"><span class="doc">Composition</span></a>
for additional arguments to constructor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>optimizer_type</strong> (<em>str : default 'sgd'</em>) – the kind of optimizer used in training. The current options are ‘sgd’ or ‘adam’.</p></li>
<li><p><strong>loss_spec</strong> (<a class="reference internal" href="Keywords.html#psyneulink.core.globals.keywords.Loss" title="psyneulink.core.globals.keywords.Loss"><em>Loss</em></a><em> or </em><em>PyTorch loss function : default Loss.MSE</em>) – specifies the loss function for training; see <a class="reference internal" href="Keywords.html#psyneulink.core.globals.keywords.Loss" title="psyneulink.core.globals.keywords.Loss"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Loss</span></code></a> for arguments.</p></li>
<li><p><strong>weight_decay</strong> (<em>float : default 0</em>) – specifies the L2 penalty (which discourages large weights) used by the optimizer.</p></li>
<li><p><strong>learning_rate</strong> (<em>float : default 0.001</em>) – specifies the learning rate passed to the optimizer if none is specified in the <code class="xref any docutils literal notranslate"><span class="pre">learn</span></code> method of the AutodiffComposition;
see <a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.learning_rate" title="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.learning_rate"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">learning_rate</span></code></a> for additional details.</p></li>
<li><p><strong>optimizer_params</strong> (<em>Dict</em><em>[</em><em>str: value</em><em>]</em>) – specifies parameters for the optimizer used for learning by the GRUComposition
(see <a class="reference internal" href="#autodiffcomposition-learning-rates"><span class="std std-ref">Learning Rates and Optimizer Params</span></a> for details of specification.</p></li>
<li><p><strong>disable_learning</strong> (<em>bool: default False</em>) – specifies whether the AutodiffComposition should disable learning when run in <a class="reference internal" href="Composition.html#psyneulink.core.compositions.composition.Composition.learn" title="psyneulink.core.compositions.composition.Composition.learn"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">learning</span> <span class="pre">mode</span></code></a>.</p></li>
<li><p><strong>synch_projection_matrices_with_torch</strong> (<code class="xref any docutils literal notranslate"><span class="pre">LearningScale</span></code> : default RUN) – specifies the default for the AutodiffComposition for when to copy Pytorch parameters to PsyNeuLink
<a class="reference internal" href="MappingProjection.html#psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection.matrix" title="psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection.matrix"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">Projection</span> <span class="pre">matrices</span></code></a> (connection weights), which can be overridden by specifying
the <strong>synch_projection_matrices_with_torch</strong> argument in the <a class="reference internal" href="Composition.html#psyneulink.core.compositions.composition.Composition.learn" title="psyneulink.core.compositions.composition.Composition.learn"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">learn</span></code></a> method;
see <a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.synch_projection_matrices_with_torch" title="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.synch_projection_matrices_with_torch"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">synch_projection_matrices_with_torch</span></code></a>
for additional details.</p></li>
<li><p><strong>synch_node_variables_with_torch</strong> (<code class="xref any docutils literal notranslate"><span class="pre">LearningScale</span></code> : default None) – specifies the default for the AutodiffComposition for when to copy the current input to Pytorch nodes
to the PsyNeuLink <a class="reference internal" href="Mechanism.html#psyneulink.core.components.mechanisms.mechanism.Mechanism_Base.value" title="psyneulink.core.components.mechanisms.mechanism.Mechanism_Base.value"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">variable</span></code></a> attribute of the corresponding PsyNeuLink <code class="xref any docutils literal notranslate"><span class="pre">nodes</span></code>, which can be overridden by specifying the <strong>synch_node_variables_with_torch</strong> argument
in the <a class="reference internal" href="Composition.html#psyneulink.core.compositions.composition.Composition.learn" title="psyneulink.core.compositions.composition.Composition.learn"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">learn</span></code></a> method; see <a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.synch_node_variables_with_torch" title="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.synch_node_variables_with_torch"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">synch_node_variables_with_torch</span></code></a> for additional details.</p></li>
<li><p><strong>synch_node_values_with_torch</strong> (<code class="xref any docutils literal notranslate"><span class="pre">LearningScale</span></code> : default RUN) – specifies the default for the AutodiffComposition for when to copy the current output of Pytorch nodes to the
PsyNeuLink <a class="reference internal" href="Mechanism.html#psyneulink.core.components.mechanisms.mechanism.Mechanism_Base.value" title="psyneulink.core.components.mechanisms.mechanism.Mechanism_Base.value"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">value</span></code></a> attribute of the corresponding PsyNeuLink <code class="xref any docutils literal notranslate"><span class="pre">nodes</span></code>,
which can be overridden by specifying the <strong>synch_node_values_with_torch</strong> argument in the <a class="reference internal" href="Composition.html#psyneulink.core.compositions.composition.Composition.learn" title="psyneulink.core.compositions.composition.Composition.learn"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">learn</span></code></a> method; see <a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.synch_node_values_with_torch" title="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.synch_node_values_with_torch"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">synch_node_values_with_torch</span></code></a> for additional details.</p></li>
<li><p><strong>synch_results_with_torch</strong> (<code class="xref any docutils literal notranslate"><span class="pre">LearningScale</span></code> : default RUN) – specifies the default for the AutodiffComposition for when to copy the outputs of the Pytorch model
to the AutodiffComposition’s <a class="reference internal" href="Composition.html#psyneulink.core.compositions.composition.Composition.results" title="psyneulink.core.compositions.composition.Composition.results"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">results</span></code></a> attribute, which can be overridden by
specifying the <strong>synch_results_with_torch</strong> argument in the <a class="reference internal" href="Composition.html#psyneulink.core.compositions.composition.Composition.learn" title="psyneulink.core.compositions.composition.Composition.learn"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">learn</span></code></a> method.
Note that this differs from <strong>retain_torch_trained_outputs</strong>, which specifies the frequency at which
the outputs of the PyTorch model are tracked, all of which are stored in the AutodiffComposition’s
<a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.torch_trained_outputs" title="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.torch_trained_outputs"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">torch_trained_outputs</span></code></a> attribute at the end of the run;
see <a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.synch_results_with_torch" title="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.synch_results_with_torch"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">synch_results_with_torch</span></code></a> for
additional details.</p></li>
<li><p><strong>retain_torch_trained_outputs</strong> (<code class="xref any docutils literal notranslate"><span class="pre">LearningScale</span></code> : default MINIBATCH) – specifies the default for the AutodiffComposition for scale at which the outputs of the Pytorch
model are tracked, all of which are stored in the AutodiffComposition’s <a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.torch_trained_outputs" title="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.torch_trained_outputs"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">torch_trained_outputs</span></code></a> attribute at the end of the run; this can be overridden
by specifying the <strong>retain_torch_trained_outputs</strong> argument in the <a class="reference internal" href="Composition.html#psyneulink.core.compositions.composition.Composition.learn" title="psyneulink.core.compositions.composition.Composition.learn"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">learn</span></code></a> method.
Note that this differs from <strong>synch_results_with_torch</strong>, which specifies the frequency with
which values are called to the AutodiffComposition’s <a class="reference internal" href="Composition.html#psyneulink.core.compositions.composition.Composition.results" title="psyneulink.core.compositions.composition.Composition.results"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">results</span></code></a> attribute; see <a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.retain_torch_trained_outputs" title="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.retain_torch_trained_outputs"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">retain_torch_trained_outputs</span></code></a> for additional details.</p></li>
<li><p><strong>retain_torch_targets</strong> (<code class="xref any docutils literal notranslate"><span class="pre">LearningScale</span></code> : default MINIBATCH) – specifies the default for the AutodiffComposition for when to copy the targets used for training the
Pytorch model to the AutodiffComposition’s <code class="xref any docutils literal notranslate"><span class="pre">torch_targets</span></code> attribute, which can be
overridden by specifying the <strong>retain_torch_targets</strong> argument in the <a class="reference internal" href="Composition.html#psyneulink.core.compositions.composition.Composition.learn" title="psyneulink.core.compositions.composition.Composition.learn"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">learn</span></code></a> method;
see <a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.retain_torch_targets" title="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.retain_torch_targets"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">retain_torch_targets</span></code></a> for additional details.</p></li>
<li><p><strong>retain_torch_losses</strong> (<code class="xref any docutils literal notranslate"><span class="pre">LearningScale</span></code> : default MINIBATCH) – specifies the default for the AutodiffComposition for the scale at which the losses of the Pytorch model
are tracked, all of which are stored in the AutodiffComposition’s <code class="xref any docutils literal notranslate"><span class="pre">torch_losses</span></code>
attribute at the end of the run; see <a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.retain_torch_losses" title="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.retain_torch_losses"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">retain_torch_losses</span></code></a> for
additional details.</p></li>
<li><p><strong>device</strong> (<em>torch.device : default device-dependent</em>) – specifies the device on which the model is run. If None, the device is set to ‘cuda’ if available,
then ‘mps`, otherwise ‘cpu’.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.pytorch_representation">
<span class="sig-name descname"><span class="pre">pytorch_representation</span></span><a class="headerlink" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.pytorch_representation" title="Link to this definition">¶</a></dt>
<dd><p>represents the PyTorch model of the AutodiffComposition, which is created when the AutodiffComposition is
run in <a class="reference internal" href="#autodiffcomposition-pytorch"><span class="std std-ref">PyTorch mode</span></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>PytorchCompositionWrapper : default None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.optimizer">
<span class="sig-name descname"><span class="pre">optimizer</span></span><a class="headerlink" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.optimizer" title="Link to this definition">¶</a></dt>
<dd><p>the optimizer used for training. Depends on the <strong>optimizer_type</strong>, <strong>learning_rate</strong>, and <strong>weight_decay</strong>
arguments from initialization.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>PyTorch optimizer function</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.loss">
<span class="sig-name descname"><span class="pre">loss</span></span><a class="headerlink" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.loss" title="Link to this definition">¶</a></dt>
<dd><p>the loss function used for training. Depends on the <strong>loss_spec</strong> argument from initialization.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>PyTorch loss function</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.learning_rate">
<span class="sig-name descname"><span class="pre">learning_rate</span></span><a class="headerlink" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.learning_rate" title="Link to this definition">¶</a></dt>
<dd><p>determines the default learning_rate passed the optimizer, that is applied to all <a class="reference internal" href="Projection.html"><span class="doc">Projections</span></a>
in the AutodiffComposition that are <code class="xref any docutils literal notranslate"><span class="pre">learnable</span></code>, and for which individual rates
have not been specified (for how to do the latter, see <a class="reference internal" href="#autodiffcomposition-learning-rates"><span class="std std-ref">Learning Rates and Optimizer Params</span></a>).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>At present, an outermost Compositon’s learning rate is applied to any <a class="reference internal" href="#autodiffcomposition-nesting"><span class="std std-ref">nested Compositions</span></a>, whether this is specified in the call to its <a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.learn" title="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.learn"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">learn</span></code></a> method, its constructor, or its default value is being used.</p>
</div>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>To disable updating of a particular <a class="reference internal" href="MappingProjection.html"><span class="doc">MappingProjection</span></a> in an AutodiffComposition, specify either the
<strong>learnable</strong> parameter of its constructor or its learning_rate specification in the <strong>optimizer_params</strong>
argument of the AutodiffComposition’s constructor to False  (see <a class="reference internal" href="#autodiffcomposition-learning-rates"><span class="std std-ref">Learning Rates and Optimizer Params</span></a>);
this applies to MappingProjections at any level of <a class="reference internal" href="#autodiffcomposition-nesting"><span class="std std-ref">nesting</span></a></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float or bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.synch_projection_matrices_with_torch">
<span class="sig-name descname"><span class="pre">synch_projection_matrices_with_torch</span></span><a class="headerlink" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.synch_projection_matrices_with_torch" title="Link to this definition">¶</a></dt>
<dd><p>determines when to copy PyTorch parameters to PsyNeuLink <a class="reference internal" href="MappingProjection.html#psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection.matrix" title="psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection.matrix"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">Projection</span> <span class="pre">matrices</span></code></a>
(connection weights) if this is not specified in the call to <a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.learn" title="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.learn"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">learn</span></code></a>. Copying more
frequently keeps the PsyNeuLink representation more closely synchronized with parameter updates in Pytorch,
but slows performance (see <code class="xref any docutils literal notranslate"><span class="pre">AutodiffComposition_PyTorch_LearningScale</span></code> for information about settings).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>OPTIMIZATION_STEP, MINIBATCH, EPOCH or RUN</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.synch_node_variables_with_torch">
<span class="sig-name descname"><span class="pre">synch_node_variables_with_torch</span></span><a class="headerlink" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.synch_node_variables_with_torch" title="Link to this definition">¶</a></dt>
<dd><p>determines when to copy the current input to Pytorch functions to the PsyNeuLink <a class="reference internal" href="Mechanism.html#psyneulink.core.components.mechanisms.mechanism.Mechanism_Base.value" title="psyneulink.core.components.mechanisms.mechanism.Mechanism_Base.value"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">variable</span></code></a> attribute of the corresponding PsyNeuLink <code class="xref any docutils literal notranslate"><span class="pre">nodes</span></code>,
if this is not specified in the call to <a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.learn" title="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.learn"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">learn</span></code></a>.
Copying more frequently keeps the PsyNeuLink representation more closely copying more frequently
keeps them synchronized with parameter updates in Pytorch, but can slow performance (see
<code class="xref any docutils literal notranslate"><span class="pre">AutodiffComposition_PyTorch_LearningScale</span></code> for information about settings).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>OPTIMIZATION_STEP, TRIAL, MINIBATCH, EPOCH, RUN or None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.synch_node_values_with_torch">
<span class="sig-name descname"><span class="pre">synch_node_values_with_torch</span></span><a class="headerlink" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.synch_node_values_with_torch" title="Link to this definition">¶</a></dt>
<dd><p>determines when to copy the current output of Pytorch functions to the PsyNeuLink <a class="reference internal" href="Mechanism.html#psyneulink.core.components.mechanisms.mechanism.Mechanism_Base.value" title="psyneulink.core.components.mechanisms.mechanism.Mechanism_Base.value"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">value</span></code></a> attribute of the corresponding PsyNeuLink <code class="xref any docutils literal notranslate"><span class="pre">nodes</span></code>,
if this is not specified in the call to <a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.learn" title="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.learn"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">learn</span></code></a>. Copying more
frequently keeps the PsyNeuLink representation more closely synchronized with parameter
updates in Pytorch, but can also slow performance (see <code class="xref any docutils literal notranslate"><span class="pre">AutodiffComposition_PyTorch_LearningScale</span></code>
for information about settings).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>OPTIMIZATION_STEP, MINIBATCH, EPOCH or RUN</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.synch_results_with_torch">
<span class="sig-name descname"><span class="pre">synch_results_with_torch</span></span><a class="headerlink" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.synch_results_with_torch" title="Link to this definition">¶</a></dt>
<dd><p>determines when to copy the current outputs of Pytorch nodes to the PsyNeuLink <a class="reference internal" href="Composition.html#psyneulink.core.compositions.composition.Composition.results" title="psyneulink.core.compositions.composition.Composition.results"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">results</span></code></a> attribute of the AutodiffComposition if this is not specified in
the call to <a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.learn" title="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.learn"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">learn</span></code></a>. Copying more frequently keeps the PsyNeuLink
representation more closely synchronized with parameter updates in Pytorch, but slows performance
(see <code class="xref any docutils literal notranslate"><span class="pre">AutodiffComposition_PyTorch_LearningScale</span></code> for information about settings).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>OPTIMIZATION_STEP, TRIAL, MINIBATCH, EPOCH or RUN</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.retain_torch_trained_outputs">
<span class="sig-name descname"><span class="pre">retain_torch_trained_outputs</span></span><a class="headerlink" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.retain_torch_trained_outputs" title="Link to this definition">¶</a></dt>
<dd><p>determines the scale at which the outputs of the Pytorch model are tracked, all of which are stored in
the AutodiffComposition’s <a class="reference internal" href="Composition.html#psyneulink.core.compositions.composition.Composition.results" title="psyneulink.core.compositions.composition.Composition.results"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">results</span></code></a> attribute at the end of the run if this is not
specified in the call to <code class="xref any docutils literal notranslate"><span class="pre">learn</span> <span class="pre">&lt;AutodiffComposition.learn&gt;`(see</span> <span class="pre">`AutodiffComposition_PyTorch_LearningScale</span></code>
for information about settings)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>OPTIMIZATION_STEP, MINIBATCH, EPOCH, RUN or None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.retain_torch_targets">
<span class="sig-name descname"><span class="pre">retain_torch_targets</span></span><a class="headerlink" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.retain_torch_targets" title="Link to this definition">¶</a></dt>
<dd><p>determines the scale at which the targets used for training the Pytorch model are tracked, all of which
are stored in the AutodiffComposition’s <code class="xref any docutils literal notranslate"><span class="pre">targets</span></code> attribute at the end of the run
if this is not specified in the call to <a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.learn" title="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.learn"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">learn</span></code></a>
(see <code class="xref any docutils literal notranslate"><span class="pre">AutodiffComposition_PyTorch_LearningScale</span></code> for information about settings).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>OPTIMIZATION_STEP, TRIAL, MINIBATCH, EPOCH, RUN or None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.retain_torch_losses">
<span class="sig-name descname"><span class="pre">retain_torch_losses</span></span><a class="headerlink" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.retain_torch_losses" title="Link to this definition">¶</a></dt>
<dd><p>determines the scale at which the losses of the Pytorch model are tracked, all of which are stored in
the AutodiffComposition’s <code class="xref any docutils literal notranslate"><span class="pre">torch_losses</span></code> attribute at the end of the run
if this is nota specified in the call to <a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.learn" title="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.learn"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">learn</span></code></a>
(see <code class="xref any docutils literal notranslate"><span class="pre">AutodiffComposition_PyTorch_LearningScale</span></code> for information about settings).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>OPTIMIZATION_STEP, MINIBATCH, EPOCH, RUN or None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.torch_trained_outputs">
<span class="sig-name descname"><span class="pre">torch_trained_outputs</span></span><a class="headerlink" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.torch_trained_outputs" title="Link to this definition">¶</a></dt>
<dd><p>stores the outputs (converted to np arrays) of the Pytorch model trained during learning, at the frequency
specified by <a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.retain_torch_trained_outputs" title="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.retain_torch_trained_outputs"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">retain_torch_trained_outputs</span></code></a> if it is set
to <em>MINIBATCH</em>, <em>EPOCH</em>, or <em>RUN</em>; see <a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.retain_torch_trained_outputs" title="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.retain_torch_trained_outputs"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">retain_torch_trained_outputs</span></code></a> for additional details.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.torch_targets">
<span class="sig-name descname"><span class="pre">torch_targets</span></span><a class="headerlink" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.torch_targets" title="Link to this definition">¶</a></dt>
<dd><p>stores the targets used for training the Pytorch model during learning at the frequency specified by
<a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.retain_torch_targets" title="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.retain_torch_targets"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">retain_torch_targets</span></code></a> if it is set to <em>MINIBATCH</em>, <em>EPOCH</em>,
or <em>RUN</em>; see <a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.retain_torch_targets" title="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.retain_torch_targets"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">retain_torch_targets</span></code></a> for additional details.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.torch_losses">
<span class="sig-name descname"><span class="pre">torch_losses</span></span><a class="headerlink" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.torch_losses" title="Link to this definition">¶</a></dt>
<dd><p>stores the average loss after each weight update (i.e. each minibatch) during learning, at the frequency
specified by <a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.retain_torch_trained_outputs" title="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.retain_torch_trained_outputs"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">retain_torch_trained_outputs</span></code></a> if it is set to <em>MINIBATCH</em>,
<em>EPOCH</em>, or <em>RUN</em>; see <a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.retain_torch_losses" title="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.retain_torch_losses"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">retain_torch_losses</span></code></a> for additonal details.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of floats</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.last_saved_weights">
<span class="sig-name descname"><span class="pre">last_saved_weights</span></span><a class="headerlink" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.last_saved_weights" title="Link to this definition">¶</a></dt>
<dd><p>path for file to which weights were last saved.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>path</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.last_loaded_weights">
<span class="sig-name descname"><span class="pre">last_loaded_weights</span></span><a class="headerlink" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.last_loaded_weights" title="Link to this definition">¶</a></dt>
<dd><p>path for file from which weights were last loaded.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>path</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.device">
<span class="sig-name descname"><span class="pre">device</span></span><a class="headerlink" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.device" title="Link to this definition">¶</a></dt>
<dd><p>the device on which the model is run.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.device</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.PytorchMechanismWrapper">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">PytorchMechanismWrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mechanism</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">composition</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">component_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subclass_specifies_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.PytorchMechanismWrapper" title="Link to this definition">¶</a></dt>
<dd><p>Wrapper for a Mechanism in a PytorchCompositionWrapper
These comprise nodes of the PytorchCompositionWrapper, and generally correspond to functions in a Pytorch model.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.PytorchMechanismWrapper.mechanism">
<span class="sig-name descname"><span class="pre">mechanism</span></span><a class="headerlink" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.PytorchMechanismWrapper.mechanism" title="Link to this definition">¶</a></dt>
<dd><p>the PsyNeuLink <a class="reference internal" href="Mechanism.html"><span class="doc">Mechanism</span></a> being wrapped.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Mechanism</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.PytorchMechanismWrapper.composition">
<span class="sig-name descname"><span class="pre">composition</span></span><a class="headerlink" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.PytorchMechanismWrapper.composition" title="Link to this definition">¶</a></dt>
<dd><p>the <a class="reference internal" href="#"><span class="doc">AutodiffComposition</span></a> to which the <a class="reference internal" href="Mechanism.html"><span class="doc">Mechanism</span></a> being wrapped belongs
(and for which the PytorchCompositionWrapper – to which the PytorchMechanismWrapper
belongs – is the pytorch_representation).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition" title="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition">AutodiffComposition</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.PytorchMechanismWrapper.afferents">
<span class="sig-name descname"><span class="pre">afferents</span></span><a class="headerlink" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.PytorchMechanismWrapper.afferents" title="Link to this definition">¶</a></dt>
<dd><p>list of <code class="xref any docutils literal notranslate"><span class="pre">PytorchProjectionWrapper</span></code> objects that project to the PytorchMechanismWrapper.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[PytorchProjectionWrapper]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.PytorchMechanismWrapper.input">
<span class="sig-name descname"><span class="pre">input</span></span><a class="headerlink" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.PytorchMechanismWrapper.input" title="Link to this definition">¶</a></dt>
<dd><p>most recent input to the PytorchMechanismWrapper.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.PytorchMechanismWrapper.function">
<span class="sig-name descname"><span class="pre">function</span></span><a class="headerlink" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.PytorchMechanismWrapper.function" title="Link to this definition">¶</a></dt>
<dd><p>Pytorch version of the Mechanism’s function assigned in its __init__.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>_gen_pytorch_fct</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.PytorchMechanismWrapper.integrator_function">
<span class="sig-name descname"><span class="pre">integrator_function</span></span><a class="headerlink" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.PytorchMechanismWrapper.integrator_function" title="Link to this definition">¶</a></dt>
<dd><p>Pytorch version of the Mechanism’s integrator_function assigned in its __init__ if Mechanism
has an integrator_function;  this assumes the Mechanism also has an integrator_mode attribute
that is used to determine whether to execute the integrator_function first, and use its result
as the input to its function.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>_gen_pytorch_fct</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.PytorchMechanismWrapper.output">
<span class="sig-name descname"><span class="pre">output</span></span><a class="headerlink" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.PytorchMechanismWrapper.output" title="Link to this definition">¶</a></dt>
<dd><p>most recent output of the PytorchMechanismWrapper.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.PytorchMechanismWrapper.efferents">
<span class="sig-name descname"><span class="pre">efferents</span></span><a class="headerlink" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.PytorchMechanismWrapper.efferents" title="Link to this definition">¶</a></dt>
<dd><p>list of <code class="xref any docutils literal notranslate"><span class="pre">PytorchProjectionWrapper</span></code> objects that project from the PytorchMechanismWrapper.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[PytorchProjectionWrapper]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.PytorchMechanismWrapper.exclude_from_gradient_calc">
<span class="sig-name descname"><span class="pre">exclude_from_gradient_calc</span></span><a class="headerlink" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.PytorchMechanismWrapper.exclude_from_gradient_calc" title="Link to this definition">¶</a></dt>
<dd><p>used to prevent a node from being included in the Pytorch gradient calculation by excluding it in calls to
the forward() and backward().  If AFTER is specified, the node is executed after at the end of the
<code class="xref any docutils literal notranslate"><span class="pre">update_learning_parameters</span></code> method.  BEFORE is not currently supported</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool or str[BEFORE | AFTER]: False</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.PytorchMechanismWrapper._use">
<span class="sig-name descname"><span class="pre">_use</span></span><a class="headerlink" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.PytorchMechanismWrapper._use" title="Link to this definition">¶</a></dt>
<dd><p>designates the uses of the Mechanism, specified by the following keywords (see
PytorchCompositionWrapper <code class="xref any docutils literal notranslate"><span class="pre">docstring</span></code> for additional details):</p>
<ul class="simple">
<li><p><em>LEARNING</em>: inputs and <a class="reference internal" href="Mechanism.html#psyneulink.core.components.mechanisms.mechanism.Mechanism_Base.function" title="psyneulink.core.components.mechanisms.mechanism.Mechanism_Base.function"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">function</span></code></a> Parameters) are used
for actual execution of the corresponding Pytorch Module;</p></li>
<li><p><em>SYNCH</em>: used to store results of executing a Pytorch module that are then transferred to
the <a class="reference internal" href="Mechanism.html#psyneulink.core.components.mechanisms.mechanism.Mechanism_Base.value" title="psyneulink.core.components.mechanisms.mechanism.Mechanism_Base.value"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">value</span></code></a> Parameter of the PytorchMechanismWrappers <a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.PytorchMechanismWrapper.mechanism" title="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.PytorchMechanismWrapper.mechanism"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">mechanism</span></code></a>;</p></li>
<li><p><em>SHOW_PYTORCH</em>:  <code class="xref any docutils literal notranslate"><span class="pre">Mechanism</span></code> is included when the
<code class="xref any docutils literal notranslate"><span class="pre">AutoDiffComposition</span></code>s <code class="xref any docutils literal notranslate"><span class="pre">show_graph</span></code> method to used with the
<code class="docutils literal notranslate"><span class="pre">show_pytorch</span></code> option to display its <a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.pytorch_representation" title="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.pytorch_representation"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">pytorch_representation</span></code></a>;
if it is not specified, the <code class="xref any docutils literal notranslate"><span class="pre">Mechanism</span></code> is not displayed when the
<code class="xref any docutils literal notranslate"><span class="pre">AutoDiffComposition</span></code>s <code class="xref any docutils literal notranslate"><span class="pre">show_graph</span></code> method is called, even if the
<code class="docutils literal notranslate"><span class="pre">show_pytorch</span></code> option is specified.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[LEARNING, SYNCH]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.PytorchMechanismWrapper.add_afferent">
<span class="sig-name descname"><span class="pre">add_afferent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">afferent</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.PytorchMechanismWrapper.add_afferent" title="Link to this definition">¶</a></dt>
<dd><p>Add ProjectionWrapper for afferent to MechanismWrapper.
For use in call to collect_afferents</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.PytorchMechanismWrapper.add_efferent">
<span class="sig-name descname"><span class="pre">add_efferent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">efferent</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.PytorchMechanismWrapper.add_efferent" title="Link to this definition">¶</a></dt>
<dd><p>Add ProjectionWrapper for efferent from MechanismWrapper.
Implemented for completeness;  not currently used</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.PytorchMechanismWrapper.collect_afferents">
<span class="sig-name descname"><span class="pre">collect_afferents</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">port</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.PytorchMechanismWrapper.collect_afferents" title="Link to this definition">¶</a></dt>
<dd><p>Return afferent projections for input_port(s) of the Mechanism
If there is only one input_port, return the sum of its afferents (for those in Composition)
If there are multiple input_ports, return a tensor (or list of tensors if input ports are ragged) of shape:</p>
<p>(batch, input_port, projection, …)</p>
<p>Where the ellipsis represent 1 or more dimensions for the values of the projected afferent.</p>
<p>FIX: AUGMENT THIS TO SUPPORT InputPort’s function</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.PytorchMechanismWrapper.execute">
<span class="sig-name descname"><span class="pre">execute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimization_num</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">synch_with_pnl_options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.PytorchMechanismWrapper.execute" title="Link to this definition">¶</a></dt>
<dd><p>Execute Mechanism’s _gen_pytorch version of function on variable.
Enforce result to be 2d, and assign to self.output</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.PytorchMechanismWrapper.set_pnl_variable_and_values">
<span class="sig-name descname"><span class="pre">set_pnl_variable_and_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">set_variable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.PytorchMechanismWrapper.set_pnl_variable_and_values" title="Link to this definition">¶</a></dt>
<dd><p>Set the state of the PytorchMechanismWrapper’s Mechanism
Note: if execute_mech=True requires that variable=True</p>
</dd></dl>

</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.pytorch_composition_wrapper_type">
<span class="sig-name descname"><span class="pre">pytorch_composition_wrapper_type</span></span><a class="headerlink" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.pytorch_composition_wrapper_type" title="Link to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">PytorchCompositionWrapper</span></code></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.pytorch_mechanism_wrapper_type">
<span class="sig-name descname"><span class="pre">pytorch_mechanism_wrapper_type</span></span><a class="headerlink" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.pytorch_mechanism_wrapper_type" title="Link to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.PytorchMechanismWrapper" title="psyneulink.library.compositions.pytorchwrappers.PytorchMechanismWrapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">PytorchMechanismWrapper</span></code></a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.infer_backpropagation_learning_pathways">
<span class="sig-name descname"><span class="pre">infer_backpropagation_learning_pathways</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">execution_mode</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.infer_backpropagation_learning_pathways" title="Link to this definition">¶</a></dt>
<dd><p>Create backpropagation learning pathways for every Input Node –&gt; Output Node pathway
Flattens nested compositions:</p>
<blockquote>
<div><ul class="simple">
<li><p>only includes the Projections in outer Composition to/from the CIMs of the nested Composition
(i.e., to input_CIMs and from output_CIMs) – the ones that should be learned;</p></li>
<li><p>excludes Projections from/to CIMs in the nested Composition
(from input_CIMs and to output_CIMs), as those should remain identity Projections;</p></li>
</ul>
<p>see <code class="xref any docutils literal notranslate"><span class="pre">PytorchCompositionWrapper</span></code> for table of how Projections are handled and further details.</p>
</div></blockquote>
<p>Returns list of target nodes for each pathway</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.get_target_nodes">
<span class="sig-name descname"><span class="pre">get_target_nodes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">execution_mode=&lt;ExecutionMode.PyTorch:</span> <span class="pre">1&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.get_target_nodes" title="Link to this definition">¶</a></dt>
<dd><p>Return <a class="reference internal" href="Composition.html#psyneulink.core.compositions.composition.NodeRole.TARGET" title="psyneulink.core.compositions.composition.NodeRole.TARGET"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">TARGET</span></code></a> <a class="reference internal" href="Composition.html#composition-nodes"><span class="std std-ref">Nodes</span></a> of the AutodiffComposition.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.set_weights">
<span class="sig-name descname"><span class="pre">set_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pnl_proj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.set_weights" title="Link to this definition">¶</a></dt>
<dd><p>Set weights for specified Projection.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.learn">
<span class="sig-name descname"><span class="pre">learn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">*args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">synch_projection_matrices_with_torch=NotImplemented</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">synch_node_variables_with_torch=NotImplemented</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">synch_node_values_with_torch=NotImplemented</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">synch_results_with_torch=NotImplemented</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">retain_torch_trained_outputs=NotImplemented</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">retain_torch_targets=NotImplemented</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">retain_torch_losses=NotImplemented</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_context=&lt;psyneulink.core.globals.context.Context</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_initialization=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.learn" title="Link to this definition">¶</a></dt>
<dd><p>Override to handle synch and retain args
Note: defaults for synch and retain args are set to NotImplemented, so that the user can specify None if</p>
<blockquote>
<div><p>they want to locally override the default values for the AutodiffComposition (see docstrings for run()
and _parse_synch_and_retain_args() for additonal details).</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.execute">
<span class="sig-name descname"><span class="pre">execute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_trials=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minibatch_size=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizations_per_minibatch=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_logging=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scheduler=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">termination_processing=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">call_before_minibatch=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">call_after_minibatch=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">call_before_time_step=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">call_before_pass=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">call_after_time_step=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">call_after_pass=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset_stateful_functions_to=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_context=&lt;psyneulink.core.globals.context.Context</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clamp_input='soft_clamp'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">runtime_params=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">execution_mode=&lt;ExecutionMode.PyTorch:</span> <span class="pre">1&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_initialization=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">synch_with_pnl_options=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">retain_in_pnl_options=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">report_output=ReportOutput.OFF</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">report_params=ReportParams.OFF</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">report_progress=ReportProgress.OFF</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">report_simulations=ReportSimulations.OFF</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">report_to_devices=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">report=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">report_num=None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.execute" title="Link to this definition">¶</a></dt>
<dd><p>Override to execute autodiff_forward() in learning mode if execute_mode is not Python</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">synch_projection_matrices_with_torch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">NotImplemented</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">synch_node_variables_with_torch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">NotImplemented</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">synch_node_values_with_torch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">NotImplemented</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">synch_results_with_torch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">NotImplemented</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">retain_torch_trained_outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">NotImplemented</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">retain_torch_targets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">NotImplemented</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">retain_torch_losses</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">NotImplemented</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batched_results</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.run" title="Link to this definition">¶</a></dt>
<dd><p>Override to handle synch and retain args if run called directly from run() rather than learn()
Note: defaults for synch and retain args are NotImplemented, so that the user can specify None if they want</p>
<blockquote>
<div><p>to locally override the default values for the AutodiffComposition (see _parse_synch_and_retain_args()
for details). This is distinct from the user assigning the Parameter default_values(s), which is done
in the AutodiffComposition constructor and handled by the Parameter._specify_none attribute.</p>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.save" title="Link to this definition">¶</a></dt>
<dd><p>Saves all weight matrices for all MappingProjections in the AutodiffComposition</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<em>Path</em><em>, </em><em>PosixPath</em><em> or </em><em>str : default None</em>) – path specification; must be a legal path specification in the filesystem.</p></li>
<li><p><strong>directory</strong> (str : default <code class="docutils literal notranslate"><span class="pre">current</span> <span class="pre">working</span> <span class="pre">directory</span></code>) – directory where <a class="reference internal" href="MappingProjection.html#psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection.matrix" title="psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection.matrix"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">matrices</span></code></a> for all MappingProjections
in the AutodiffComposition are saved.</p></li>
<li><p><strong>filename</strong> (str : default <code class="docutils literal notranslate"><span class="pre">&lt;name</span> <span class="pre">of</span> <span class="pre">AutodiffComposition&gt;_matrix_wts.pnl</span></code>) – filename in which <a class="reference internal" href="MappingProjection.html#psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection.matrix" title="psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection.matrix"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">matrices</span></code></a> for all MappingProjections
in the AutodiffComposition are saved.</p></li>
<li><p><strong>note::</strong> (<em>..</em>) – Matrices are saved in
<a class="reference external" href="https://pytorch.org/tutorials/beginner/saving_loading_models.html">PyTorch state_dict</a> format.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Path</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.load" title="Link to this definition">¶</a></dt>
<dd><p>Loads all weight matrices for all MappingProjections in the AutodiffComposition from file
:type path: <code class="xref py py-class docutils literal notranslate"><span class="pre">PosixPath</span></code>
:param path: Path for file in which <a class="reference internal" href="MappingProjection.html"><span class="doc">MappingProjection</span></a> <a class="reference internal" href="MappingProjection.html#psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection.matrix" title="psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection.matrix"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">matrices</span></code></a> are stored.</p>
<blockquote>
<div><p>This must be a legal PosixPath object; if it is specified <strong>directory</strong> and <strong>filename</strong> are ignored.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>directory</strong> (str : default <code class="docutils literal notranslate"><span class="pre">current</span> <span class="pre">working</span> <span class="pre">directory</span></code>) – directory where <a class="reference internal" href="MappingProjection.html"><span class="doc">MappingProjection</span></a> <a class="reference internal" href="MappingProjection.html#psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection.matrix" title="psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection.matrix"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">matrices</span></code></a> are stored.</p></li>
<li><p><strong>filename</strong> (str : default <code class="docutils literal notranslate"><span class="pre">&lt;name</span> <span class="pre">of</span> <span class="pre">AutodiffComposition&gt;_matrix_wts.pnl</span></code>) – name of file in which <a class="reference internal" href="MappingProjection.html"><span class="doc">MappingProjection</span></a> <a class="reference internal" href="MappingProjection.html#psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection.matrix" title="psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection.matrix"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">matrices</span></code></a> are stored.</p></li>
<li><p><strong>note::</strong> (<em>..</em>) – <p>Matrices must be stored in
<a class="reference external" href="https://pytorch.org/tutorials/beginner/saving_loading_models.html">PyTorch state_dict</a> format.</p>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.copy_torch_param_to_projection_matrix">
<span class="sig-name descname"><span class="pre">copy_torch_param_to_projection_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">projection</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">torch_param</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">torch_module</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">torch_slice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.copy_torch_param_to_projection_matrix" title="Link to this definition">¶</a></dt>
<dd><p>Assign torch Parameter to <a class="reference internal" href="MappingProjection.html#psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection.matrix" title="psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection.matrix"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">matrix</span></code></a> Parameter of specified <a class="reference internal" href="MappingProjection.html"><span class="doc">MappingProjection</span></a>.
Return torch_param as the np.ndarray assigned to <a class="reference internal" href="MappingProjection.html#psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection.matrix" title="psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection.matrix"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">matrix</span></code></a> Parameter of
<strong>projection</strong>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>projection</strong> (<em>str</em><em> or </em><a class="reference internal" href="MappingProjection.html#psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection" title="psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection"><em>MappingProjection</em></a>) – specifies <a class="reference internal" href="MappingProjection.html"><span class="doc">MappingProjection</span></a> to which the torch_param is assigned as its <a class="reference internal" href="MappingProjection.html#psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection.matrix" title="psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection.matrix"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">matrix</span></code></a> Parameter;  if specified as a str, it must be the name of a
MappingProjection in the AutodiffComposition.</p></li>
<li><p><strong>torch_param</strong> (<em>torch.nn.Parameter</em><em>, </em><em>str</em><em> or </em><em>int</em>) – specifies torch_param to assign to the <a class="reference internal" href="MappingProjection.html#psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection.matrix" title="psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection.matrix"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">matrix</span></code></a> Parameter of <strong>projection</strong>;
if it is a torch.nn.Parameter or torch.Tensor, then the <strong>torch_module</strong> argument does not need to be
specified; if specified as a str or int, it must be the name of a torch Parameter (used to access it in
the state_dict) or its index (used to access it in the parameterlist) of the <strong>torch_module</strong> argument,
which must be also specified.</p></li>
<li><p><strong>torch_module</strong> (<em>torch.nn.Module : default None</em>) – specifies a torch.nn.Module containing <strong>torch_param</strong> assigned to the`matrix&lt;MappingProjection.matrix&gt;`
Parameter of <strong>projection</strong>; this does not need to be specified if <strong>torch_param</strong> is a
torch.nn.Parameter or torch.Tensor, but must be specified if <strong>torch_param</strong> is a str or int.</p></li>
<li><p><strong>torch_slice</strong> (<em>slice : default None</em>) – <dl class="simple">
<dt>specifies a slice of <strong>torch_param</strong> to assign to the <a class="reference internal" href="MappingProjection.html#psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection.matrix" title="psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection.matrix"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">matrix</span></code></a> Parameter</dt><dd><p>of <strong>projection</strong>; if it is not specified, the entire tensor of <strong>torch_param</strong> is used.</p>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><strong>torch_slice</strong> should not be specified if the specification of <strong>torch_param</strong> already takes this
into account.</p>
</div>
</p></li>
<li><p><strong>validate</strong> (<em>bool : default True</em>) – <p>specifies whether to validate the <strong>projection</strong> and <strong>torch_param</strong> arguments; setting it to False
results in more efficient processing if this method is called frequently; however, invalid arguments will
raise standard Python exceptions rather than more informative AutodiffComposition errors, and unexpected
results may go unnoticed.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>if validate is False, for efficiency: <strong>projection</strong> <em>must</em> be a <a class="reference internal" href="MappingProjection.html"><span class="doc">MappingProjection</span></a>, <strong>torch_param</strong>
<em>must</em> be a torch.Tensor, and both <strong>torch_module</strong> and <strong>torch_slice</strong> are ignored.</p>
</div>
</p></li>
<li><p><strong>context</strong> (<a class="reference internal" href="Context.html#psyneulink.core.globals.context.Context" title="psyneulink.core.globals.context.Context"><em>Context</em></a><em> or </em><em>None : default most recent Context</em>) – specifies context to use for the value of Projection.matrix;  if it is not provided, then a default
<a class="reference internal" href="Context.html"><span class="doc">Context</span></a> is constructed using the <a class="reference internal" href="Composition.html#psyneulink.core.compositions.composition.Composition.name" title="psyneulink.core.compositions.composition.Composition.name"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">name</span></code></a> of the AutodiffComposition as the
<a class="reference internal" href="Context.html#psyneulink.core.globals.context.Context.execution_id" title="psyneulink.core.globals.context.Context.execution_id"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">execution_id</span></code></a>, commensurate with the one used bydefault for its <a class="reference internal" href="#autodiffcomposition-execution"><span class="std std-ref">execution</span></a>.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.copy_projection_matrix_to_torch_param">
<span class="sig-name descname"><span class="pre">copy_projection_matrix_to_torch_param</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">projection</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">torch_param</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">torch_module</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">torch_slice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.copy_projection_matrix_to_torch_param" title="Link to this definition">¶</a></dt>
<dd><p>Assign the <a class="reference internal" href="MappingProjection.html#psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection.matrix" title="psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection.matrix"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">matrix</span></code></a> Parameter of a <a class="reference internal" href="MappingProjection.html"><span class="doc">MappingProjection</span></a> to a Pytorch Parameter.</p>
<p>Return torch.Tensor assigned to <strong>torch_param</strong></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>projection</strong> (<em>str</em><em> or </em><a class="reference internal" href="MappingProjection.html#psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection" title="psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection"><em>MappingProjection</em></a>) – specifies <a class="reference internal" href="MappingProjection.html"><span class="doc">MappingProjection</span></a>, the <a class="reference internal" href="MappingProjection.html#psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection.matrix" title="psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection.matrix"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">matrix</span></code></a> of which is assigned torch_param;
if specified as a str, it must be the name of a MappingProjection in the AutodiffComposition.</p></li>
<li><p><strong>torch_param</strong> (<em>torch.nn.Parameter</em><em>, </em><em>str</em><em> or </em><em>int</em>) – specifies torch Parameter to which the <a class="reference internal" href="MappingProjection.html#psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection.matrix" title="psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection.matrix"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">matrix</span></code></a> of the Projection is assigned;
if it is a torch.nn.Parameter or torch.Tensor, then the <strong>torch_module</strong> argument does not need to be
specified; if specified as a str or int, it must be the name of a torch Parameter (used to access it in
the state_dict) or its index (used to access it in the parameterlist) of the <strong>torch_module</strong> argument,
which must be also specified.</p></li>
<li><p><strong>torch_module</strong> (<em>torch.nn.Module : default None</em>) – specifies a torch.nn.Module containing <strong>torch_param</strong> to which the <strong>projection</strong>’s <a class="reference internal" href="MappingProjection.html#psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection.matrix" title="psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection.matrix"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">matrix</span></code></a> Parameter is assigned; this does not need to be specified if <strong>torch_param</strong>
is a torch.nn.Parameter or torch.Tensor, but must be specified if <strong>torch_param</strong> is a str or int.</p></li>
<li><p><strong>torch_slice</strong> (<em>slice : default None</em>) – <dl class="simple">
<dt>specifies a slice of <strong>torch_param</strong> to assign to the <a class="reference internal" href="MappingProjection.html#psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection.matrix" title="psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection.matrix"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">matrix</span></code></a> Parameter</dt><dd><p>of <strong>projection</strong>; if it is not specified, the entire tensor of <strong>torch_param</strong> is used.</p>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><strong>torch_slice</strong> should not be specified if the specification of <strong>torch_param</strong> already takes this
into account.</p>
</div>
</p></li>
<li><p><strong>validate</strong> (<em>bool : default True</em>) – <p>specifies whether to validate the <strong>projection</strong> and <strong>torch_param</strong> arguments; setting it to False
results in more efficient processing if this method is called frequently; however, invalid arguments
then raise standard Python exceptions rather than more informative AutodiffComposition errors,
and unexpected results may go unnoticed.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>if validate is False, for efficiency: <strong>projection</strong> <em>must</em> be a <a class="reference internal" href="MappingProjection.html"><span class="doc">MappingProjection</span></a>, <strong>torch_param</strong>
<em>must</em> be a torch.Tensor, and both <strong>torch_module</strong> and <strong>torch_slice</strong> are ignored.</p>
</div>
</p></li>
<li><p><strong>context</strong> (<a class="reference internal" href="Context.html#psyneulink.core.globals.context.Context" title="psyneulink.core.globals.context.Context"><em>Context</em></a><em> or </em><em>None : default most recent Context</em>) – specifies context to use for the value of Projection.matrix;  if it is not provided, then a default
<a class="reference internal" href="Context.html"><span class="doc">Context</span></a> is constructed using the <a class="reference internal" href="Composition.html#psyneulink.core.compositions.composition.Composition.name" title="psyneulink.core.compositions.composition.Composition.name"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">name</span></code></a> of the AutodiffComposition as the
<a class="reference internal" href="Context.html#psyneulink.core.globals.context.Context.execution_id" title="psyneulink.core.globals.context.Context.execution_id"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">execution_id</span></code></a>, commensurate with the one used bydefault for its <a class="reference internal" href="#autodiffcomposition-execution"><span class="std std-ref">execution</span></a>.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition._validate_torch_param_and_projection">
<span class="sig-name descname"><span class="pre">_validate_torch_param_and_projection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">torch_param</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">torch_module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">torch_slice</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">projection_spec</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition._validate_torch_param_and_projection" title="Link to this definition">¶</a></dt>
<dd><p>Validate torch and projection arguments for copying between PyTorch and AutodiffComposition.
Return tuple of torch.Tensor and MappingProjection.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.show_graph">
<span class="sig-name descname"><span class="pre">show_graph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.show_graph" title="Link to this definition">¶</a></dt>
<dd><p>Override to use PytorchShowGraph if show_pytorch is True</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition._dependent_components">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_dependent_components</span></span><a class="headerlink" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition._dependent_components" title="Link to this definition">¶</a></dt>
<dd><p>Returns:
Components that must have values in a given Context for
this Component to execute in that Context</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Iterable</span></code>[<a class="reference internal" href="Component.html#psyneulink.core.components.component.Component" title="psyneulink.core.components.component.Component"><code class="xref py py-class docutils literal notranslate"><span class="pre">Component</span></code></a>]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


             </article>
             
            </div>
            <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="CompositionFunctionApproximator.html" class="btn btn-neutral float-right" title="CompositionFunctionApproximator" accesskey="n" rel="next">Next <img src="_static/images/chevron-right-orange.svg" class="next-page"></a>
      
      
        <a href="Compositions.html" class="btn btn-neutral" title="Compositions" accesskey="p" rel="prev"><img src="_static/images/chevron-right-orange.svg" class="previous-page"> Previous</a>
      
    </div>
  

  

    <hr>

  

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Jonathan D. Cohen.

    </p>
  </div>
    
      <div>
        Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
      </div>
     

</footer>

          </div>
        </div>

        <div class="psyneulink-content-right" id="psyneulink-content-right">
          <div class="psyneulink-right-menu" id="psyneulink-right-menu">
            <div class="psyneulink-side-scroll" id="psyneulink-side-scroll-right">
              <ul>
<li><a class="reference internal" href="#">AutodiffComposition</a><ul>
<li><a class="reference internal" href="#contents">Contents</a></li>
<li><a class="reference internal" href="#overview">Overview</a></li>
<li><a class="reference internal" href="#creating-an-autodiffcomposition">Creating an AutodiffComposition</a><ul>
<li><a class="reference internal" href="#only-one-outputport-per-node"><em>Only one OutputPort per Node</em></a></li>
<li><a class="reference internal" href="#no-modulatory-components"><em>No Modulatory Components</em></a></li>
<li><a class="reference internal" href="#no-bias-parameters"><em>No Bias Parameters</em></a></li>
<li><a class="reference internal" href="#nesting"><em>Nesting</em></a></li>
<li><a class="reference internal" href="#learning-rates-and-optimizer-params"><em>Learning Rates and Optimizer Params</em></a></li>
<li><a class="reference internal" href="#exchanging-parameters-with-pytorch-modules"><em>Exchanging Parameters with Pytorch Modules</em></a></li>
<li><a class="reference internal" href="#no-post-construction-modification"><em>No Post-construction Modification</em></a></li>
</ul>
</li>
<li><a class="reference internal" href="#execution">Execution</a><ul>
<li><a class="reference internal" href="#pytorch-mode"><em>PyTorch mode</em></a></li>
<li><a class="reference internal" href="#llvm-mode"><em>LLVM mode</em></a></li>
<li><a class="reference internal" href="#python-mode"><em>Python mode</em></a></li>
<li><a class="reference internal" href="#nested-execution-and-modulation"><em>Nested Execution and Modulation</em></a></li>
<li><a class="reference internal" href="#logging"><em>Logging</em></a></li>
</ul>
</li>
<li><a class="reference internal" href="#class-reference">Class Reference</a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition"><code class="docutils literal notranslate"><span class="pre">AutodiffComposition</span></code></a><ul>
<li><a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.pytorch_representation"><code class="docutils literal notranslate"><span class="pre">AutodiffComposition.pytorch_representation</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.optimizer"><code class="docutils literal notranslate"><span class="pre">AutodiffComposition.optimizer</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.loss"><code class="docutils literal notranslate"><span class="pre">AutodiffComposition.loss</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.learning_rate"><code class="docutils literal notranslate"><span class="pre">AutodiffComposition.learning_rate</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.synch_projection_matrices_with_torch"><code class="docutils literal notranslate"><span class="pre">AutodiffComposition.synch_projection_matrices_with_torch</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.synch_node_variables_with_torch"><code class="docutils literal notranslate"><span class="pre">AutodiffComposition.synch_node_variables_with_torch</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.synch_node_values_with_torch"><code class="docutils literal notranslate"><span class="pre">AutodiffComposition.synch_node_values_with_torch</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.synch_results_with_torch"><code class="docutils literal notranslate"><span class="pre">AutodiffComposition.synch_results_with_torch</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.retain_torch_trained_outputs"><code class="docutils literal notranslate"><span class="pre">AutodiffComposition.retain_torch_trained_outputs</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.retain_torch_targets"><code class="docutils literal notranslate"><span class="pre">AutodiffComposition.retain_torch_targets</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.retain_torch_losses"><code class="docutils literal notranslate"><span class="pre">AutodiffComposition.retain_torch_losses</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.torch_trained_outputs"><code class="docutils literal notranslate"><span class="pre">AutodiffComposition.torch_trained_outputs</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.torch_targets"><code class="docutils literal notranslate"><span class="pre">AutodiffComposition.torch_targets</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.torch_losses"><code class="docutils literal notranslate"><span class="pre">AutodiffComposition.torch_losses</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.last_saved_weights"><code class="docutils literal notranslate"><span class="pre">AutodiffComposition.last_saved_weights</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.last_loaded_weights"><code class="docutils literal notranslate"><span class="pre">AutodiffComposition.last_loaded_weights</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.device"><code class="docutils literal notranslate"><span class="pre">AutodiffComposition.device</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.PytorchMechanismWrapper"><code class="docutils literal notranslate"><span class="pre">AutodiffComposition.PytorchMechanismWrapper</span></code></a><ul>
<li><a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.PytorchMechanismWrapper.mechanism"><code class="docutils literal notranslate"><span class="pre">AutodiffComposition.PytorchMechanismWrapper.mechanism</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.PytorchMechanismWrapper.composition"><code class="docutils literal notranslate"><span class="pre">AutodiffComposition.PytorchMechanismWrapper.composition</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.PytorchMechanismWrapper.afferents"><code class="docutils literal notranslate"><span class="pre">AutodiffComposition.PytorchMechanismWrapper.afferents</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.PytorchMechanismWrapper.input"><code class="docutils literal notranslate"><span class="pre">AutodiffComposition.PytorchMechanismWrapper.input</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.PytorchMechanismWrapper.function"><code class="docutils literal notranslate"><span class="pre">AutodiffComposition.PytorchMechanismWrapper.function</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.PytorchMechanismWrapper.integrator_function"><code class="docutils literal notranslate"><span class="pre">AutodiffComposition.PytorchMechanismWrapper.integrator_function</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.PytorchMechanismWrapper.output"><code class="docutils literal notranslate"><span class="pre">AutodiffComposition.PytorchMechanismWrapper.output</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.PytorchMechanismWrapper.efferents"><code class="docutils literal notranslate"><span class="pre">AutodiffComposition.PytorchMechanismWrapper.efferents</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.PytorchMechanismWrapper.exclude_from_gradient_calc"><code class="docutils literal notranslate"><span class="pre">AutodiffComposition.PytorchMechanismWrapper.exclude_from_gradient_calc</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.PytorchMechanismWrapper._use"><code class="docutils literal notranslate"><span class="pre">AutodiffComposition.PytorchMechanismWrapper._use</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.PytorchMechanismWrapper.add_afferent"><code class="docutils literal notranslate"><span class="pre">AutodiffComposition.PytorchMechanismWrapper.add_afferent()</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.PytorchMechanismWrapper.add_efferent"><code class="docutils literal notranslate"><span class="pre">AutodiffComposition.PytorchMechanismWrapper.add_efferent()</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.PytorchMechanismWrapper.collect_afferents"><code class="docutils literal notranslate"><span class="pre">AutodiffComposition.PytorchMechanismWrapper.collect_afferents()</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.PytorchMechanismWrapper.execute"><code class="docutils literal notranslate"><span class="pre">AutodiffComposition.PytorchMechanismWrapper.execute()</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.PytorchMechanismWrapper.set_pnl_variable_and_values"><code class="docutils literal notranslate"><span class="pre">AutodiffComposition.PytorchMechanismWrapper.set_pnl_variable_and_values()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.pytorch_composition_wrapper_type"><code class="docutils literal notranslate"><span class="pre">AutodiffComposition.pytorch_composition_wrapper_type</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.pytorch_mechanism_wrapper_type"><code class="docutils literal notranslate"><span class="pre">AutodiffComposition.pytorch_mechanism_wrapper_type</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.infer_backpropagation_learning_pathways"><code class="docutils literal notranslate"><span class="pre">AutodiffComposition.infer_backpropagation_learning_pathways()</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.get_target_nodes"><code class="docutils literal notranslate"><span class="pre">AutodiffComposition.get_target_nodes()</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.set_weights"><code class="docutils literal notranslate"><span class="pre">AutodiffComposition.set_weights()</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.learn"><code class="docutils literal notranslate"><span class="pre">AutodiffComposition.learn()</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.execute"><code class="docutils literal notranslate"><span class="pre">AutodiffComposition.execute()</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.run"><code class="docutils literal notranslate"><span class="pre">AutodiffComposition.run()</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.save"><code class="docutils literal notranslate"><span class="pre">AutodiffComposition.save()</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.load"><code class="docutils literal notranslate"><span class="pre">AutodiffComposition.load()</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.copy_torch_param_to_projection_matrix"><code class="docutils literal notranslate"><span class="pre">AutodiffComposition.copy_torch_param_to_projection_matrix()</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.copy_projection_matrix_to_torch_param"><code class="docutils literal notranslate"><span class="pre">AutodiffComposition.copy_projection_matrix_to_torch_param()</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition._validate_torch_param_and_projection"><code class="docutils literal notranslate"><span class="pre">AutodiffComposition._validate_torch_param_and_projection()</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.show_graph"><code class="docutils literal notranslate"><span class="pre">AutodiffComposition.show_graph()</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition._dependent_components"><code class="docutils literal notranslate"><span class="pre">AutodiffComposition._dependent_components</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

            </div>
          </div>
        </div>
      </section>
    </div>

  


  

     
       <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
         <script src="_static/jquery.js?v=5d32c60e"></script>
         <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
         <script src="_static/documentation_options.js?v=5fcf4438"></script>
         <script src="_static/doctools.js?v=9bcbadda"></script>
         <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
     

  

  <script type="text/javascript" src="_static/js/vendor/popper.min.js"></script>
  <script type="text/javascript" src="_static/js/vendor/bootstrap.min.js"></script>
  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

  <!-- Begin Footer -->

  <footer class="site-footer" id="docs-tutorials-resources">
    <div class="container footer-container">
      <div class="footer-logo-wrapper">
        <a href="https://princetonuniversity.github.io/PsyNeuLink/" class="footer-logo"></a>
      </div>

  </footer>

  

  <!-- End Footer -->

  <!-- Begin Mobile Menu -->

  <div class="mobile-main-menu">
    <div class="container-fluid">
      <div class="container mobile-logo-container">
        <div class="mobile-main-menu-header-container">
          <a class="header-logo" href="https://princetonuniversity.github.io/PsyNeuLink/" aria-label="PsyNeuLink"></a>
          <a class="main-menu-close-button" href="#" data-behavior="close-mobile-menu"></a>
        </div>
      </div>
    </div>

    <div class="mobile-main-menu-links-container">
      <div class="main-menu">
        <ul>
          <li>
            <a href="https://github.com/PrincetonUniversity/PsyNeuLink">Github</a>
          </li>
        </ul>
      </div>
    </div>
  </div>

  <!-- End Mobile Menu -->

  <script type="text/javascript" src="_static/js/vendor/anchor.min.js"></script>

  <script type="text/javascript">
    $(document).ready(function() {
      mobileMenu.bind();
      mobileTOC.bind();
      psyneulinkAnchors.bind();
      sideMenus.bind();
      scrollToAnchor.bind();
      highlightNavigation.bind();
      mainMenuDropdown.bind();

      // Add class to links that have code blocks, since we cannot create links in code blocks
      $("article.psyneulink-article a span.pre").each(function(e) {
        $(this).closest("a").addClass("has-code");
      });
    })
  </script>
</body>
</html>