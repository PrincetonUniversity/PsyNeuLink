


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>GRUComposition &mdash; PsyNeuLink 0.17.0.0+6.g06099ba7e documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!-- <link rel="stylesheet" href="_static/pygments.css" type="text/css" /> -->
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/custom.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Subsystems" href="Subystems.html" />
    <link rel="prev" title="EMComposition" href="EMComposition.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

  <!-- Preload the theme fonts -->

<link rel="preload" href="_static/fonts/FreightSans/freight-sans-book.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/FreightSans/freight-sans-medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/IBMPlexMono/IBMPlexMono-Medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/FreightSans/freight-sans-bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/FreightSans/freight-sans-medium-italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/IBMPlexMono/IBMPlexMono-SemiBold.woff2" as="font" type="font/woff2" crossorigin="anonymous">

<!-- Preload the katex fonts -->

<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Math-Italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size1-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size4-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size2-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size3-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Caligraphic-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
</head>

<div class="container-fluid header-holder tutorials-header" id="header-holder">
  <div class="container">
    <div class="header-container">
      <a class="header-logo" href="https://princetonuniversity.github.io/PsyNeuLink/"></a>
<!--      <a class="header-logo"></a>-->
      <div class="main-menu">
        <ul>
          <li>
            <a href="https://github.com/PrincetonUniversity/PsyNeuLink">Github</a>
          </li>
        </ul>
      </div>

      <a class="main-menu-open-button" href="#" data-behavior="open-mobile-menu"></a>
    </div>

  </div>
</div>


<body class="psyneulink-body">

   

    

    <div class="table-of-contents-link-wrapper">
      <span>Table of Contents</span>
      <a href="#" class="toggle-table-of-contents" data-behavior="toggle-table-of-contents"></a>
    </div>

    <nav data-toggle="wy-nav-shift" class="psyneulink-left-menu" id="psyneulink-left-menu">
      <div class="psyneulink-side-scroll">
        <div class="psyneulink-menu psyneulink-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          <div class="psyneulink-left-menu-search">
            

            
              
              
                <div class="version">
                  0.17.0.0+6
                </div>
              
            

            


  


<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search Docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

            
          </div>
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">Welcome to PsyNeuLink </a></li>
<li class="toctree-l1"><a class="reference internal" href="BasicsAndPrimer.html">Basics and Primer</a></li>
<li class="toctree-l1"><a class="reference internal" href="QuickReference.html">Quick Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="Core.html">Core</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="Library.html">Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="ContributorsGuide.html">Contributors Guide</a></li>
</ul>

            
          
          <div class="psyneulink-dev-mode-toggle">
          </div>
        </div>
      </div>
    </nav>
    <div class="psyneulink-container">
      <div class="psyneulink-page-level-bar" id="psyneulink-page-level-bar">
        <div class="psyneulink-breadcrumbs-wrapper">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="psyneulink-breadcrumbs">
    
      <li>
        <a href="index.html">
          
            Docs
          
        </a> &gt;
      </li>

        
          <li><a href="Library.html">Library</a> &gt;</li>
        
          <li><a href="Compositions.html">Compositions</a> &gt;</li>
        
      <li>GRUComposition</li>
    
  </ul>

  
</div>
        </div>

        <div class="psyneulink-shortcuts-wrapper" id="psyneulink-shortcuts-wrapper">
          Shortcuts
        </div>
      </div>

      <section data-toggle="wy-nav-shift" id="psyneulink-content-wrap" class="psyneulink-content-wrap">
        <div class="psyneulink-content-left">

        
          
          <div class="rst-content">
          
            <div role="main" class="main-content" itemscope="itemscope" itemtype="http://schema.org/Article">
             <article itemprop="articleBody" id="psyneulink-article" class="psyneulink-article">
              
  <section id="grucomposition">
<h1>GRUComposition<a class="headerlink" href="#grucomposition" title="Link to this heading">¶</a></h1>
<div class="related docutils container">
<p><em>Related</em></p>
<ul class="simple">
<li><p><a class="reference internal" href="AutodiffComposition.html"><span class="doc">AutodiffComposition</span></a></p></li>
<li><p><a class="reference internal" href="Composition.html#composition-learning"><span class="std std-ref">Learning in a Composition</span></a></p></li>
</ul>
</div>
<section id="contents">
<span id="module-psyneulink.library.compositions.grucomposition.grucomposition"></span><h2>Contents<a class="headerlink" href="#contents" title="Link to this heading">¶</a></h2>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="#grucomposition-overview"><span class="std std-ref">Overview</span></a></p></li>
<li><p><a class="reference internal" href="#grucomposition-creation"><span class="std std-ref">Creation</span></a></p></li>
<li><p><a class="reference internal" href="#grucomposition-structure"><span class="std std-ref">Structure</span></a></p></li>
<li><dl class="simple">
<dt><a class="reference internal" href="#grucomposition-execution"><span class="std std-ref">Execution</span></a></dt><dd><ul>
<li><p><a class="reference internal" href="#grucomposition-processing"><span class="std std-ref">Processing</span></a></p></li>
<li><p><a class="reference internal" href="#grucomposition-learning"><span class="std std-ref">Learning</span></a></p></li>
</ul>
</dd>
</dl>
</li>
<li><p><code class="xref any docutils literal notranslate"><span class="pre">GRUComposition_Examples</span></code></p></li>
<li><p><a class="reference internal" href="#grucomposition-class-reference"><span class="std std-ref">Class Reference</span></a></p></li>
</ul>
</div></blockquote>
</section>
<section id="overview">
<span id="grucomposition-overview"></span><h2>Overview<a class="headerlink" href="#overview" title="Link to this heading">¶</a></h2>
<p>The GRUComposition a subclass of <a class="reference internal" href="AutodiffComposition.html"><span class="doc">AutodiffComposition</span></a> that implements a single-layered gated recurrent network,
which uses a set of <a class="reference internal" href="GatingMechanism.html"><span class="doc">GatingMechanisms</span></a> to implement gates that  modulate the flow of information
through its <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">hidden_layer_node</span></code></a>. This implements the exact same computations as
a PyTorch <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.GRU.html">GRU</a> module, which is used to implement
it when its <code class="xref any docutils literal notranslate"><span class="pre">learn</span></code> method is called.  When it is executed in Python model, it functions
in the same way as a <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.GRUCell.html">GRUCell</a> module, processing
its input one stimulus at a time.  However, when used for <a class="reference internal" href="#grucomposition-learning"><span class="std std-ref">learning</span></a>, it is executed as
a PyTorch <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.GRU.html">GRU</a> module, so that it can used to
process an entire sequence of stimuli at once, and learn to predict the next stimulus in the sequence.</p>
</section>
<section id="creation">
<span id="grucomposition-creation"></span><h2>Creation<a class="headerlink" href="#creation" title="Link to this heading">¶</a></h2>
<p>An GRUComposition is created by calling its constructor.  When it’s <code class="xref any docutils literal notranslate"><span class="pre">learn</span></code>
method is called, it automatically creates a PytorchGRUCompositionWrapper that implements the GRUComposition
using the PyTorch <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.GRU.html">GRU</a> module, that is trained
using PyTorch. Its constructor takes the following arguments that are in addition to or handled differently
than <a class="reference internal" href="AutodiffComposition.html"><span class="doc">AutodiffComposition</span></a>:</p>
<p><strong>input_size</strong> (int) specifies the length of the input array to the GRUComposition, and the size
of the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.input_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.input_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">input_node</span></code></a>, which can be different than <strong>hidden_size</strong>.</p>
<p><strong>hidden_size</strong> (int) specifies the length of the internal (“hidden”) state of the GRUComposition,
and the size of the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">hidden_layer_node</span></code></a> and all nodes other
than the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.input_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.input_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">input_node</span></code></a>, which can be different than <strong>input_size</strong>.</p>
<p><strong>bias</strong> (bool) specifies whether the GRUComposition includes <a class="reference internal" href="Composition.html#psyneulink.core.compositions.composition.NodeRole.BIAS" title="psyneulink.core.compositions.composition.NodeRole.BIAS"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">BIAS</span></code></a> <a class="reference internal" href="Composition.html#composition-nodes"><span class="std std-ref">Nodes</span></a>
and, correspondingly, the <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.GRU.html">GRU</a> module uses
bias vectors in its computations.</p>
<p id="grucomposition-learning-arguments"><strong>enable_learning</strong> (bool) specifies whether learning is enabled for the GRUComposition;  if it is false,
no learning will occur, even when its <a class="reference internal" href="AutodiffComposition.html#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.learn" title="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.learn"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">learn</span></code></a> method is called.</p>
<p><strong>learning_rate</strong> (bool or float): specifies the default learning_rate for the parameters of the Pytorch <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.GRU.html">GRU</a> module that are not specified for individual
parameters in the <strong>optimizer_params</strong> argument of the AutodiffComposition’s constructor in the call to its <a class="reference internal" href="AutodiffComposition.html#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.learn" title="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.learn"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">learn</span></code></a> method. If it is an int or a float, that is used as the default learning rate for the
GRUComposition; if it is None or True, the GRUComposition’s default <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.learning_rate" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.learning_rate"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">learning_rate</span></code></a>
(.001) is used; if it is False, then learning will occur only for parameters for which an explicit learning_rate
has been specified in the <strong>optimizer_params</strong> argument of the GRUComposition’s constructor</p>
<p id="grucomposition-individual-learning-rates"><strong>optimizer_params</strong> (dict): used to specify parameter-specific learning rates, which supercede the value of the
GRUCompositon’s <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.learning_rate" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.learning_rate"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">learning_rate</span></code></a>. Keys of the dict must reference parameters of the
<a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.GRU.html">GRU</a> module, and values their learning_rates,
as described below.</p>
<blockquote>
<div><p><strong>Keys</strong> for specifying individual parameters in the <strong>optimizer_params</strong> dict:</p>
<blockquote>
<div><ul class="simple">
<li><p><em>`w_ih`</em>: learning rate for the <code class="docutils literal notranslate"><span class="pre">weight_ih_l0</span></code> parameter of the PyTorch <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.GRU.html">GRU</a> module that corresponds to the weights of the
efferent projections from the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.input_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.input_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">input_node</span></code></a> of the GRUComposition: <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_in" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_in"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">wts_in</span></code></a>, <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_iu" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_iu"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">wts_iu</span></code></a>, and <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_ir" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_ir"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">wts_ir</span></code></a>; its value
is stored in the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.w_ih_learning_rate" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.w_ih_learning_rate"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">w_ih_learning_rate</span></code></a> attribute of the GRUComposition;</p></li>
<li><p><em>`w_hh`</em>: learning rate for the <code class="docutils literal notranslate"><span class="pre">weight_hh_l0</span></code> parameter of the PyTorch <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.GRU.html">GRU</a> module that corresponds to the weights of the
efferent projections from the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">hidden_layer_node</span></code></a> of the GRUComposition:
<a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_hn" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_hn"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">wts_hn</span></code></a>, <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_hu" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_hu"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">wts_hu</span></code></a>, <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_hr" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_hr"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">wts_hr</span></code></a>; its
value is stored in the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.w_hh_learning_rate" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.w_hh_learning_rate"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">w_hh_learning_rate</span></code></a> attribute of the GRUComposition;</p></li>
<li><p><em>`b_ih`</em>: learning rate for the <code class="docutils literal notranslate"><span class="pre">bias_ih_l0</span></code> parameter of the PyTorch <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.GRU.html">GRU</a> module that corresponds to the biases of the
efferent projections from the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.input_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.input_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">input_node</span></code></a> of the GRUComposition: <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_ir" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_ir"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">bias_ir</span></code></a>, <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_iu" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_iu"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">bias_iu</span></code></a>, <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_in" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_in"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">bias_in</span></code></a>; its value
is stored in the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.b_ih_learning_rate" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.b_ih_learning_rate"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">b_ih_learning_rate</span></code></a> attribute of the GRUComposition;</p></li>
<li><p><em>`b_hh`</em>: learning rate for the <code class="docutils literal notranslate"><span class="pre">bias_hh_l0</span></code> parameter of the PyTorch <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.GRU.html">GRU</a> module that corresponds to the biases of the
efferent projections from the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">hidden_layer_node</span></code></a> of the GRUComposition:
<a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_hr" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_hr"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">bias_hr</span></code></a>, <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_hu" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_hu"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">bias_hu</span></code></a>, <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_hn" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_hn"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">bias_hn</span></code></a>; its
value is stored in the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.b_hh_learning_rate" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.b_hh_learning_rate"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">b_hh_learning_rate</span></code></a> attribute of theGRUComposition.</p></li>
</ul>
</div></blockquote>
<p><strong>Values</strong> for specifying an individual parameter’s learning_rate in the <strong>optimizer_params</strong> dict</p>
<blockquote>
<div><ul class="simple">
<li><p><em>int or float</em>: the value is used as the learning_rate;</p></li>
<li><p><em>True or None</em>: the value of the GRUComposition’s <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.learning_rate" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.learning_rate"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">learning_rate</span></code></a> is used;</p></li>
<li><p><em>False</em>: the parameter is not learned.</p></li>
</ul>
</div></blockquote>
</div></blockquote>
</section>
<section id="structure">
<span id="grucomposition-structure"></span><h2>Structure<a class="headerlink" href="#structure" title="Link to this heading">¶</a></h2>
<p>The GRUComposition assigns a node to each of the computations of the PyTorch <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.GRU.html">GRU</a> module, and a Projetion to each of
its weight and bias parameters, as shown in the figure below:</p>
<figure class="align-center" id="id40">
<a class="reference internal image-reference" href="_images/GRUComposition_fig.svg"><img alt="GRU Composition" src="_images/GRUComposition_fig.svg" style="width: 400px;" />
</a>
<figcaption>
<p><span class="caption-text"><strong>Structure of a GRUComposition</strong> – can be seen in more detail using the Composition’s s <a class="reference internal" href="Visualization.html#psyneulink.core.compositions.showgraph.ShowGraph.show_graph" title="psyneulink.core.compositions.showgraph.ShowGraph.show_graph"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">show_graph</span></code></a> method with its <strong>show_node_structure</strong> argument set to <code class="docutils literal notranslate"><span class="pre">True</span></code> or <code class="docutils literal notranslate"><span class="pre">ALL</span></code>;
can also be seen with biases added by setting the <strong>show_bias</strong> argument to <code class="docutils literal notranslate"><span class="pre">True</span></code> in the constructor.</span><a class="headerlink" href="#id40" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>The <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.input_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.input_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">input_node</span></code></a> receives the input to the GRUComposition, and passes it to the
<a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">hidden_layer_node</span></code></a>, that implements the recurrence and integration function of
a GRU.  The <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.reset_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.reset_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">reset_node</span></code></a> gates the input to the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.new_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.new_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">new_node</span></code></a>. The
<a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.update_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.update_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">update_node</span></code></a> gates the input to the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">hidden_layer_node</span></code></a>
from the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.new_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.new_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">new_node</span></code></a> (current input) and the prior state of the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">hidden_layer_node</span></code></a> (i.e., the input it receives from its recurrent Projection).  The <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.output_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.output_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">output_node</span></code></a> receives the output of current state of the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">hidden_layer_node</span></code></a> that is provided as the output of the GRUComposition.  The <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.reset_gate" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.reset_gate"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">reset_gate</span></code></a> and <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.update_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.update_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">update_node</span></code></a> are <a class="reference internal" href="GatingMechanism.html"><span class="doc">GatingMechanisms</span></a>,
while the other nodes are all <a class="reference internal" href="ProcessingMechanism.html"><span class="doc">Processing Mechanisms</span></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The GRUComposition is limited to a single layer GRU at present, thus its <code class="docutils literal notranslate"><span class="pre">num_layers</span></code> argument is not
implemented.  Similarly, <code class="docutils literal notranslate"><span class="pre">dropout</span></code> and <code class="docutils literal notranslate"><span class="pre">bidirectional</span></code> arguments are not yet implemented.  These will
be added in a future version.</p>
</div>
</section>
<section id="execution">
<span id="grucomposition-execution"></span><h2>Execution<a class="headerlink" href="#execution" title="Link to this heading">¶</a></h2>
<section id="processing">
<span id="grucomposition-processing"></span><h3><em>Processing</em><a class="headerlink" href="#processing" title="Link to this heading">¶</a></h3>
<p>The GRUComposition implements the following computations by its <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.reset_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.reset_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">reset</span></code></a>, <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.update_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.update_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">update</span></code></a>, <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.new_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.new_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">new</span></code></a>, and <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">hidden_layer</span></code></a>
<a class="reference internal" href="Composition.html#composition-nodes"><span class="std std-ref">Nodes</span></a> when it is executed:</p>
<blockquote>
<div><p><a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.reset_gate" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.reset_gate"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">reset</span></code></a>(t) = <a class="reference internal" href="TransferFunctions.html#psyneulink.core.components.functions.nonstateful.transferfunctions.Logistic" title="psyneulink.core.components.functions.nonstateful.transferfunctions.Logistic"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Logistic</span></code></a>[(<a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_ir" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_ir"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">wts_ir</span></code></a> *
<a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.input_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.input_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">input</span></code></a>) + <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_ir" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_ir"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">bias_ir</span></code></a> +
(<a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_hr" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_hr"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">wts_hr</span></code></a> * <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">hidden_layer</span></code></a>(t-1)) +
<a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_hr" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_hr"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">bias_hr</span></code></a>)]</p>
<p><a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.update_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.update_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">update</span></code></a>(t) = <a class="reference internal" href="TransferFunctions.html#psyneulink.core.components.functions.nonstateful.transferfunctions.Logistic" title="psyneulink.core.components.functions.nonstateful.transferfunctions.Logistic"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Logistic</span></code></a>[(<a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_iu" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_iu"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">wts_iu</span></code></a> *
<a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.input_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.input_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">input</span></code></a>) + <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_iu" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_iu"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">bias_iu</span></code></a> + (<a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_hu" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_hu"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">wts_hu</span></code></a> *
<a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">hidden_layer</span></code></a>(t-1)) + <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_hu" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_hu"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">bias_hu</span></code></a>]</p>
<p><a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.new_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.new_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">new</span></code></a>(t) = <span class="math notranslate nohighlight">\(tanh\)</span>[(<a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_in" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_in"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">wts_in</span></code></a> *
<a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.input_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.input_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">input</span></code></a>) + <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_in" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_in"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">bias_in</span></code></a> +
(<a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.reset_gate" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.reset_gate"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">reset</span></code></a>(t) * (<a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_hn" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_hn"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">wts_hn</span></code></a> *
<a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">hidden_layer</span></code></a>(t-1) + <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_hn" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_hn"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">bias_hn</span></code></a>)]</p>
<p><a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">hidden_layer</span></code></a>(t) = [(1 - <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.update_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.update_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">update</span></code></a>(t)) *
<a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.new_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.new_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">new</span></code></a>(t)] + [<a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.update_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.update_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">update</span></code></a>(t) * <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">hidden_layer</span></code></a>(t-1)]</p>
</div></blockquote>
<p>This corresponds to the computations of the <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.GRU.html">GRU</a> module:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}&amp;reset = Logistic(wts\_ir \cdot input + bias\_ir + wts\_hr \cdot hidden + bias\_hr)\\&amp;update = Logistic(wts\_iu \cdot input + bias\_iu + wts\_hu \cdot hidden + bias\_hu)\\&amp;new = Tanh(wts\_in \cdot input + bias\_in + reset \cdot (wts\_hn \cdot hidden + bias\_hn))\\&amp;hidden = (1 - update) \odot new + update \odot hidden\end{aligned}\end{align} \]</div>
<p>where <span class="math notranslate nohighlight">\(\cdot\)</span> is the dot product, <span class="math notranslate nohighlight">\(\odot\)</span> is the Hadamard product, and all values are for the
current execution of the Composition <em>(t)</em> except for hidden, which uses the value from the prior execution <em>(t-1)</em>
(see <a class="reference internal" href="Composition.html#composition-cycle"><span class="std std-ref">Cycles</span></a> for handling of recurrence and cycles).</p>
<div class="technical-note docutils container">
<p>The <a class="reference internal" href="#grucomposition-structure"><span class="std std-ref">full Composition</span></a> is executed when its <a class="reference internal" href="Composition.html#psyneulink.core.compositions.composition.Composition.run" title="psyneulink.core.compositions.composition.Composition.run"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">run</span></code></a> method is
called with <strong>execution_mode</strong> set to <a class="reference internal" href="LLVM.html#psyneulink.core.llvm.__init__.ExecutionMode.Python" title="psyneulink.core.llvm.__init__.ExecutionMode.Python"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">ExecutionMode.Python</span></code></a>, or if <code class="docutils literal notranslate"><span class="pre">torch_available</span></code> is False.  Otherwise, and
always in a call to <a class="reference internal" href="AutodiffComposition.html#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.learn" title="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.learn"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">learn</span></code></a>, the GRUComposition is executed using the PyTorch <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.GRU.html">GRU</a> module with values of the individual
computations copied back to Nodes of the full GRUComposition at times determined by the value of the
<a class="reference internal" href="AutodiffComposition.html#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.synch_node_values_with_torch" title="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.synch_node_values_with_torch"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">synch_node_values_with_torch</span></code></a> option.</p>
</div>
</section>
<section id="learning">
<span id="grucomposition-learning"></span><h3><em>Learning</em><a class="headerlink" href="#learning" title="Link to this heading">¶</a></h3>
<p>Learning is executed using the <a class="reference internal" href="AutodiffComposition.html#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.learn" title="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.learn"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">learn</span></code></a> method in same way as a standard <a class="reference internal" href="AutodiffComposition.html"><span class="doc">AutodiffComposition</span></a>.  For learning to
occur the following conditions must obtain:</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.enable_learning" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.enable_learning"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">enable_learning</span></code></a> must be set to <code class="xref any docutils literal notranslate"><span class="pre">True</span></code> (the default);</p></li>
<li><p>GRUCompositions’s <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.learning_rate" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.learning_rate"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">learning_rate</span></code></a> must not be False and/or the
<a class="reference internal" href="#grucomposition-individual-learning-rates"><span class="std std-ref">learning_rate of individual parameters</span></a> must not all be False;</p></li>
<li><p><strong>execution_mode</strong> argument of the <a class="reference internal" href="AutodiffComposition.html#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.learn" title="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.learn"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">learn</span></code></a> method must <a class="reference internal" href="LLVM.html#psyneulink.core.llvm.__init__.ExecutionMode.PyTorch" title="psyneulink.core.llvm.__init__.ExecutionMode.PyTorch"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">ExecutionMode.PyTorch</span></code></a>
(the default).</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Because a GRUComposition uses the PyTorch <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.GRU.html">GRU</a> module to implement its computations during
learning, its <a class="reference internal" href="AutodiffComposition.html#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.learn" title="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.learn"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">learn</span></code></a> method can only be called with the <strong>execution_mode</strong>
argument set to <a class="reference internal" href="LLVM.html#psyneulink.core.llvm.__init__.ExecutionMode.PyTorch" title="psyneulink.core.llvm.__init__.ExecutionMode.PyTorch"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">ExecutionMode.PyTorch</span></code></a> (the default).</p>
</div>
</div></blockquote>
<p>The GRUComposition uses the PyTorch <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.GRU.html">GRU</a> module
to implement its computations during learning. After learning, the values of the module’s parameters are copied
to the weight <a class="reference internal" href="MappingProjection.html#psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection.matrix" title="psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection.matrix"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">matrices</span></code></a> of the corresponding <a class="reference internal" href="MappingProjection.html"><span class="doc">MappingProjections</span></a>,
and results of computations are copied to the <a class="reference internal" href="Mechanism.html#psyneulink.core.components.mechanisms.mechanism.Mechanism_Base.value" title="psyneulink.core.components.mechanisms.mechanism.Mechanism_Base.value"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">values</span></code></a> of the corresponding <a class="reference internal" href="Composition.html#composition-nodes"><span class="std std-ref">Nodes</span></a> in the GRUComposition at times determined by the value of the <a class="reference internal" href="AutodiffComposition.html#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.synch_node_values_with_torch" title="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.synch_node_values_with_torch"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">synch_node_values_with_torch</span></code></a> option.</p>
</section>
</section>
<section id="class-reference">
<span id="grucomposition-class-reference"></span><h2>Class Reference<a class="headerlink" href="#class-reference" title="Link to this heading">¶</a></h2>
</section>
<dl class="py class">
<dt class="sig sig-object py" id="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">psyneulink.library.compositions.grucomposition.grucomposition.</span></span><span class="sig-name descname"><span class="pre">GRUComposition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_learning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'GRU</span> <span class="pre">Composition'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition" title="Link to this definition">¶</a></dt>
<dd><p>Subclass of <a class="reference internal" href="AutodiffComposition.html"><span class="doc">AutodiffComposition</span></a> that implements a single-layered gated recurrent network.</p>
<p>See <a class="reference internal" href="#grucomposition-structure"><span class="std std-ref">Structure</span></a> and technical_note under under <a class="reference internal" href="#grucomposition-execution"><span class="std std-ref">Execution</span></a>
for a description of when the full Composition is constructed and used for execution
vs. when the PyTorch <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.GRU.html">GRU</a>
module is used.</p>
<dl class="simple">
<dt>Note: all exposed methods, attributes and <a class="reference internal" href="Parameters.html#psyneulink.core.globals.parameters.Parameter" title="psyneulink.core.globals.parameters.Parameter"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Parameters</span></code></a>) of the GRUComposition are</dt><dd><p>PsyNeuLink elements; all PyTorch-specific elements belong to <a class="reference internal" href="AutodiffComposition.html#psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.pytorch_representation" title="psyneulink.library.compositions.autodiffcomposition.AutodiffComposition.pytorch_representation"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">pytorch_representation</span></code></a> which, for a GRUComposition, is of class
<a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.PytorchGRUCompositionWrapper" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.PytorchGRUCompositionWrapper"><code class="xref any py py-class docutils literal notranslate"><span class="pre">PytorchGRUCompositionWrapper</span></code></a>.</p>
</dd>
</dl>
<p>Constructor takes the following arguments in addition to those of <a class="reference internal" href="AutodiffComposition.html"><span class="doc">AutodiffComposition</span></a>:</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_size</strong> (<em>int : default 1</em>) – specifies the length of the input array to the GRUComposition, and the size of the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.input_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.input_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">input_node</span></code></a>.</p></li>
<li><p><strong>hidden_size</strong> (<em>int : default 1</em>) – specifies the length of the internal state of the GRUComposition, and the size of the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">hidden_layer_node</span></code></a> and all nodes other than the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.input_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.input_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">input_node</span></code></a>.</p></li>
<li><p><strong>bias</strong> (<em>bool : default False</em>) – specifies whether the GRUComposition uses bias vectors in its computations.</p></li>
<li><p><strong>enable_learning</strong> (<em>bool : default True</em>) – specifies whether learning is enabled for the GRUComposition (see <a class="reference internal" href="#grucomposition-learning-arguments"><span class="std std-ref">Learning Arguments</span></a> for additional details).</p></li>
<li><p><strong>learning_rate</strong> (<em>float : default .001</em>) – specifies the learning_rate for the GRUComposition (see <a class="reference internal" href="#grucomposition-learning-arguments"><span class="std std-ref">Learning Arguments</span></a> for additional details).</p></li>
<li><p><strong>optimizer_params</strong> (<em>Dict</em><em>[</em><em>str: value</em><em>]</em>) – specifies parameters for the optimizer used for learning by the GRUComposition
(see <a class="reference internal" href="#grucomposition-learning-arguments"><span class="std std-ref">Learning Arguments</span></a> for details of specification).</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.input_size">
<span class="sig-name descname"><span class="pre">input_size</span></span><a class="headerlink" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.input_size" title="Link to this definition">¶</a></dt>
<dd><p>determines the length of the input array to the GRUComposition and size of the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.input_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.input_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">input_node</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_size">
<span class="sig-name descname"><span class="pre">hidden_size</span></span><a class="headerlink" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_size" title="Link to this definition">¶</a></dt>
<dd><p>determines the size of the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">hidden_layer_node</span></code></a> and all other <a class="reference internal" href="Composition.html#psyneulink.core.compositions.composition.NodeRole.INTERNAL" title="psyneulink.core.compositions.composition.NodeRole.INTERNAL"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">INTERNAL</span></code></a> <a class="reference internal" href="Composition.html#composition-nodes"><span class="std std-ref">Nodes</span></a>
of the GRUComposition.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias">
<span class="sig-name descname"><span class="pre">bias</span></span><a class="headerlink" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias" title="Link to this definition">¶</a></dt>
<dd><p>determines whether the GRUComposition uses bias vectors in its computations.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.enable_learning">
<span class="sig-name descname"><span class="pre">enable_learning</span></span><a class="headerlink" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.enable_learning" title="Link to this definition">¶</a></dt>
<dd><p>determines whether learning is enabled for the GRUComposition
(see <a class="reference internal" href="#grucomposition-learning-arguments"><span class="std std-ref">Learning Arguments</span></a> for additional details).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.learning_rate">
<span class="sig-name descname"><span class="pre">learning_rate</span></span><a class="headerlink" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.learning_rate" title="Link to this definition">¶</a></dt>
<dd><p>determines the default learning_rate for the parameters of the Pytorch <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.GRU.html">GRU</a> module that are not specified
for individual parameters in the <strong>optimizer_params</strong> argument of the AutodiffComposition’s
constructor in the call to its <code class="xref any docutils literal notranslate"><span class="pre">learn</span></code> method (see <a class="reference internal" href="#grucomposition-learning-arguments"><span class="std std-ref">Learning Arguments</span></a> for additional details).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.w_ih_learning_rate">
<span class="sig-name descname"><span class="pre">w_ih_learning_rate</span></span><a class="headerlink" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.w_ih_learning_rate" title="Link to this definition">¶</a></dt>
<dd><p>determines the learning rate specifically for the weights of the <a class="reference internal" href="Mechanism.html#id9" title="psyneulink.core.components.mechanisms.mechanism.Mechanism_Base.efferents"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">efferent</span> <span class="pre">projections</span></code></a> from the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.input_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.input_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">input_node</span></code></a>
of the GRUComposition: <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_in" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_in"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">wts_in</span></code></a>, <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_iu" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_iu"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">wts_iu</span></code></a>,
and <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_ir" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_ir"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">wts_ir</span></code></a>; corresponds to the <code class="docutils literal notranslate"><span class="pre">weight_ih_l0</span></code> parameter of the
PyTorch <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.GRU.html">GRU</a> module
(see <a class="reference internal" href="#grucomposition-learning-arguments"><span class="std std-ref">Learning Arguments</span></a> for additional details).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>flot or bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.w_hh_learning_rate">
<span class="sig-name descname"><span class="pre">w_hh_learning_rate</span></span><a class="headerlink" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.w_hh_learning_rate" title="Link to this definition">¶</a></dt>
<dd><p>determines the learning rate specifically for the weights of the <a class="reference internal" href="Mechanism.html#id9" title="psyneulink.core.components.mechanisms.mechanism.Mechanism_Base.efferents"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">efferent</span> <span class="pre">projections</span></code></a> from the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">hidden_layer_node</span></code></a>
of the GRUComposition: <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_hn" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_hn"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">wts_hn</span></code></a>, <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_hu" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_hu"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">wts_hu</span></code></a>,
<a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_hr" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_hr"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">wts_hr</span></code></a>; corresponds to the <code class="docutils literal notranslate"><span class="pre">weight_hh_l0</span></code> parameter of the
PyTorch <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.GRU.html">GRU</a> module</p>
<blockquote>
<div><p>(see <a class="reference internal" href="#grucomposition-learning-arguments"><span class="std std-ref">Learning Arguments</span></a> for additional details).</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float or bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.b_ih_learning_rate">
<span class="sig-name descname"><span class="pre">b_ih_learning_rate</span></span><a class="headerlink" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.b_ih_learning_rate" title="Link to this definition">¶</a></dt>
<dd><p>determines the learning rate specifically for the biases influencing the <a class="reference internal" href="Mechanism.html#id9" title="psyneulink.core.components.mechanisms.mechanism.Mechanism_Base.efferents"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">efferent</span> <span class="pre">projections</span></code></a> from the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.input_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.input_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">input_node</span></code></a> of the GRUComposition:
<a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_ir" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_ir"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">bias_ir</span></code></a>, <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_iu" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_iu"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">bias_iu</span></code></a>, <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_in" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_in"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">bias_in</span></code></a>;
corresponds to the <code class="docutils literal notranslate"><span class="pre">bias_ih_l0</span></code> parameter of the PyTorch <a class="reference internal" href="#grucomposition-learning-arguments"><span class="std std-ref">GRU module (see `Learning Arguments</span></a> for additional details).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float or bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.b_hh_learning_rate">
<span class="sig-name descname"><span class="pre">b_hh_learning_rate</span></span><a class="headerlink" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.b_hh_learning_rate" title="Link to this definition">¶</a></dt>
<dd><p>determines the learning rate specifically for the biases influencing the <a class="reference internal" href="Mechanism.html#id9" title="psyneulink.core.components.mechanisms.mechanism.Mechanism_Base.efferents"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">efferent</span> <span class="pre">projections</span></code></a> from the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">hidden_layer_node</span></code></a> of
the GRUComposition: <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_hr" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_hr"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">bias_hr</span></code></a>, <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_hu" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_hu"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">bias_hu</span></code></a>,
<a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_hn" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_hn"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">bias_hn</span></code></a>; corresponds to the <code class="docutils literal notranslate"><span class="pre">bias_hh_l0</span></code> parameter of the PyTorch
<a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.GRU.html">GRU</a> module (see <a class="reference internal" href="#grucomposition-learning-arguments"><span class="std std-ref">Learning Arguments</span></a> for additional details).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float or bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.input_node">
<span class="sig-name descname"><span class="pre">input_node</span></span><a class="headerlink" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.input_node" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="Composition.html#psyneulink.core.compositions.composition.NodeRole.INPUT" title="psyneulink.core.compositions.composition.NodeRole.INPUT"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">INPUT</span></code></a> <a class="reference internal" href="Composition.html#composition-nodes"><span class="std std-ref">Node</span></a> that receives the input to the GRUComposition and passes
it to the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">hidden_layer_node</span></code></a>; corresponds to input <em>(i)</em> of the PyTorch
<a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.GRU.html">GRU</a> module.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="ProcessingMechanism.html#psyneulink.core.components.mechanisms.processing.processingmechanism.ProcessingMechanism" title="psyneulink.core.components.mechanisms.processing.processingmechanism.ProcessingMechanism">ProcessingMechanism</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.new_node">
<span class="sig-name descname"><span class="pre">new_node</span></span><a class="headerlink" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.new_node" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="ProcessingMechanism.html"><span class="doc">ProcessingMechanism</span></a> that provides the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">hidden_layer_node</span></code></a>
with the input from the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.input_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.input_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">input_node</span></code></a>, gated by the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.reset_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.reset_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">reset_node</span></code></a>; corresponds to new gate <em>(n)</em> of the PyTorch <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.GRU.html">GRU</a> module.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="ProcessingMechanism.html#psyneulink.core.components.mechanisms.processing.processingmechanism.ProcessingMechanism" title="psyneulink.core.components.mechanisms.processing.processingmechanism.ProcessingMechanism">ProcessingMechanism</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node">
<span class="sig-name descname"><span class="pre">hidden_layer_node</span></span><a class="headerlink" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="ProcessingMechanism.html"><span class="doc">ProcessingMechanism</span></a> that implements the recurrent layer of the GRUComposition; corresponds to
hidden layer <em>(h)</em> of the PyTorch <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.GRU.html">GRU</a> module.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="ProcessingMechanism.html#psyneulink.core.components.mechanisms.processing.processingmechanism.ProcessingMechanism" title="psyneulink.core.components.mechanisms.processing.processingmechanism.ProcessingMechanism">ProcessingMechanism</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.reset_node">
<span class="sig-name descname"><span class="pre">reset_node</span></span><a class="headerlink" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.reset_node" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="GatingMechanism.html"><span class="doc">Gating Mechanism</span></a> that that gates the input to the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.new_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.new_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">new_node</span></code></a>; corresponds to reset
gate <em>(r)</em> of the PyTorch <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.GRU.html">GRU</a> module.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="GatingMechanism.html#psyneulink.core.components.mechanisms.modulatory.gating.gatingmechanism.GatingMechanism" title="psyneulink.core.components.mechanisms.modulatory.gating.gatingmechanism.GatingMechanism">GatingMechanism</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.update_node">
<span class="sig-name descname"><span class="pre">update_node</span></span><a class="headerlink" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.update_node" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="GatingMechanism.html"><span class="doc">Gating Mechanism</span></a> that gates the inputs to the hidden layer from the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.new_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.new_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">new_node</span></code></a>
and the prior state of the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">hidden_layer_node</span></code></a> itself (i.e., the input
it receives from its recurrent Projection); corresponds to update gate <em>(z)</em> of the PyTorch <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.GRU.html">GRU</a> module.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="GatingMechanism.html#psyneulink.core.components.mechanisms.modulatory.gating.gatingmechanism.GatingMechanism" title="psyneulink.core.components.mechanisms.modulatory.gating.gatingmechanism.GatingMechanism">GatingMechanism</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.output_node">
<span class="sig-name descname"><span class="pre">output_node</span></span><a class="headerlink" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.output_node" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="Composition.html#psyneulink.core.compositions.composition.NodeRole.INPUT" title="psyneulink.core.compositions.composition.NodeRole.INPUT"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">OUTPUT</span></code></a> <a class="reference internal" href="Composition.html#composition-nodes"><span class="std std-ref">Node</span></a> that receives the output of the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">hidden_layer_node</span></code></a>; corresponds to result of the PyTorch <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.GRU.html">GRU</a> module.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="ProcessingMechanism.html#psyneulink.core.components.mechanisms.processing.processingmechanism.ProcessingMechanism" title="psyneulink.core.components.mechanisms.processing.processingmechanism.ProcessingMechanism">ProcessingMechanism</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.learnable_projections">
<span class="sig-name descname"><span class="pre">learnable_projections</span></span><a class="headerlink" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.learnable_projections" title="Link to this definition">¶</a></dt>
<dd><p>list of the <a class="reference internal" href="MappingProjection.html"><span class="doc">MappingProjections</span></a> in the GRUComposition that have
<a class="reference internal" href="MappingProjection.html#psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection.matrix" title="psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection.matrix"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">matrix</span></code></a> parameters that can be learned; these correspond to the learnable
parameters of the PyTorch <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.GRU.html">GRU</a> module.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[<a class="reference internal" href="MappingProjection.html#psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection" title="psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection">MappingProjection</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_in">
<span class="sig-name descname"><span class="pre">wts_in</span></span><a class="headerlink" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_in" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="MappingProjection.html"><span class="doc">MappingProjection</span></a> with learnable <a class="reference internal" href="MappingProjection.html#psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection.matrix" title="psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection.matrix"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">matrix</span></code></a> (“connection weights”) that projects
from the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.input_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.input_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">input_node</span></code></a> to the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.new_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.new_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">new_node</span></code></a>; corresponds to
<span class="math notranslate nohighlight">\(W_{in}\)</span> term in the PyTorch <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.GRU.html">GRU</a> module’s
computation (see <a class="reference internal" href="#grucomposition-structure"><span class="std std-ref">Structure</span></a> for additional information).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="MappingProjection.html#psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection" title="psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection">MappingProjection</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_iu">
<span class="sig-name descname"><span class="pre">wts_iu</span></span><a class="headerlink" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_iu" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="MappingProjection.html"><span class="doc">MappingProjection</span></a> with learnable <a class="reference internal" href="MappingProjection.html#psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection.matrix" title="psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection.matrix"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">matrix</span></code></a> (“connection weights”) that projects
from the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.input_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.input_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">input_node</span></code></a> to the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.update_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.update_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">update_node</span></code></a>; corresponds
to <span class="math notranslate nohighlight">\(W_{iz}\)</span> term in the PyTorch <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.GRU.html">GRU</a>
module’s computation (see <a class="reference internal" href="#grucomposition-structure"><span class="std std-ref">Structure</span></a> for additional information).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="MappingProjection.html#psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection" title="psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection">MappingProjection</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_ir">
<span class="sig-name descname"><span class="pre">wts_ir</span></span><a class="headerlink" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_ir" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="MappingProjection.html"><span class="doc">MappingProjection</span></a> with learnable <a class="reference internal" href="MappingProjection.html#psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection.matrix" title="psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection.matrix"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">matrix</span></code></a> (“connection weights”) that projects
from the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.input_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.input_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">input_node</span></code></a> to the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.reset_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.reset_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">reset_node</span></code></a>; corresponds
to <span class="math notranslate nohighlight">\(W_{ir}\)</span> term in the PyTorch <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.GRU.html">GRU</a>
module’s computation (see <a class="reference internal" href="#grucomposition-structure"><span class="std std-ref">Structure</span></a> for additional information).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="MappingProjection.html#psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection" title="psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection">MappingProjection</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_nh">
<span class="sig-name descname"><span class="pre">wts_nh</span></span><a class="headerlink" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_nh" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="MappingProjection.html"><span class="doc">MappingProjection</span></a> with learnable <a class="reference internal" href="MappingProjection.html#psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection.matrix" title="psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection.matrix"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">matrix</span></code></a> (“connection weights”) that projects
from the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.new_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.new_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">new_node</span></code></a> to the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">hidden_layer_node</span></code></a>.
(see <a class="reference internal" href="#grucomposition-structure"><span class="std std-ref">Structure</span></a> for additional information).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="MappingProjection.html#psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection" title="psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection">MappingProjection</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_hr">
<span class="sig-name descname"><span class="pre">wts_hr</span></span><a class="headerlink" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_hr" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="MappingProjection.html"><span class="doc">MappingProjection</span></a> with learnable <a class="reference internal" href="MappingProjection.html#psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection.matrix" title="psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection.matrix"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">matrix</span></code></a> (“connection weights”)
that projects from the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">hidden_layer_node</span></code></a> to the
<a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.reset_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.reset_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">reset_node</span></code></a>; corresponds to <span class="math notranslate nohighlight">\(W_{hr}\)</span> term in the PyTorch
<a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.GRU.html">GRU</a> module’s computation
(see <a class="reference internal" href="#grucomposition-structure"><span class="std std-ref">Structure</span></a> for additional information).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="MappingProjection.html#psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection" title="psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection">MappingProjection</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_hu">
<span class="sig-name descname"><span class="pre">wts_hu</span></span><a class="headerlink" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_hu" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="MappingProjection.html"><span class="doc">MappingProjection</span></a> with learnable <a class="reference internal" href="MappingProjection.html#psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection.matrix" title="psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection.matrix"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">matrix</span></code></a> (“connection weights”)
that projects from the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">hidden_layer_node</span></code></a> to the
<a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.update_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.update_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">update_node</span></code></a>; corresponds to <span class="math notranslate nohighlight">\(W_{hz}\)</span> in the PyTorch
<a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.GRU.html">GRU</a> module’s computation
(see <a class="reference internal" href="#grucomposition-structure"><span class="std std-ref">Structure</span></a> for additional information).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="MappingProjection.html#psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection" title="psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection">MappingProjection</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_hn">
<span class="sig-name descname"><span class="pre">wts_hn</span></span><a class="headerlink" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_hn" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="MappingProjection.html"><span class="doc">MappingProjection</span></a> with learnable <a class="reference internal" href="MappingProjection.html#psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection.matrix" title="psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection.matrix"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">matrix</span></code></a> (“connection weights”)
that projects from the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">hidden_layer_node</span></code></a> to the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.new_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.new_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">new_node</span></code></a>; corresponds to <span class="math notranslate nohighlight">\(W_{hn}\)</span> in the PyTorch
<a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.GRU.html">GRU</a> module’s computation
(see <a class="reference internal" href="#grucomposition-structure"><span class="std std-ref">Structure</span></a> for additional information).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="MappingProjection.html#psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection" title="psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection">MappingProjection</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_hh">
<span class="sig-name descname"><span class="pre">wts_hh</span></span><a class="headerlink" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_hh" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="MappingProjection.html"><span class="doc">MappingProjection</span></a> with fixed <a class="reference internal" href="MappingProjection.html#psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection.matrix" title="psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection.matrix"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">matrix</span></code></a> (“connection weights”) that projects
from the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">hidden_layer_node</span></code></a> to itself (i.e., the recurrent Projection).
(see <a class="reference internal" href="#grucomposition-structure"><span class="std std-ref">Structure</span></a> for additional information).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="MappingProjection.html#psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection" title="psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection">MappingProjection</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_ho">
<span class="sig-name descname"><span class="pre">wts_ho</span></span><a class="headerlink" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_ho" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="MappingProjection.html"><span class="doc">MappingProjection</span></a> with fixed <a class="reference internal" href="MappingProjection.html#psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection.matrix" title="psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection.matrix"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">matrix</span></code></a> (“connection weights”) that projects from
the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">hidden_layer_node</span></code></a> to the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.output_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.output_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">output_node</span></code></a>.
(see <a class="reference internal" href="#grucomposition-structure"><span class="std std-ref">Structure</span></a> for additional information).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="MappingProjection.html#psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection" title="psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection">MappingProjection</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.reset_gate">
<span class="sig-name descname"><span class="pre">reset_gate</span></span><a class="headerlink" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.reset_gate" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="GatingProjection.html"><span class="doc">GatingProjection</span></a> that gates the input to the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.new_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.new_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">new_node</span></code></a> from the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.input_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.input_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">input_node</span></code></a>; its <a class="reference internal" href="GatingProjection.html#psyneulink.core.components.projections.modulatory.gatingprojection.GatingProjection.value" title="psyneulink.core.components.projections.modulatory.gatingprojection.GatingProjection.value"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">value</span></code></a> is used in the Hadamard product with
the input to produce the new (external) input to the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">hidden_layer_node</span></code></a>.
(see <a class="reference internal" href="#grucomposition-structure"><span class="std std-ref">Structure</span></a> for additional information).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="GatingProjection.html#psyneulink.core.components.projections.modulatory.gatingprojection.GatingProjection" title="psyneulink.core.components.projections.modulatory.gatingprojection.GatingProjection">GatingProjection</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.new_gate">
<span class="sig-name descname"><span class="pre">new_gate</span></span><a class="headerlink" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.new_gate" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="GatingProjection.html"><span class="doc">GatingProjection</span></a> that gates the input to the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">hidden_layer_node</span></code></a> from the
<a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.new_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.new_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">new_node</span></code></a>; its <a class="reference internal" href="GatingProjection.html#psyneulink.core.components.projections.modulatory.gatingprojection.GatingProjection.value" title="psyneulink.core.components.projections.modulatory.gatingprojection.GatingProjection.value"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">value</span></code></a> is used in the Hadamard product
with the (external) input to the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">hidden_layer_node</span></code></a> from the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.new_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.new_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">new_node</span></code></a>, which determines how much of the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">hidden_layer_node</span></code></a>'s new state is determined by the external input vs. its prior state
(see <a class="reference internal" href="#grucomposition-structure"><span class="std std-ref">Structure</span></a> for additional information).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="GatingProjection.html#psyneulink.core.components.projections.modulatory.gatingprojection.GatingProjection" title="psyneulink.core.components.projections.modulatory.gatingprojection.GatingProjection">GatingProjection</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.recurrent_gate">
<span class="sig-name descname"><span class="pre">recurrent_gate</span></span><a class="headerlink" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.recurrent_gate" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="GatingProjection.html"><span class="doc">GatingProjection</span></a> that gates the input to the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">hidden_layer_node</span></code></a> from its
recurrent projection (<a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_hh" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_hh"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">wts_hh</span></code></a>); its <a class="reference internal" href="GatingProjection.html#psyneulink.core.components.projections.modulatory.gatingprojection.GatingProjection.value" title="psyneulink.core.components.projections.modulatory.gatingprojection.GatingProjection.value"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">value</span></code></a> is used in the
in the Hadamard product with the recurrent input to the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">hidden_layer_node</span></code></a>,
which determines how much of the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">hidden_layer_node</span></code></a>'s
new state is determined by its prior state vs.its external input
(see <a class="reference internal" href="#grucomposition-structure"><span class="std std-ref">Structure</span></a> for additional information).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="GatingProjection.html#psyneulink.core.components.projections.modulatory.gatingprojection.GatingProjection" title="psyneulink.core.components.projections.modulatory.gatingprojection.GatingProjection">GatingProjection</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_ir_node">
<span class="sig-name descname"><span class="pre">bias_ir_node</span></span><a class="headerlink" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_ir_node" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="Composition.html#psyneulink.core.compositions.composition.NodeRole.BIAS" title="psyneulink.core.compositions.composition.NodeRole.BIAS"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">BIAS</span></code></a> <a class="reference internal" href="Composition.html#composition-nodes"><span class="std std-ref">Node</span></a>, the Projection from which (<a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_ir" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_ir"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">bias_ir</span></code></a>) provides the
the bias to weights (<a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_ir" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_ir"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">wts_ir</span></code></a>) from the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.input_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.input_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">input_node</span></code></a> to the
<a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.reset_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.reset_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">reset_node</span></code></a> (see <a class="reference internal" href="#grucomposition-structure"><span class="std std-ref">Structure</span></a> for additional information).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="ProcessingMechanism.html#psyneulink.core.components.mechanisms.processing.processingmechanism.ProcessingMechanism" title="psyneulink.core.components.mechanisms.processing.processingmechanism.ProcessingMechanism">ProcessingMechanism</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_iu_node">
<span class="sig-name descname"><span class="pre">bias_iu_node</span></span><a class="headerlink" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_iu_node" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="Composition.html#psyneulink.core.compositions.composition.NodeRole.BIAS" title="psyneulink.core.compositions.composition.NodeRole.BIAS"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">BIAS</span></code></a> <a class="reference internal" href="Composition.html#composition-nodes"><span class="std std-ref">Node</span></a>, the Projection from which (<a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_iu" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_iu"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">bias_iu</span></code></a>) provides
the the bias to weights (<a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_iu" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_iu"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">wts_iu</span></code></a>) from the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.input_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.input_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">input_node</span></code></a>
to the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.update_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.update_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">update_node</span></code></a> (see <a class="reference internal" href="#grucomposition-structure"><span class="std std-ref">Structure</span></a> for additional information).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="ProcessingMechanism.html#psyneulink.core.components.mechanisms.processing.processingmechanism.ProcessingMechanism" title="psyneulink.core.components.mechanisms.processing.processingmechanism.ProcessingMechanism">ProcessingMechanism</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_in_node">
<span class="sig-name descname"><span class="pre">bias_in_node</span></span><a class="headerlink" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_in_node" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="Composition.html#psyneulink.core.compositions.composition.NodeRole.BIAS" title="psyneulink.core.compositions.composition.NodeRole.BIAS"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">BIAS</span></code></a> <a class="reference internal" href="Composition.html#composition-nodes"><span class="std std-ref">Node</span></a>, the Projection from which (<a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_in" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_in"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">bias_in</span></code></a>) provides the
the bias to weights (<a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_in" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_in"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">wts_in</span></code></a>) from the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.input_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.input_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">input_node</span></code></a> to the
<a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.new_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.new_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">new_node</span></code></a> (see <a class="reference internal" href="#grucomposition-structure"><span class="std std-ref">Structure</span></a> for additional information).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="ProcessingMechanism.html#psyneulink.core.components.mechanisms.processing.processingmechanism.ProcessingMechanism" title="psyneulink.core.components.mechanisms.processing.processingmechanism.ProcessingMechanism">ProcessingMechanism</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_hr_node">
<span class="sig-name descname"><span class="pre">bias_hr_node</span></span><a class="headerlink" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_hr_node" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="Composition.html#psyneulink.core.compositions.composition.NodeRole.BIAS" title="psyneulink.core.compositions.composition.NodeRole.BIAS"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">BIAS</span></code></a> <a class="reference internal" href="Composition.html#composition-nodes"><span class="std std-ref">Node</span></a>, the Projection from which (<a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_hr" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_hr"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">bias_hr</span></code></a>) provides the
the bias to weights (<a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_hr" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_hr"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">wts_hr</span></code></a>) from the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">hidden_layer_node</span></code></a> to the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.reset_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.reset_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">reset_node</span></code></a>
(see <a class="reference internal" href="#grucomposition-structure"><span class="std std-ref">Structure</span></a> for additional information).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="ProcessingMechanism.html#psyneulink.core.components.mechanisms.processing.processingmechanism.ProcessingMechanism" title="psyneulink.core.components.mechanisms.processing.processingmechanism.ProcessingMechanism">ProcessingMechanism</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_hu_node">
<span class="sig-name descname"><span class="pre">bias_hu_node</span></span><a class="headerlink" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_hu_node" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="Composition.html#psyneulink.core.compositions.composition.NodeRole.BIAS" title="psyneulink.core.compositions.composition.NodeRole.BIAS"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">BIAS</span></code></a> <a class="reference internal" href="Composition.html#composition-nodes"><span class="std std-ref">Node</span></a>, the Projection from which (<a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_hu" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_hu"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">bias_hu</span></code></a>) provides the
the bias to weights (<a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_hu" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_hu"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">wts_hu</span></code></a>) from the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">hidden_layer_node</span></code></a> to the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.update_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.update_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">update_node</span></code></a>
(see <a class="reference internal" href="#grucomposition-structure"><span class="std std-ref">Structure</span></a> for additional information).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="ProcessingMechanism.html#psyneulink.core.components.mechanisms.processing.processingmechanism.ProcessingMechanism" title="psyneulink.core.components.mechanisms.processing.processingmechanism.ProcessingMechanism">ProcessingMechanism</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_hn_node">
<span class="sig-name descname"><span class="pre">bias_hn_node</span></span><a class="headerlink" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_hn_node" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="Composition.html#psyneulink.core.compositions.composition.NodeRole.BIAS" title="psyneulink.core.compositions.composition.NodeRole.BIAS"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">BIAS</span></code></a> <a class="reference internal" href="Composition.html#composition-nodes"><span class="std std-ref">Node</span></a>, the Projection from which (<a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_hn" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_hn"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">bias_hn</span></code></a>) provides the
the bias to weights (<a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_hn" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_hn"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">wts_hn</span></code></a>) from the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">hidden_layer_node</span></code></a> to the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.new_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.new_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">new_node</span></code></a>
(see <a class="reference internal" href="#grucomposition-structure"><span class="std std-ref">Structure</span></a> for additional information).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="ProcessingMechanism.html#psyneulink.core.components.mechanisms.processing.processingmechanism.ProcessingMechanism" title="psyneulink.core.components.mechanisms.processing.processingmechanism.ProcessingMechanism">ProcessingMechanism</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.biases">
<span class="sig-name descname"><span class="pre">biases</span></span><a class="headerlink" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.biases" title="Link to this definition">¶</a></dt>
<dd><p>list of the <a class="reference internal" href="MappingProjection.html"><span class="doc">MappingProjections</span></a> from the <a class="reference internal" href="Composition.html#psyneulink.core.compositions.composition.NodeRole.BIAS" title="psyneulink.core.compositions.composition.NodeRole.BIAS"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">BIAS</span></code></a> <a class="reference internal" href="MappingProjection.html#psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection.matrix" title="psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection.matrix"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">Nodes</span> <span class="pre">of</span>
<span class="pre">the</span> <span class="pre">GRUComposition,</span> <span class="pre">all</span> <span class="pre">of</span> <span class="pre">which</span> <span class="pre">have</span> <span class="pre">`matrix</span></code></a> parameters if <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">bias</span></code></a> is True; these correspond to the learnable biases of the PyTorch <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.GRU.html">GRU</a> module
(see <a class="reference internal" href="#grucomposition-structure"><span class="std std-ref">Structure</span></a> for additional information).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[<a class="reference internal" href="MappingProjection.html#psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection" title="psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection">MappingProjection</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_ir">
<span class="sig-name descname"><span class="pre">bias_ir</span></span><a class="headerlink" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_ir" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="MappingProjection.html"><span class="doc">MappingProjection</span></a> with learnable <a class="reference internal" href="MappingProjection.html#psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection.matrix" title="psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection.matrix"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">matrix</span></code></a> (“connection weights”) that provides
the bias to the weights, <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_ir" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_ir"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">wts_ir</span></code></a>, from the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.input_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.input_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">input_node</span></code></a>
to the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.reset_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.reset_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">reset_node</span></code></a>; corresponds to the <span class="math notranslate nohighlight">\(b_ir\)</span> bias parameter of the
PyTorch <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.GRU.html">GRU</a> module
(see <a class="reference internal" href="#grucomposition-structure"><span class="std std-ref">Structure</span></a> for additional information).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="MappingProjection.html#psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection" title="psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection">MappingProjection</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_iu">
<span class="sig-name descname"><span class="pre">bias_iu</span></span><a class="headerlink" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_iu" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="MappingProjection.html"><span class="doc">MappingProjection</span></a> with learnable <a class="reference internal" href="MappingProjection.html#psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection.matrix" title="psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection.matrix"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">matrix</span></code></a> (“connection weights”) that provides
the bias to the weights, <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_iu" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_iu"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">wts_iu</span></code></a>, from the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.input_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.input_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">input_node</span></code></a>
to the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.update_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.update_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">update_node</span></code></a>; corresponds to the <span class="math notranslate nohighlight">\(b_iz\)</span> bias parameter of the
PyTorch <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.GRU.html">GRU</a> module
(see <a class="reference internal" href="#grucomposition-structure"><span class="std std-ref">Structure</span></a> for additional information).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="ProcessingMechanism.html#psyneulink.core.components.mechanisms.processing.processingmechanism.ProcessingMechanism" title="psyneulink.core.components.mechanisms.processing.processingmechanism.ProcessingMechanism">ProcessingMechanism</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_in">
<span class="sig-name descname"><span class="pre">bias_in</span></span><a class="headerlink" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_in" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="MappingProjection.html"><span class="doc">MappingProjection</span></a> with learnable <a class="reference internal" href="MappingProjection.html#psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection.matrix" title="psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection.matrix"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">matrix</span></code></a> (“connection weights”) that provides
the bias to the weights, <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_in" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_in"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">wts_in</span></code></a>, from the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.input_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.input_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">input_node</span></code></a>
to the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.new_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.new_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">new_node</span></code></a>; corresponds to the <span class="math notranslate nohighlight">\(b_in\)</span> bias parameter of the
PyTorch <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.GRU.html">GRU</a> module
(see <a class="reference internal" href="#grucomposition-structure"><span class="std std-ref">Structure</span></a> for additional information).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="ProcessingMechanism.html#psyneulink.core.components.mechanisms.processing.processingmechanism.ProcessingMechanism" title="psyneulink.core.components.mechanisms.processing.processingmechanism.ProcessingMechanism">ProcessingMechanism</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_hr">
<span class="sig-name descname"><span class="pre">bias_hr</span></span><a class="headerlink" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_hr" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="MappingProjection.html"><span class="doc">MappingProjection</span></a> with learnable <a class="reference internal" href="MappingProjection.html#psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection.matrix" title="psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection.matrix"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">matrix</span></code></a> (“connection weights”)
that provides the bias to the weights, <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_hr" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_hr"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">wts_hr</span></code></a>, from the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">hidden_layer_node</span></code></a> to the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.reset_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.reset_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">reset_node</span></code></a>;
corresponds to the <span class="math notranslate nohighlight">\(b_hr\)</span> bias parameter of the PyTorch <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.GRU.html">GRU</a> module
(see <a class="reference internal" href="#grucomposition-structure"><span class="std std-ref">Structure</span></a> for additional information).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="ProcessingMechanism.html#psyneulink.core.components.mechanisms.processing.processingmechanism.ProcessingMechanism" title="psyneulink.core.components.mechanisms.processing.processingmechanism.ProcessingMechanism">ProcessingMechanism</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_hu">
<span class="sig-name descname"><span class="pre">bias_hu</span></span><a class="headerlink" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_hu" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="MappingProjection.html"><span class="doc">MappingProjection</span></a> with learnable <a class="reference internal" href="MappingProjection.html#psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection.matrix" title="psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection.matrix"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">matrix</span></code></a> (“connection weights”) that provides
the bias to the weights, <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_hu" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_hu"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">wts_hu</span></code></a>, from the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">hidden_layer_node</span></code></a> to the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.update_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.update_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">update_node</span></code></a>;
corresponds to the <span class="math notranslate nohighlight">\(b_hz\)</span> bias parameter of the PyTorch <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.GRU.html">GRU</a> module
(see <a class="reference internal" href="#grucomposition-structure"><span class="std std-ref">Structure</span></a> for additional information).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="ProcessingMechanism.html#psyneulink.core.components.mechanisms.processing.processingmechanism.ProcessingMechanism" title="psyneulink.core.components.mechanisms.processing.processingmechanism.ProcessingMechanism">ProcessingMechanism</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_hn">
<span class="sig-name descname"><span class="pre">bias_hn</span></span><a class="headerlink" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_hn" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="MappingProjection.html"><span class="doc">MappingProjection</span></a> with learnable <a class="reference internal" href="MappingProjection.html#psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection.matrix" title="psyneulink.core.components.projections.pathway.mappingprojection.MappingProjection.matrix"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">matrix</span></code></a> (“connection weights”) that provides
the bias to the weights, <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_hn" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_hn"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">wts_hn</span></code></a>, from the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">hidden_layer_node</span></code></a> to the <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.new_node" title="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.new_node"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">new_node</span></code></a>; corresponds to the <span class="math notranslate nohighlight">\(b_hn\)</span>
bias parameter of the PyTorch <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.GRU.html">GRU</a> module
(see <a class="reference internal" href="#grucomposition-structure"><span class="std std-ref">Structure</span></a> for additional information).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="ProcessingMechanism.html#psyneulink.core.components.mechanisms.processing.processingmechanism.ProcessingMechanism" title="psyneulink.core.components.mechanisms.processing.processingmechanism.ProcessingMechanism">ProcessingMechanism</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.PytorchGRUCompositionWrapper">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">PytorchGRUCompositionWrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">composition</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outer_creator=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subclass_components=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_context=&lt;psyneulink.core.globals.context.Context</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.PytorchGRUCompositionWrapper" title="Link to this definition">¶</a></dt>
<dd><p>Wrapper for GRUComposition as a Pytorch Module
Manage the exchange of the Composition’s Projection <a class="reference internal" href="MappingProjection.html#mappingprojection-matrix"><span class="std std-ref">Matrices</span></a>
and the Pytorch GRU Module’s parameters, and return its output value.</p>
<dl class="py method">
<dt class="sig sig-object py" id="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.PytorchGRUCompositionWrapper._flatten_for_pytorch">
<span class="sig-name descname"><span class="pre">_flatten_for_pytorch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pnl_proj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sndr_mech</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rcvr_mech</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nested_port</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nested_mech</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outer_comp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outer_comp_pytorch_rep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">access</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_context=&lt;psyneulink.core.globals.context.Context</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.PytorchGRUCompositionWrapper._flatten_for_pytorch" title="Link to this definition">¶</a></dt>
<dd><p>Return PytorchProjectionWrappers for Projections to/from GRUComposition to nested Composition
Replace GRUComposition’s nodes with gru_mech and projections to and from it.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.PytorchGRUCompositionWrapper._instantiate_GRU_pytorch_mechanism_wrappers">
<span class="sig-name descname"><span class="pre">_instantiate_GRU_pytorch_mechanism_wrappers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gru_comp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.PytorchGRUCompositionWrapper._instantiate_GRU_pytorch_mechanism_wrappers" title="Link to this definition">¶</a></dt>
<dd><p>Instantiate PytorchMechanismWrapper for GRU Node</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.PytorchGRUCompositionWrapper._instantiate_GRU_pytorch_projection_wrappers">
<span class="sig-name descname"><span class="pre">_instantiate_GRU_pytorch_projection_wrappers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">torch_gru</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.PytorchGRUCompositionWrapper._instantiate_GRU_pytorch_projection_wrappers" title="Link to this definition">¶</a></dt>
<dd><p>Create PytorchGRUProjectionWrappers for each learnable Projection of GRUComposition
For each PytorchGRUProjectionWrapper, assign the current weight matrix of the PNL Projection
to the corresponding part of the tensor in the parameter of the Pytorch GRU module.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.PytorchGRUCompositionWrapper.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimization_num</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">synch_with_pnl_options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.PytorchGRUCompositionWrapper.forward" title="Link to this definition">¶</a></dt>
<dd><p>Forward method of the model for PyTorch modes</p>
<p>This is called only when GRUComposition is run as a standalone Composition.
Otherwise, the node.execute() method is called directly (i.e., it is treated as a single node).
Returns a dictionary {output_node:value} with the output value for the torch GRU module (that is used
by the collect_afferents method(s) of the other node(s) that receive Projections from the GRUComposition.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.PytorchGRUCompositionWrapper.get_parameters_from_torch_gru">
<span class="sig-name descname"><span class="pre">get_parameters_from_torch_gru</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.PytorchGRUCompositionWrapper.get_parameters_from_torch_gru" title="Link to this definition">¶</a></dt>
<dd><p>Get parameters from PyTorch GRU module corresponding to GRUComposition’s Projections.
Format tensors:</p>
<blockquote>
<div><ul class="simple">
<li><p>transpose all weight and bias tensors;</p></li>
<li><p>reformat biases as 2d</p></li>
</ul>
</div></blockquote>
<dl class="simple">
<dt>Return formatted tensors, which are used:</dt><dd><ul class="simple">
<li><p>in set_weights_from_torch_gru(), where they are converted to numpy arrays</p></li>
<li><p>for forward computation in pytorchGRUwrappers._copy_pytorch_node_outputs_to_pnl_values()</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.PytorchGRUMechanismWrapper">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">PytorchGRUMechanismWrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mechanism</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">composition</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">component_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.PytorchGRUMechanismWrapper" title="Link to this definition">¶</a></dt>
<dd><p>Wrapper for Pytorch GRU Node
Handling of hidden_state: uses GRUComposition’s HIDDEN_NODE.value to cache state of hidden layer:
- gets input to function for hidden state from GRUComposition’s HIDDEN_NODE.value
- sets GRUComposition’s HIDDEN_NODE.value to return value for hidden state</p>
<dl class="py method">
<dt class="sig sig-object py" id="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.PytorchGRUMechanismWrapper._calculate_torch_gru_internal_state_values">
<span class="sig-name descname"><span class="pre">_calculate_torch_gru_internal_state_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.PytorchGRUMechanismWrapper._calculate_torch_gru_internal_state_values" title="Link to this definition">¶</a></dt>
<dd><p>Manually calculate and store internal state values for torch GRU prior to backward pass
These are needed for assigning to the corresponding nodes in the GRUComposition.
Returns r_t, z_t, n_t, h_t current reset, update, new, hidden and state values, respectively</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.PytorchGRUMechanismWrapper.collect_afferents">
<span class="sig-name descname"><span class="pre">collect_afferents</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">port</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.PytorchGRUMechanismWrapper.collect_afferents" title="Link to this definition">¶</a></dt>
<dd><p>Return afferent projections for input_port(s) of the Mechanism
If there is only one input_port, return the sum of its afferents (for those in Composition)
If there are multiple input_ports, return a tensor (or list of tensors if input ports are ragged) of shape:</p>
<p>(batch, input_port, projection, …)</p>
<p>Where the ellipsis represent 1 or more dimensions for the values of the projected afferent.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.PytorchGRUMechanismWrapper.set_pnl_variable_and_values">
<span class="sig-name descname"><span class="pre">set_pnl_variable_and_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">set_variable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.PytorchGRUMechanismWrapper.set_pnl_variable_and_values" title="Link to this definition">¶</a></dt>
<dd><p>Set the state of the PytorchMechanismWrapper’s Mechanism
Note: if execute_mech=True requires that variable=True</p>
</dd></dl>

</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.pytorch_composition_wrapper_type">
<span class="sig-name descname"><span class="pre">pytorch_composition_wrapper_type</span></span><a class="headerlink" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.pytorch_composition_wrapper_type" title="Link to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.PytorchGRUCompositionWrapper" title="psyneulink.library.compositions.grucomposition.pytorchGRUwrappers.PytorchGRUCompositionWrapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">PytorchGRUCompositionWrapper</span></code></a></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.pytorch_mechanism_wrapper_type">
<span class="sig-name descname"><span class="pre">pytorch_mechanism_wrapper_type</span></span><a class="headerlink" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.pytorch_mechanism_wrapper_type" title="Link to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.PytorchGRUMechanismWrapper" title="psyneulink.library.compositions.grucomposition.pytorchGRUwrappers.PytorchGRUMechanismWrapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">PytorchGRUMechanismWrapper</span></code></a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition._construct_pnl_composition">
<span class="sig-name descname"><span class="pre">_construct_pnl_composition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition._construct_pnl_composition" title="Link to this definition">¶</a></dt>
<dd><p>Construct Nodes and Projections for GRUComposition</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition._set_learning_attributes">
<span class="sig-name descname"><span class="pre">_set_learning_attributes</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition._set_learning_attributes" title="Link to this definition">¶</a></dt>
<dd><p>Set learning-related attributes for Node and Projections</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.set_weights">
<span class="sig-name descname"><span class="pre">set_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">biases</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.set_weights" title="Link to this definition">¶</a></dt>
<dd><p>Set weights for Projections to input_node and hidden_layer_node.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.infer_backpropagation_learning_pathways">
<span class="sig-name descname"><span class="pre">infer_backpropagation_learning_pathways</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">execution_mode</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.infer_backpropagation_learning_pathways" title="Link to this definition">¶</a></dt>
<dd><p>Create backpropagation learning pathways for every Input Node –&gt; Output Node pathway
Flattens nested compositions:</p>
<blockquote>
<div><ul class="simple">
<li><p>only includes the Projections in outer Composition to/from the CIMs of the nested Composition
(i.e., to input_CIMs and from output_CIMs) – the ones that should be learned;</p></li>
<li><p>excludes Projections from/to CIMs in the nested Composition
(from input_CIMs and to output_CIMs), as those should remain identity Projections;</p></li>
</ul>
<p>see <code class="xref any docutils literal notranslate"><span class="pre">PytorchCompositionWrapper</span></code> for table of how Projections are handled and further details.</p>
</div></blockquote>
<p>Returns list of target nodes for each pathway</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition._get_pytorch_backprop_pathway">
<span class="sig-name descname"><span class="pre">_get_pytorch_backprop_pathway</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_node</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition._get_pytorch_backprop_pathway" title="Link to this definition">¶</a></dt>
<dd><p>Breadth-first search from input_node to find all input -&gt; output pathways
Uses queue(node, composition) to traverse all nodes in the graph
IMPLEMENTATION NOTE:  flattens nested Compositions, removing any CIMs in the nested Compositions
Return a list of all pathways from input_node -&gt; output node</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition._get_execution_mode">
<span class="sig-name descname"><span class="pre">_get_execution_mode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">execution_mode</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition._get_execution_mode" title="Link to this definition">¶</a></dt>
<dd><p>Parse execution_mode argument and return a valid execution mode for the learn() method</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition._add_dependency">
<span class="sig-name descname"><span class="pre">_add_dependency</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sender</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">projection</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">receiver</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dependency_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">queue</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition._add_dependency" title="Link to this definition">¶</a></dt>
<dd><p>Override to implement direct pathway through gru_mech for pytorch backprop pathway.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition._identify_target_nodes">
<span class="sig-name descname"><span class="pre">_identify_target_nodes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">context</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition._identify_target_nodes" title="Link to this definition">¶</a></dt>
<dd><p>Recursively call all nested AutodiffCompositions to assign TARGET nodes for learning</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.add_node">
<span class="sig-name descname"><span class="pre">add_node</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">required_roles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.add_node" title="Link to this definition">¶</a></dt>
<dd><p>Override if called from command line to disallow modification of GRUComposition</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.add_projection">
<span class="sig-name descname"><span class="pre">add_projection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.add_projection" title="Link to this definition">¶</a></dt>
<dd><p>Override if called from command line to disallow modification of GRUComposition</p>
</dd></dl>

</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="psyneulink.library.compositions.grucomposition.grucomposition.GRUCompositionError">
<em class="property"><span class="k"><span class="pre">exception</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">psyneulink.library.compositions.grucomposition.grucomposition.</span></span><span class="sig-name descname"><span class="pre">GRUCompositionError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">component</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUCompositionError" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</section>


             </article>
             
            </div>
            <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Subystems.html" class="btn btn-neutral float-right" title="Subsystems" accesskey="n" rel="next">Next <img src="_static/images/chevron-right-orange.svg" class="next-page"></a>
      
      
        <a href="EMComposition.html" class="btn btn-neutral" title="EMComposition" accesskey="p" rel="prev"><img src="_static/images/chevron-right-orange.svg" class="previous-page"> Previous</a>
      
    </div>
  

  

    <hr>

  

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Jonathan D. Cohen.

    </p>
  </div>
    
      <div>
        Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
      </div>
     

</footer>

          </div>
        </div>

        <div class="psyneulink-content-right" id="psyneulink-content-right">
          <div class="psyneulink-right-menu" id="psyneulink-right-menu">
            <div class="psyneulink-side-scroll" id="psyneulink-side-scroll-right">
              <ul>
<li><a class="reference internal" href="#">GRUComposition</a><ul>
<li><a class="reference internal" href="#contents">Contents</a></li>
<li><a class="reference internal" href="#overview">Overview</a></li>
<li><a class="reference internal" href="#creation">Creation</a></li>
<li><a class="reference internal" href="#structure">Structure</a></li>
<li><a class="reference internal" href="#execution">Execution</a><ul>
<li><a class="reference internal" href="#processing"><em>Processing</em></a></li>
<li><a class="reference internal" href="#learning"><em>Learning</em></a></li>
</ul>
</li>
<li><a class="reference internal" href="#class-reference">Class Reference</a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition"><code class="docutils literal notranslate"><span class="pre">GRUComposition</span></code></a><ul>
<li><a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.input_size"><code class="docutils literal notranslate"><span class="pre">GRUComposition.input_size</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_size"><code class="docutils literal notranslate"><span class="pre">GRUComposition.hidden_size</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias"><code class="docutils literal notranslate"><span class="pre">GRUComposition.bias</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.enable_learning"><code class="docutils literal notranslate"><span class="pre">GRUComposition.enable_learning</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.learning_rate"><code class="docutils literal notranslate"><span class="pre">GRUComposition.learning_rate</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.w_ih_learning_rate"><code class="docutils literal notranslate"><span class="pre">GRUComposition.w_ih_learning_rate</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.w_hh_learning_rate"><code class="docutils literal notranslate"><span class="pre">GRUComposition.w_hh_learning_rate</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.b_ih_learning_rate"><code class="docutils literal notranslate"><span class="pre">GRUComposition.b_ih_learning_rate</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.b_hh_learning_rate"><code class="docutils literal notranslate"><span class="pre">GRUComposition.b_hh_learning_rate</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.input_node"><code class="docutils literal notranslate"><span class="pre">GRUComposition.input_node</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.new_node"><code class="docutils literal notranslate"><span class="pre">GRUComposition.new_node</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.hidden_layer_node"><code class="docutils literal notranslate"><span class="pre">GRUComposition.hidden_layer_node</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.reset_node"><code class="docutils literal notranslate"><span class="pre">GRUComposition.reset_node</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.update_node"><code class="docutils literal notranslate"><span class="pre">GRUComposition.update_node</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.output_node"><code class="docutils literal notranslate"><span class="pre">GRUComposition.output_node</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.learnable_projections"><code class="docutils literal notranslate"><span class="pre">GRUComposition.learnable_projections</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_in"><code class="docutils literal notranslate"><span class="pre">GRUComposition.wts_in</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_iu"><code class="docutils literal notranslate"><span class="pre">GRUComposition.wts_iu</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_ir"><code class="docutils literal notranslate"><span class="pre">GRUComposition.wts_ir</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_nh"><code class="docutils literal notranslate"><span class="pre">GRUComposition.wts_nh</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_hr"><code class="docutils literal notranslate"><span class="pre">GRUComposition.wts_hr</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_hu"><code class="docutils literal notranslate"><span class="pre">GRUComposition.wts_hu</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_hn"><code class="docutils literal notranslate"><span class="pre">GRUComposition.wts_hn</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_hh"><code class="docutils literal notranslate"><span class="pre">GRUComposition.wts_hh</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.wts_ho"><code class="docutils literal notranslate"><span class="pre">GRUComposition.wts_ho</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.reset_gate"><code class="docutils literal notranslate"><span class="pre">GRUComposition.reset_gate</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.new_gate"><code class="docutils literal notranslate"><span class="pre">GRUComposition.new_gate</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.recurrent_gate"><code class="docutils literal notranslate"><span class="pre">GRUComposition.recurrent_gate</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_ir_node"><code class="docutils literal notranslate"><span class="pre">GRUComposition.bias_ir_node</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_iu_node"><code class="docutils literal notranslate"><span class="pre">GRUComposition.bias_iu_node</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_in_node"><code class="docutils literal notranslate"><span class="pre">GRUComposition.bias_in_node</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_hr_node"><code class="docutils literal notranslate"><span class="pre">GRUComposition.bias_hr_node</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_hu_node"><code class="docutils literal notranslate"><span class="pre">GRUComposition.bias_hu_node</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_hn_node"><code class="docutils literal notranslate"><span class="pre">GRUComposition.bias_hn_node</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.biases"><code class="docutils literal notranslate"><span class="pre">GRUComposition.biases</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_ir"><code class="docutils literal notranslate"><span class="pre">GRUComposition.bias_ir</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_iu"><code class="docutils literal notranslate"><span class="pre">GRUComposition.bias_iu</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_in"><code class="docutils literal notranslate"><span class="pre">GRUComposition.bias_in</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_hr"><code class="docutils literal notranslate"><span class="pre">GRUComposition.bias_hr</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_hu"><code class="docutils literal notranslate"><span class="pre">GRUComposition.bias_hu</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.bias_hn"><code class="docutils literal notranslate"><span class="pre">GRUComposition.bias_hn</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.PytorchGRUCompositionWrapper"><code class="docutils literal notranslate"><span class="pre">GRUComposition.PytorchGRUCompositionWrapper</span></code></a><ul>
<li><a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.PytorchGRUCompositionWrapper._flatten_for_pytorch"><code class="docutils literal notranslate"><span class="pre">GRUComposition.PytorchGRUCompositionWrapper._flatten_for_pytorch()</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.PytorchGRUCompositionWrapper._instantiate_GRU_pytorch_mechanism_wrappers"><code class="docutils literal notranslate"><span class="pre">GRUComposition.PytorchGRUCompositionWrapper._instantiate_GRU_pytorch_mechanism_wrappers()</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.PytorchGRUCompositionWrapper._instantiate_GRU_pytorch_projection_wrappers"><code class="docutils literal notranslate"><span class="pre">GRUComposition.PytorchGRUCompositionWrapper._instantiate_GRU_pytorch_projection_wrappers()</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.PytorchGRUCompositionWrapper.forward"><code class="docutils literal notranslate"><span class="pre">GRUComposition.PytorchGRUCompositionWrapper.forward()</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.PytorchGRUCompositionWrapper.get_parameters_from_torch_gru"><code class="docutils literal notranslate"><span class="pre">GRUComposition.PytorchGRUCompositionWrapper.get_parameters_from_torch_gru()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.PytorchGRUMechanismWrapper"><code class="docutils literal notranslate"><span class="pre">GRUComposition.PytorchGRUMechanismWrapper</span></code></a><ul>
<li><a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.PytorchGRUMechanismWrapper._calculate_torch_gru_internal_state_values"><code class="docutils literal notranslate"><span class="pre">GRUComposition.PytorchGRUMechanismWrapper._calculate_torch_gru_internal_state_values()</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.PytorchGRUMechanismWrapper.collect_afferents"><code class="docutils literal notranslate"><span class="pre">GRUComposition.PytorchGRUMechanismWrapper.collect_afferents()</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.PytorchGRUMechanismWrapper.set_pnl_variable_and_values"><code class="docutils literal notranslate"><span class="pre">GRUComposition.PytorchGRUMechanismWrapper.set_pnl_variable_and_values()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.pytorch_composition_wrapper_type"><code class="docutils literal notranslate"><span class="pre">GRUComposition.pytorch_composition_wrapper_type</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.pytorch_mechanism_wrapper_type"><code class="docutils literal notranslate"><span class="pre">GRUComposition.pytorch_mechanism_wrapper_type</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition._construct_pnl_composition"><code class="docutils literal notranslate"><span class="pre">GRUComposition._construct_pnl_composition()</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition._set_learning_attributes"><code class="docutils literal notranslate"><span class="pre">GRUComposition._set_learning_attributes()</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.set_weights"><code class="docutils literal notranslate"><span class="pre">GRUComposition.set_weights()</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.infer_backpropagation_learning_pathways"><code class="docutils literal notranslate"><span class="pre">GRUComposition.infer_backpropagation_learning_pathways()</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition._get_pytorch_backprop_pathway"><code class="docutils literal notranslate"><span class="pre">GRUComposition._get_pytorch_backprop_pathway()</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition._get_execution_mode"><code class="docutils literal notranslate"><span class="pre">GRUComposition._get_execution_mode()</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition._add_dependency"><code class="docutils literal notranslate"><span class="pre">GRUComposition._add_dependency()</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition._identify_target_nodes"><code class="docutils literal notranslate"><span class="pre">GRUComposition._identify_target_nodes()</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.add_node"><code class="docutils literal notranslate"><span class="pre">GRUComposition.add_node()</span></code></a></li>
<li><a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUComposition.add_projection"><code class="docutils literal notranslate"><span class="pre">GRUComposition.add_projection()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#psyneulink.library.compositions.grucomposition.grucomposition.GRUCompositionError"><code class="docutils literal notranslate"><span class="pre">GRUCompositionError</span></code></a></li>
</ul>
</li>
</ul>

            </div>
          </div>
        </div>
      </section>
    </div>

  


  

     
       <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
         <script src="_static/jquery.js?v=5d32c60e"></script>
         <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
         <script src="_static/documentation_options.js?v=1910492c"></script>
         <script src="_static/doctools.js?v=9bcbadda"></script>
         <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
         <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
     

  

  <script type="text/javascript" src="_static/js/vendor/popper.min.js"></script>
  <script type="text/javascript" src="_static/js/vendor/bootstrap.min.js"></script>
  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

  <!-- Begin Footer -->

  <footer class="site-footer" id="docs-tutorials-resources">
    <div class="container footer-container">
      <div class="footer-logo-wrapper">
        <a href="https://princetonuniversity.github.io/PsyNeuLink/" class="footer-logo"></a>
      </div>

  </footer>

  

  <!-- End Footer -->

  <!-- Begin Mobile Menu -->

  <div class="mobile-main-menu">
    <div class="container-fluid">
      <div class="container mobile-logo-container">
        <div class="mobile-main-menu-header-container">
          <a class="header-logo" href="https://princetonuniversity.github.io/PsyNeuLink/" aria-label="PsyNeuLink"></a>
          <a class="main-menu-close-button" href="#" data-behavior="close-mobile-menu"></a>
        </div>
      </div>
    </div>

    <div class="mobile-main-menu-links-container">
      <div class="main-menu">
        <ul>
          <li>
            <a href="https://github.com/PrincetonUniversity/PsyNeuLink">Github</a>
          </li>
        </ul>
      </div>
    </div>
  </div>

  <!-- End Mobile Menu -->

  <script type="text/javascript" src="_static/js/vendor/anchor.min.js"></script>

  <script type="text/javascript">
    $(document).ready(function() {
      mobileMenu.bind();
      mobileTOC.bind();
      psyneulinkAnchors.bind();
      sideMenus.bind();
      scrollToAnchor.bind();
      highlightNavigation.bind();
      mainMenuDropdown.bind();

      // Add class to links that have code blocks, since we cannot create links in code blocks
      $("article.psyneulink-article a span.pre").each(function(e) {
        $(this).closest("a").addClass("has-code");
      });
    })
  </script>
</body>
</html>